[{"path":"https://mangiolalaboratory.github.io/sccomp/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 sccomp authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/articles/introduction.html","id":"section","dir":"Articles","previous_headings":"","what":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","text":"sccomp powerful R package designed comprehensive differential composition variability analysis single-cell genomics, proteomics, microbiomics data.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/articles/introduction.html","id":"why-sccomp","dir":"Articles","previous_headings":"","what":"Why sccomp?","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","text":"cellular omic data, method differential variability analysis exists, methods differential composition analysis take fundamental data properties account. introduce sccomp, generalised method differential composition variability analyses capable jointly modelling data count distribution, compositionality, group-specific variability, proportion mean-variability association, robust outliers.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/articles/introduction.html","id":"comprehensive-method-comparison","dir":"Articles","previous_headings":"Why sccomp?","what":"Comprehensive Method Comparison","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","text":": Data modelled counts. II: Group proportions modelled compositional. III: proportion variability modelled cell-type specific. IV: Information sharing across cell types, mean–variability association. V: Outlier detection robustness. VI: Differential variability analysis. VII Mixed effect modelling VIII Removal unwanted effects","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/articles/introduction.html","id":"scientific-citation","dir":"Articles","previous_headings":"Why sccomp?","what":"Scientific Citation","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","text":"Mangiola, Stefano, Alexandra J. Roth-Schulze, Marie Trussart, Enrique Zozaya-Valdés, Mengyao Ma, Zijie Gao, Alan F. Rubin, Terence P. Speed, Heejung Shim, Anthony T. Papenfuss. 2023. “Sccomp: Robust Differential Composition Variability Analysis Single-Cell Data.” Proceedings National Academy Sciences United States America 120 (33): e2203828120. https://doi.org/10.1073/pnas.2203828120 PNAS - sccomp: Robust differential composition variability analysis single-cell data","code":""},{"path":[]},{"path":"https://mangiolalaboratory.github.io/sccomp/articles/introduction.html","id":"installation-guide","dir":"Articles","previous_headings":"","what":"Installation Guide","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","text":"sccomp based cmdstanr provides latest version cmdstan Bayesian modelling tool. cmdstanr CRAN, need 3 simple step process (prompted user forgot). R installation sccomp R installation cmdstanr cmdstanr call cmdstan installation Bioconductor Github","code":"if (!requireNamespace(\"BiocManager\")) install.packages(\"BiocManager\")  # Step 1 BiocManager::install(\"sccomp\")  # Step 2 install.packages(\"cmdstanr\", repos = c(\"https://stan-dev.r-universe.dev/\", getOption(\"repos\")))  # Step 3 cmdstanr::check_cmdstan_toolchain(fix = TRUE) # Just checking system setting cmdstanr::install_cmdstan() # Step 1 devtools::install_github(\"MangiolaLaboratory/sccomp\")  # Step 2 install.packages(\"cmdstanr\", repos = c(\"https://stan-dev.r-universe.dev/\", getOption(\"repos\")))  # Step 3 cmdstanr::check_cmdstan_toolchain(fix = TRUE) # Just checking system setting cmdstanr::install_cmdstan()"},{"path":[]},{"path":"https://mangiolalaboratory.github.io/sccomp/articles/introduction.html","id":"analysis-tutorial","dir":"Articles","previous_headings":"","what":"Analysis Tutorial","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","text":"","code":"library(dplyr) library(sccomp) library(ggplot2) library(forcats) library(tidyr) data(\"seurat_obj\") data(\"sce_obj\") data(\"counts_obj\")"},{"path":"https://mangiolalaboratory.github.io/sccomp/articles/introduction.html","id":"binary-factor-analysis","dir":"Articles","previous_headings":"Analysis Tutorial","what":"Binary Factor Analysis","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","text":"output table, estimate columns start prefix c_ indicate composition, v_ indicate variability (formula_variability set).","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/articles/introduction.html","id":"from-seurat-singlecellexperiment-metadata-objects","dir":"Articles","previous_headings":"Analysis Tutorial > Binary Factor Analysis","what":"From Seurat, SingleCellExperiment, metadata objects","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","text":"","code":"sccomp_result =    sce_obj |>   sccomp_estimate(      formula_composition = ~ type,      sample = \"sample\",      cell_group = \"cell_group\",      cores = 1,     verbose = FALSE   ) |>    sccomp_test()"},{"path":"https://mangiolalaboratory.github.io/sccomp/articles/introduction.html","id":"from-counts","dir":"Articles","previous_headings":"Analysis Tutorial > Binary Factor Analysis","what":"From counts","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","text":"see results fit, effects factor composition variability. also can see uncertainty around effects. output tibble containing Following columns cell_group - cell groups tested. parameter - parameter estimated design matrix described input formula_composition formula_variability. factor - covariate factor formula, applicable (e.g., present Intercept contrasts). c_lower - Lower (2.5%) quantile posterior distribution composition (c) parameter. c_effect - Mean posterior distribution composition (c) parameter. c_upper - Upper (97.5%) quantile posterior distribution composition (c) parameter. c_pH0 - Probability null hypothesis (difference) composition (c). p-value. c_FDR - False-discovery rate null hypothesis composition (c). v_lower - Lower (2.5%) quantile posterior distribution variability (v) parameter. v_effect - Mean posterior distribution variability (v) parameter. v_upper - Upper (97.5%) quantile posterior distribution variability (v) parameter. v_pH0 - Probability null hypothesis variability (v). v_FDR - False-discovery rate null hypothesis variability (v). count_data - Nested input count data.","code":"sccomp_result =    counts_obj |>   sccomp_estimate(      formula_composition = ~ type,      sample = \"sample\",     cell_group = \"cell_group\",     abundance = \"count\",      cores = 1, verbose = FALSE,     max_sampling_iterations = 2000   ) |>    sccomp_test() sccomp_result ## sccomp model ## ============ ##  ## Model specifications: ##   Family: multi_beta_binomial  ##   Composition formula: ~type  ##   Variability formula: ~1  ##   Inference method: pathfinder  ##  ## Data: Samples: 20   Cell groups: 36  ##  ## Column prefixes: c_ -> composition parameters  v_ -> variability parameters ##  ## Convergence diagnostics: ##   For each parameter, n_eff is the effective sample size and R_k_hat is the potential ##   scale reduction factor on split chains (at convergence, R_k_hat = 1). ##  ## # A tibble: 72 × 19 ##    cell_group parameter  factor  c_lower c_effect c_upper   c_pH0   c_FDR c_rhat ##    <chr>      <chr>      <chr>     <dbl>    <dbl>   <dbl>   <dbl>   <dbl>  <dbl> ##  1 B1         (Intercep… NA      0.954      1.20   1.46   0       0        1.000 ##  2 B1         typecancer type   -0.927     -0.615 -0.322  0       0        1.000 ##  3 B2         (Intercep… NA      0.511      0.774  1.03   0       0        1.00  ##  4 B2         typecancer type   -0.976     -0.673 -0.352  0.00150 1.36e-4  1.00  ##  5 B3         (Intercep… NA     -0.583     -0.332 -0.0701 0.0420  3.58e-3  1.00  ##  6 B3         typecancer type   -0.573     -0.276  0.0340 0.124   2.47e-2  1.000 ##  7 BM         (Intercep… NA     -1.23      -0.971 -0.725  0       0        1.00  ##  8 BM         typecancer type   -0.586     -0.285  0.0204 0.115   2.04e-2  1.00  ##  9 CD4 1      (Intercep… NA      0.196      0.366  0.530  0       0        1.00  ## 10 CD4 1      typecancer type   -0.00599    0.209  0.429  0.158   3.00e-2  1.000 ## # ℹ 62 more rows ## # ℹ 10 more variables: c_ess_bulk <dbl>, c_ess_tail <dbl>, v_lower <dbl>, ## #   v_effect <dbl>, v_upper <dbl>, v_pH0 <dbl>, v_FDR <dbl>, v_rhat <dbl>, ## #   v_ess_bulk <dbl>, v_ess_tail <dbl>"},{"path":"https://mangiolalaboratory.github.io/sccomp/articles/introduction.html","id":"outlier-identification","dir":"Articles","previous_headings":"Analysis Tutorial","what":"Outlier Identification","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","text":"sccomp can identify outliers probabilistically exclude estimation.","code":"sccomp_result =    counts_obj |>   sccomp_estimate(      formula_composition = ~ type,      sample = \"sample\",     cell_group = \"cell_group\",     abundance = \"count\",      cores = 1, verbose = FALSE,     max_sampling_iterations = 2000   ) |>       # max_sampling_iterations is used to reduce draw file sizes   sccomp_remove_outliers(cores = 1, verbose = FALSE, max_sampling_iterations = 2000) |> # Optional   sccomp_test() ## Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... ##  ## Chain 1 finished in 0.0 seconds. ## Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... ##  ## Chain 1 finished in 0.0 seconds."},{"path":"https://mangiolalaboratory.github.io/sccomp/articles/introduction.html","id":"visualization-and-summary-plots","dir":"Articles","previous_headings":"Analysis Tutorial","what":"Visualization and Summary Plots","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","text":"plot group proportions, faceted groups. blue boxplots represent posterior predictive check. model descriptively adequate data, blue boxplots roughly overlay black boxplots, represent observed data. outliers coloured red. boxplot returned every (discrete) covariate present formula_composition. colour coding represents significant associations composition /variability.  can plot proportions adjusted unwanted effects. helpful especially complex models, multiple factors can significantly impact proportions.  plot estimates differential composition (c_) x-axis differential variability (v_) y-axis. error bars represent 95% credible intervals. dashed lines represent minimal effect hypothesis test based . effect labelled significant exceeds minimal effect according 95% credible interval. Facets represent covariates model.  can plot relationship abundance variability. can see , positively correlated. sccomp models relationship obtain shrinkage effect estimates abundance variability. shrinkage adaptive modelled jointly, thanks Bayesian inference.  can produce series plots calling plot method.","code":"sccomp_result |>    sccomp_boxplot(factor = \"type\") ## Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... ##  ## Chain 1 finished in 0.0 seconds. sccomp_result |>    sccomp_boxplot(factor = \"type\", remove_unwanted_effects = TRUE) ## Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... ##  ## Chain 1 finished in 0.0 seconds. ## Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... ##  ## Chain 1 finished in 0.0 seconds. ## Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... ##  ## Chain 1 finished in 0.0 seconds. sccomp_result |>    plot_1D_intervals() sccomp_result |>    plot_2D_intervals() sccomp_result |> plot()"},{"path":"https://mangiolalaboratory.github.io/sccomp/articles/introduction.html","id":"model-proportions-directly-e-g--from-deconvolution","dir":"Articles","previous_headings":"Analysis Tutorial","what":"Model Proportions Directly (e.g. from deconvolution)","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","text":"Note: counts available, strongly discourage use proportions, important source uncertainty (.e., rare groups/cell types) modeled. use proportions better suited modelling deconvolution results (e.g., bulk RNA data), case counts available. Proportions greater 0. Assuming zeros derive precision threshold (e.g., deconvolution), zeros converted smallest non-zero value.","code":"sccomp_result =    counts_obj |>   sccomp_estimate(      formula_composition = ~ type,      sample = \"sample\",     cell_group = \"cell_group\",     abundance = \"proportion\",      cores = 1, verbose = FALSE,     max_sampling_iterations = 2000   ) |>    sccomp_test()"},{"path":"https://mangiolalaboratory.github.io/sccomp/articles/introduction.html","id":"continuous-factor-analysis","dir":"Articles","previous_headings":"Analysis Tutorial","what":"Continuous Factor Analysis","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","text":"sccomp able fit arbitrary complex models. example continuous binary covariate.","code":"res =     seurat_obj |>     sccomp_estimate(       formula_composition = ~ type + continuous_covariate,        sample = \"sample\",        cell_group = \"cell_group\",       cores = 1, verbose=FALSE,       max_sampling_iterations = 2000     )  res ## sccomp model ## ============ ##  ## Model specifications: ##   Family: multi_beta_binomial  ##   Composition formula: ~type + continuous_covariate  ##   Variability formula: ~1  ##   Inference method: pathfinder  ##  ## Data: Samples: 20   Cell groups: 30  ##  ## Column prefixes: c_ -> composition parameters  v_ -> variability parameters ##  ## Convergence diagnostics: ##   For each parameter, n_eff is the effective sample size and R_k_hat is the potential ##   scale reduction factor on split chains (at convergence, R_k_hat = 1). ##  ## # A tibble: 90 × 15 ##    cell_group        parameter factor c_lower c_effect c_upper c_rhat c_ess_bulk ##    <chr>             <chr>     <chr>    <dbl>    <dbl>   <dbl>  <dbl>      <dbl> ##  1 B immature        (Interce… NA      0.544    0.835    1.13   1.000      1698. ##  2 B immature        typeheal… type    1.02     1.35     1.67   1.00       1790. ##  3 B immature        continuo… conti… -0.262    0.0555   0.373  1.000      1860. ##  4 B mem             (Interce… NA     -1.01    -0.676   -0.344  1.00       1777. ##  5 B mem             typeheal… type    1.22     1.57     1.94   1.00       2117. ##  6 B mem             continuo… conti… -0.263    0.0673   0.420  1.000      2130. ##  7 CD4 cm S100A4     (Interce… NA      1.31     1.55     1.79   1.00       1851. ##  8 CD4 cm S100A4     typeheal… type    0.869    1.13     1.41   1.00       2058. ##  9 CD4 cm S100A4     continuo… conti… -0.0977   0.170    0.457  1.00       1866. ## 10 CD4 cm high cyto… (Interce… NA     -0.920   -0.579   -0.246  1.00       1830. ## # ℹ 80 more rows ## # ℹ 7 more variables: c_ess_tail <dbl>, v_lower <dbl>, v_effect <dbl>, ## #   v_upper <dbl>, v_rhat <dbl>, v_ess_bulk <dbl>, v_ess_tail <dbl>"},{"path":"https://mangiolalaboratory.github.io/sccomp/articles/introduction.html","id":"random-effect-modeling-mixed-effect-modeling","dir":"Articles","previous_headings":"Analysis Tutorial","what":"Random Effect Modeling (Mixed-Effect Modeling)","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","text":"sccomp supports multilevel modeling allowing inclusion random effects compositional variability formulas. particularly useful data hierarchical grouped structures, measurements nested within subjects, batches, experimental units. incorporating random effects, sccomp can account variability different levels data, improving model fit inference accuracy.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/articles/introduction.html","id":"random-intercept-model","dir":"Articles","previous_headings":"Analysis Tutorial > Random Effect Modeling (Mixed-Effect Modeling)","what":"Random Intercept Model","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","text":"example, demonstrate fit random intercept model using sccomp. ’ll model cell-type proportions fixed effects (e.g., treatment) random effects (e.g., subject-specific variability). input data","code":"seurat_obj[[]] |> as_tibble() ## # A tibble: 106,297 × 9 ##    cell_group nCount_RNA nFeature_RNA group__ group__wrong sample type  group2__ ##    <chr>           <dbl>        <int> <chr>   <chr>        <chr>  <chr> <chr>    ##  1 CD4 naive           0            0 GROUP1  1            SI-GA… canc… GROUP21  ##  2 Mono clas…          0            0 GROUP1  1            SI-GA… canc… GROUP21  ##  3 CD4 cm S1…          0            0 GROUP1  1            SI-GA… canc… GROUP21  ##  4 B immature          0            0 GROUP1  1            SI-GA… canc… GROUP21  ##  5 CD8 naive           0            0 GROUP1  1            SI-GA… canc… GROUP21  ##  6 CD4 naive           0            0 GROUP1  1            SI-GA… canc… GROUP21  ##  7 Mono clas…          0            0 GROUP1  1            SI-GA… canc… GROUP21  ##  8 CD4 cm S1…          0            0 GROUP1  1            SI-GA… canc… GROUP21  ##  9 CD4 cm hi…          0            0 GROUP1  1            SI-GA… canc… GROUP21  ## 10 B immature          0            0 GROUP1  1            SI-GA… canc… GROUP21  ## # ℹ 106,287 more rows ## # ℹ 1 more variable: continuous_covariate <dbl> res =    seurat_obj |>   sccomp_estimate(      formula_composition = ~ type + (1 | group__),      sample = \"sample\",     cell_group = \"cell_group\",     bimodal_mean_variability_association = TRUE,     cores = 1, verbose = FALSE,     max_sampling_iterations = 2000   )   res ## sccomp model ## ============ ##  ## Model specifications: ##   Family: multi_beta_binomial  ##   Composition formula: ~type + (1 | group__)  ##   Variability formula: ~1  ##   Inference method: pathfinder  ##  ## Data: Samples: 20   Cell groups: 30  ##  ## Column prefixes: c_ -> composition parameters  v_ -> variability parameters ##  ## Convergence diagnostics: ##   For each parameter, n_eff is the effective sample size and R_k_hat is the potential ##   scale reduction factor on split chains (at convergence, R_k_hat = 1). ##  ## # A tibble: 180 × 15 ##    cell_group parameter       factor c_lower c_effect  c_upper c_rhat c_ess_bulk ##    <chr>      <chr>           <chr>    <dbl>    <dbl>    <dbl>  <dbl>      <dbl> ##  1 B immature (Intercept)     NA      0.540   0.838    1.22     1.01       152.  ##  2 B immature typehealthy     type    0.778   1.20     1.60     1.01       130.  ##  3 B immature (Intercept)___… NA     -0.301   0.0222   0.415    1.00       173.  ##  4 B immature (Intercept)___… NA     -0.0872  0.234    0.644    1.000      119.  ##  5 B immature (Intercept)___… NA     -0.131   0.233    0.634    1.00       141.  ##  6 B immature (Intercept)___… NA     -0.806  -0.286    0.0404   1.02       106.  ##  7 B mem      (Intercept)     NA     -0.855  -0.489   -0.00783  1.01        77.1 ##  8 B mem      typehealthy     type    0.584   1.32     1.82     1.02        58.8 ##  9 B mem      (Intercept)___… NA     -0.485  -0.00927  0.481    1.02       108.  ## 10 B mem      (Intercept)___… NA     -0.150   0.256    0.792    1.00       125.  ## # ℹ 170 more rows ## # ℹ 7 more variables: c_ess_tail <dbl>, v_lower <dbl>, v_effect <dbl>, ## #   v_upper <dbl>, v_rhat <dbl>, v_ess_bulk <dbl>, v_ess_tail <dbl>"},{"path":"https://mangiolalaboratory.github.io/sccomp/articles/introduction.html","id":"random-effect-model-random-slopes","dir":"Articles","previous_headings":"Analysis Tutorial > Random Effect Modeling (Mixed-Effect Modeling)","what":"Random Effect Model (random slopes)","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","text":"sccomp can model random slopes. provide example .","code":"res =    seurat_obj |>   sccomp_estimate(       formula_composition = ~ type + (type | group__),       sample = \"sample\",       cell_group = \"cell_group\",       bimodal_mean_variability_association = TRUE,       cores = 1, verbose = FALSE,       max_sampling_iterations = 2000     )  res ## sccomp model ## ============ ##  ## Model specifications: ##   Family: multi_beta_binomial  ##   Composition formula: ~type + (type | group__)  ##   Variability formula: ~1  ##   Inference method: pathfinder  ##  ## Data: Samples: 20   Cell groups: 30  ##  ## Column prefixes: c_ -> composition parameters  v_ -> variability parameters ##  ## Convergence diagnostics: ##   For each parameter, n_eff is the effective sample size and R_k_hat is the potential ##   scale reduction factor on split chains (at convergence, R_k_hat = 1). ##  ## # A tibble: 240 × 15 ##    cell_group parameter        factor c_lower c_effect c_upper c_rhat c_ess_bulk ##    <chr>      <chr>            <chr>    <dbl>    <dbl>   <dbl>  <dbl>      <dbl> ##  1 B immature (Intercept)      NA       0.499   0.864   1.28     1.00      138.  ##  2 B immature typehealthy      type     0.715   1.17    1.65     1.00      106.  ##  3 B immature (Intercept)___G… NA      -0.301   0.0348  0.407    1.00      128.  ##  4 B immature typehealthy___G… NA      -0.307   0.0102  0.345    1.04      166.  ##  5 B immature (Intercept)___G… NA      -0.178   0.132   0.562    1.00      133.  ##  6 B immature typehealthy___G… NA      -0.172   0.0957  0.572    1.00      144.  ##  7 B immature (Intercept)___G… NA      -0.214   0.170   0.576    1.01      126.  ##  8 B immature (Intercept)___G… NA      -0.785  -0.228   0.0440   1.00      100.  ##  9 B mem      (Intercept)      NA      -1.05   -0.547  -0.101    1.01      116.  ## 10 B mem      typehealthy      type     0.712   1.35    1.97     1.01       84.3 ## # ℹ 230 more rows ## # ℹ 7 more variables: c_ess_tail <dbl>, v_lower <dbl>, v_effect <dbl>, ## #   v_upper <dbl>, v_rhat <dbl>, v_ess_bulk <dbl>, v_ess_tail <dbl>"},{"path":"https://mangiolalaboratory.github.io/sccomp/articles/introduction.html","id":"nested-random-effects","dir":"Articles","previous_headings":"Analysis Tutorial > Random Effect Modeling (Mixed-Effect Modeling)","what":"Nested Random Effects","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","text":"complex hierarchy, measurements nested within subjects subjects nested within batches, can include multiple grouping variables. group2__ nested within group__.","code":"res =    seurat_obj |>   sccomp_estimate(       formula_composition = ~ type + (type | group__) + (1 | group2__),       sample = \"sample\",       cell_group = \"cell_group\",       bimodal_mean_variability_association = TRUE,       cores = 1, verbose = FALSE,       max_sampling_iterations = 2000     )  res ## sccomp model ## ============ ##  ## Model specifications: ##   Family: multi_beta_binomial  ##   Composition formula: ~type + (type | group__) + (1 | group2__)  ##   Variability formula: ~1  ##   Inference method: pathfinder  ##  ## Data: Samples: 20   Cell groups: 30  ##  ## Column prefixes: c_ -> composition parameters  v_ -> variability parameters ##  ## Convergence diagnostics: ##   For each parameter, n_eff is the effective sample size and R_k_hat is the potential ##   scale reduction factor on split chains (at convergence, R_k_hat = 1). ##  ## # A tibble: 300 × 15 ##    cell_group parameter       factor  c_lower c_effect c_upper c_rhat c_ess_bulk ##    <chr>      <chr>           <chr>     <dbl>    <dbl>   <dbl>  <dbl>      <dbl> ##  1 B immature (Intercept)     NA      0.461     0.798   1.27     1.01       95.9 ##  2 B immature typehealthy     type    0.615     1.18    1.73     1.03       98.8 ##  3 B immature (Intercept)___… NA     -0.215     0.139   0.553    1.00       65.6 ##  4 B immature typehealthy___… NA     -0.238     0.0770  0.442    1.02       76.1 ##  5 B immature (Intercept)___… NA     -0.300     0.0596  0.374    1.02       99.0 ##  6 B immature typehealthy___… NA     -0.197     0.0676  0.359    1.00      209.  ##  7 B immature (Intercept)___… NA     -0.0139    0.253   0.659    1.00      110.  ##  8 B immature (Intercept)___… NA     -0.741    -0.314   0.0595   1.03       54.7 ##  9 B immature (Intercept)___… NA     -0.503    -0.155   0.0731   1.02       81.1 ## 10 B immature (Intercept)___… NA      0.00947   0.243   0.647    1.01       91.4 ## # ℹ 290 more rows ## # ℹ 7 more variables: c_ess_tail <dbl>, v_lower <dbl>, v_effect <dbl>, ## #   v_upper <dbl>, v_rhat <dbl>, v_ess_bulk <dbl>, v_ess_tail <dbl>"},{"path":"https://mangiolalaboratory.github.io/sccomp/articles/introduction.html","id":"result-interpretation-and-communication","dir":"Articles","previous_headings":"Analysis Tutorial","what":"Result Interpretation and Communication","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","text":"estimated effects expressed unconstrained space parameters, similar differential expression analysis expresses changes terms log fold change. However, differences proportion, logit fold change must used, harder interpret understand. Therefore, provide intuitive proportional fold change can easily understood. However, used infer significance (use sccomp_test() instead), lot care must taken given nonlinearity measures (1-fold increase 0.0001 0.0002 carries different weight 1-fold increase 0.4 0.8). estimates, can specify effects interested (can subset full model wish exclude unwanted effects), two points like compare. case categorical variable, starting ending points categories.","code":"res |>     sccomp_proportional_fold_change(      formula_composition = ~  type,      from =  \"healthy\",       to = \"cancer\"     ) |>    select(cell_group, statement) ## Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... ##  ## Chain 1 finished in 0.0 seconds. ## # A tibble: 30 × 2 ##    cell_group           statement                                 ##    <chr>                <glue>                                    ##  1 B immature           2-fold decrease (from 0.1031 to 0.0518)   ##  2 B mem                2.3-fold decrease (from 0.0325 to 0.0142) ##  3 CD4 cm high cytokine 7.7-fold increase (from 0.0016 to 0.0123) ##  4 CD4 cm ribosome      3.5-fold increase (from 0.0076 to 0.0264) ##  5 CD4 cm S100A4        1.5-fold decrease (from 0.1434 to 0.0951) ##  6 CD4 em high cytokine 4.4-fold increase (from 0.0024 to 0.0104) ##  7 CD4 naive            1.5-fold decrease (from 0.115 to 0.0779)  ##  8 CD4 ribosome         2.7-fold decrease (from 0.0838 to 0.0312) ##  9 CD8 em 1             1.2-fold increase (from 0.0494 to 0.0585) ## 10 CD8 em 2             3.6-fold increase (from 0.006 to 0.0215)  ## # ℹ 20 more rows"},{"path":"https://mangiolalaboratory.github.io/sccomp/articles/introduction.html","id":"contrasts-analysis","dir":"Articles","previous_headings":"Analysis Tutorial","what":"Contrasts Analysis","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","text":"","code":"seurat_obj |>   sccomp_estimate(      formula_composition = ~ 0 + type,      sample = \"sample\",     cell_group = \"cell_group\",      cores = 1, verbose = FALSE,     max_sampling_iterations = 2000   ) |>    sccomp_test( contrasts =  c(\"typecancer - typehealthy\", \"typehealthy - typecancer\")) ## sccomp model ## ============ ##  ## Model specifications: ##   Family: multi_beta_binomial  ##   Composition formula: ~0 + type  ##   Variability formula: ~1  ##   Inference method: pathfinder  ##  ## Data: Samples: 20   Cell groups: 30  ##  ## Column prefixes: c_ -> composition parameters  v_ -> variability parameters ##  ## Convergence diagnostics: ##   For each parameter, n_eff is the effective sample size and R_k_hat is the potential ##   scale reduction factor on split chains (at convergence, R_k_hat = 1). ##  ## # A tibble: 60 × 11 ##    cell_group   parameter factor c_lower c_effect c_upper   c_pH0   c_FDR c_rhat ##    <chr>        <chr>     <chr>    <dbl>    <dbl>   <dbl>   <dbl>   <dbl>  <dbl> ##  1 B immature   typecanc… NA      -1.91    -1.35   -0.811 0       0           NA ##  2 B immature   typeheal… NA       0.811    1.35    1.91  0       0           NA ##  3 B mem        typecanc… NA      -2.20    -1.65   -1.11  0       0           NA ##  4 B mem        typeheal… NA       1.11     1.65    2.20  0       0           NA ##  5 CD4 cm S100… typecanc… NA      -1.48    -0.995  -0.525 5.00e-4 8.33e-5     NA ##  6 CD4 cm S100… typeheal… NA       0.525    0.995   1.48  5.00e-4 8.33e-5     NA ##  7 CD4 cm high… typecanc… NA       0.975    1.58    2.19  0       0           NA ##  8 CD4 cm high… typeheal… NA      -2.19    -1.58   -0.975 0       0           NA ##  9 CD4 cm ribo… typecanc… NA       0.324    0.954   1.52  4.50e-3 1.12e-3     NA ## 10 CD4 cm ribo… typeheal… NA      -1.52    -0.954  -0.324 4.50e-3 1.12e-3     NA ## # ℹ 50 more rows ## # ℹ 2 more variables: c_ess_bulk <dbl>, c_ess_tail <dbl>"},{"path":"https://mangiolalaboratory.github.io/sccomp/articles/introduction.html","id":"categorical-factor-analysis-bayesian-anova","dir":"Articles","previous_headings":"Analysis Tutorial","what":"Categorical Factor Analysis (Bayesian ANOVA)","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","text":"achieved model comparison loo. following example, model association factors better fits data compared baseline model factor association. model comparisons sccomp_remove_outliers() must executed leave-one-must work amount data, outlier elimination guarantee . elpd_diff away zero > 5 se_diff difference 5, confident model better reference. case, -79.9 / 11.5 = -6.9, therefore can conclude model one, one factor association, better model two.","code":"library(loo)  # Fit first model model_with_factor_association =    seurat_obj |>   sccomp_estimate(      formula_composition = ~ type,      sample = \"sample\",      cell_group = \"cell_group\",      inference_method = \"hmc\",     enable_loo = TRUE,     verbose = FALSE,     max_sampling_iterations = 2000   )  # Fit second model model_without_association =    seurat_obj |>   sccomp_estimate(      formula_composition = ~ 1,      sample = \"sample\",      cell_group = \"cell_group\",      inference_method = \"hmc\",     enable_loo = TRUE,     verbose = FALSE,     max_sampling_iterations = 2000   )  # Compare models loo_compare(    attr(model_with_factor_association, \"fit\")$loo(),    attr(model_without_association, \"fit\")$loo() ) ##        elpd_diff se_diff ## model1   0.0       0.0   ## model2 -83.5      10.4"},{"path":"https://mangiolalaboratory.github.io/sccomp/articles/introduction.html","id":"differential-variability-analysis","dir":"Articles","previous_headings":"Analysis Tutorial","what":"Differential Variability Analysis","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","text":"can model cell-group variability also dependent type, test differences variability Plot 1D significance plot  Plot 2D significance plot Data points cell groups. Error bars 95% credible interval. dashed lines represent default threshold fold change probabilities (c_pH0, v_pH0) calculated. pH0 0 represent rejection null hypothesis effect observed. plot provided differential variability tested. differential variability estimates reliable linear association mean variability (intercept) (left-hand side facet) satisfied. scatterplot (besides Intercept) provided category interest. category interest, composition variability effects generally uncorrelated.","code":"res =    seurat_obj |>   sccomp_estimate(      formula_composition = ~ type,      formula_variability = ~ type,     sample = \"sample\",     cell_group = \"cell_group\",     cores = 1, verbose = FALSE,     max_sampling_iterations = 2000   )  res ## sccomp model ## ============ ##  ## Model specifications: ##   Family: multi_beta_binomial  ##   Composition formula: ~type  ##   Variability formula: ~type  ##   Inference method: pathfinder  ##  ## Data: Samples: 20   Cell groups: 30  ##  ## Column prefixes: c_ -> composition parameters  v_ -> variability parameters ##  ## Convergence diagnostics: ##   For each parameter, n_eff is the effective sample size and R_k_hat is the potential ##   scale reduction factor on split chains (at convergence, R_k_hat = 1). ##  ## # A tibble: 60 × 15 ##    cell_group        parameter factor c_lower c_effect c_upper c_rhat c_ess_bulk ##    <chr>             <chr>     <chr>    <dbl>    <dbl>   <dbl>  <dbl>      <dbl> ##  1 B immature        (Interce… NA      0.483     0.816   1.15   1.00       1109. ##  2 B immature        typeheal… type    1.01      1.37    1.73   1.00        672. ##  3 B mem             (Interce… NA     -1.09     -0.686  -0.284  1.00        216. ##  4 B mem             typeheal… type    1.19      1.60    2.03   1.00        265. ##  5 CD4 cm S100A4     (Interce… NA      1.46      1.71    1.97   1.000      1433. ##  6 CD4 cm S100A4     typeheal… type    0.594     0.897   1.20   1.00        749. ##  7 CD4 cm high cyto… (Interce… NA     -0.998    -0.597  -0.192  1.00        975. ##  8 CD4 cm high cyto… typeheal… type   -1.80     -1.22   -0.684  1.00        116. ##  9 CD4 cm ribosome   (Interce… NA     -0.0762    0.310   0.675  1.000      1312. ## 10 CD4 cm ribosome   typeheal… type   -1.31     -0.910  -0.482  1.00        827. ## # ℹ 50 more rows ## # ℹ 7 more variables: c_ess_tail <dbl>, v_lower <dbl>, v_effect <dbl>, ## #   v_upper <dbl>, v_rhat <dbl>, v_ess_bulk <dbl>, v_ess_tail <dbl> plots = res |> sccomp_test() |> plot() ## Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... ##  ## Chain 1 finished in 0.0 seconds. plots$credible_intervals_1D plots$credible_intervals_2D"},{"path":[]},{"path":"https://mangiolalaboratory.github.io/sccomp/articles/introduction.html","id":"for-single-cell-rna-sequencing","dir":"Articles","previous_headings":"Recommended Settings for Different Data Types","what":"For Single-Cell RNA Sequencing","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","text":"recommend setting bimodal_mean_variability_association  = TRUE. bimodality mean-variability association can confirmed plots$credible_intervals_2D (see ).","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/articles/introduction.html","id":"for-cytof-and-microbiome-data","dir":"Articles","previous_headings":"Recommended Settings for Different Data Types","what":"For CyTOF and Microbiome Data","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","text":"recommend setting bimodal_mean_variability_association  = FALSE (Default).","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/articles/introduction.html","id":"mcmc-chain-visualization","dir":"Articles","previous_headings":"Recommended Settings for Different Data Types","what":"MCMC Chain Visualization","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data","text":"possible directly evaluate posterior distribution. example, plot Monte Carlo chain slope parameter first cell type. can see converged negative probability 1.","code":"library(cmdstanr) library(posterior) library(bayesplot)  # Assuming res contains the fit object from cmdstanr fit <- res |> attr(\"fit\")  # Extract draws for 'beta[2,1]' draws <- as_draws_array(fit$draws(\"beta[2,1]\"))  # Create a traceplot for 'beta[2,1]' mcmc_trace(draws, pars = \"beta[2,1]\") + theme_bw() sessionInfo() ## R version 4.5.2 (2025-10-31) ## Platform: x86_64-pc-linux-gnu ## Running under: Ubuntu 24.04.3 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## time zone: UTC ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ##  [1] bayesplot_1.14.0  posterior_1.6.1   cmdstanr_0.9.0    loo_2.8.0         ##  [5] tidyr_1.3.1       forcats_1.0.1     ggplot2_4.0.0     sccomp_2.1.20     ##  [9] instantiate_0.2.3 dplyr_1.1.4       ##  ## loaded via a namespace (and not attached): ##  [1] tidyselect_1.2.1            farver_2.1.2                ##  [3] S7_0.2.0                    fastmap_1.2.0               ##  [5] SingleCellExperiment_1.32.0 tensorA_0.36.2.1            ##  [7] dotCall64_1.2               digest_0.6.38               ##  [9] lifecycle_1.0.4             SeuratObject_5.2.0          ## [11] processx_3.8.6              magrittr_2.0.4              ## [13] compiler_4.5.2              rlang_1.1.6                 ## [15] sass_0.4.10                 tools_4.5.2                 ## [17] utf8_1.2.6                  yaml_2.3.10                 ## [19] data.table_1.17.8           knitr_1.50                  ## [21] labeling_0.4.3              S4Arrays_1.10.0             ## [23] htmlwidgets_1.6.4           sp_2.2-0                    ## [25] DelayedArray_0.36.0         plyr_1.8.9                  ## [27] RColorBrewer_1.1-3          abind_1.4-8                 ## [29] withr_3.0.2                 purrr_1.2.0                 ## [31] BiocGenerics_0.56.0         desc_1.4.3                  ## [33] grid_4.5.2                  stats4_4.5.2                ## [35] future_1.67.0               progressr_0.18.0            ## [37] globals_0.18.0              scales_1.4.0                ## [39] SummarizedExperiment_1.40.0 cli_3.6.5                   ## [41] rmarkdown_2.30              crayon_1.5.3                ## [43] ragg_1.5.0                  generics_0.1.4              ## [45] future.apply_1.20.0         reshape2_1.4.5              ## [47] tzdb_0.5.0                  cachem_1.1.0                ## [49] stringr_1.6.0               parallel_4.5.2              ## [51] XVector_0.50.0              matrixStats_1.5.0           ## [53] vctrs_0.6.5                 Matrix_1.7-4                ## [55] jsonlite_2.0.0              callr_3.7.6                 ## [57] IRanges_2.44.0              hms_1.1.4                   ## [59] patchwork_1.3.2             S4Vectors_0.48.0            ## [61] ggrepel_0.9.6               listenv_0.10.0              ## [63] systemfonts_1.3.1           jquerylib_0.1.4             ## [65] spam_2.11-1                 parallelly_1.45.1           ## [67] glue_1.8.0                  pkgdown_2.2.0               ## [69] codetools_0.2-20            ps_1.9.1                    ## [71] distributional_0.5.0        stringi_1.8.7               ## [73] gtable_0.3.6                GenomicRanges_1.62.0        ## [75] tibble_3.3.0                pillar_1.11.1               ## [77] htmltools_0.5.8.1           Seqinfo_1.0.0               ## [79] R6_2.6.1                    textshaping_1.0.4           ## [81] evaluate_1.0.5              lattice_0.22-7              ## [83] Biobase_2.70.0              readr_2.1.5                 ## [85] backports_1.5.0             bslib_0.9.0                 ## [87] Rcpp_1.1.0                  SparseArray_1.10.1          ## [89] checkmate_2.3.3             xfun_0.54                   ## [91] fs_1.6.6                    MatrixGenerics_1.22.0       ## [93] prettydoc_0.4.1             pkgconfig_2.0.3"},{"path":"https://mangiolalaboratory.github.io/sccomp/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Stefano Mangiola. Author, maintainer. Alexandra J. Roth-Schulze. Author. Marie Trussart. Author. Enrique Zozaya-Valdés. Author. Mengyao Ma. Author. Zijie Gao. Author. Alan F. Rubin. Author. Terence P. Speed. Author. Heejung Shim. Author. Anthony T. Papenfuss. Author.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Mangiola, S., Roth-Schulze, .J., Trussart, M., Zozaya-Valdés, E., Ma, M., Gao, Z., Rubin, .F., Speed, T.P., Shim, H., Papenfuss, .T. sccomp: Robust differential composition variability analysis single-cell data roc. Natl. Acad. Sci. U. S. . 120, e2203828120","code":"@Article{,   title = {sccomp: Robust differential composition and variability analysis for single-cell data},   author = {Stefano Mangiola and Alexandra J. Roth-Schulze and Marie Trussart and Enrique Zozaya-Valdés and Mengyao Ma and Zijie Gao and Alan F. Rubin and Terence P. Speed and Heejung Shim and Anthony T. Papenfuss},   year = {2023},   journal = {PNAS},   doi = {10.1073/pnas.2203828120},   volume = {120},   issue = {33}, }"},{"path":"https://mangiolalaboratory.github.io/sccomp/index.html","id":"section","dir":"","previous_headings":"","what":"Differential Composition and Variability Analysis for Single-Cell Data","title":"Differential Composition and Variability Analysis for Single-Cell Data","text":"sccomp powerful R package designed comprehensive differential composition variability analysis single-cell genomics, proteomics, microbiomics data.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/index.html","id":"why-sccomp","dir":"","previous_headings":"","what":"Why sccomp?","title":"Differential Composition and Variability Analysis for Single-Cell Data","text":"cellular omic data, method differential variability analysis exists, methods differential composition analysis take fundamental data properties account. introduce sccomp, generalised method differential composition variability analyses capable jointly modelling data count distribution, compositionality, group-specific variability, proportion mean-variability association, robust outliers.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/index.html","id":"comprehensive-method-comparison","dir":"","previous_headings":"Why sccomp?","what":"Comprehensive Method Comparison","title":"Differential Composition and Variability Analysis for Single-Cell Data","text":": Data modelled counts. II: Group proportions modelled compositional. III: proportion variability modelled cell-type specific. IV: Information sharing across cell types, mean–variability association. V: Outlier detection robustness. VI: Differential variability analysis. VII Mixed effect modelling VIII Removal unwanted effects","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/index.html","id":"scientific-citation","dir":"","previous_headings":"Why sccomp?","what":"Scientific Citation","title":"Differential Composition and Variability Analysis for Single-Cell Data","text":"Mangiola, Stefano, Alexandra J. Roth-Schulze, Marie Trussart, Enrique Zozaya-Valdés, Mengyao Ma, Zijie Gao, Alan F. Rubin, Terence P. Speed, Heejung Shim, Anthony T. Papenfuss. 2023. “Sccomp: Robust Differential Composition Variability Analysis Single-Cell Data.” Proceedings National Academy Sciences United States America 120 (33): e2203828120. https://doi.org/10.1073/pnas.2203828120 PNAS - sccomp: Robust differential composition variability analysis single-cell data","code":""},{"path":[]},{"path":"https://mangiolalaboratory.github.io/sccomp/index.html","id":"installation-guide","dir":"","previous_headings":"","what":"Installation Guide","title":"Differential Composition and Variability Analysis for Single-Cell Data","text":"sccomp based cmdstanr provides latest version cmdstan Bayesian modelling tool. cmdstanr CRAN, need 3 simple step process (prompted user forgot). R installation sccomp R installation cmdstanr cmdstanr call cmdstan installation Bioconductor Github","code":"if (!requireNamespace(\"BiocManager\")) install.packages(\"BiocManager\")  # Step 1 BiocManager::install(\"sccomp\")  # Step 2 install.packages(\"cmdstanr\", repos = c(\"https://stan-dev.r-universe.dev/\", getOption(\"repos\")))  # Step 3 cmdstanr::check_cmdstan_toolchain(fix = TRUE) # Just checking system setting cmdstanr::install_cmdstan() # Step 1 devtools::install_github(\"MangiolaLaboratory/sccomp\")  # Step 2 install.packages(\"cmdstanr\", repos = c(\"https://stan-dev.r-universe.dev/\", getOption(\"repos\")))  # Step 3 cmdstanr::check_cmdstan_toolchain(fix = TRUE) # Just checking system setting cmdstanr::install_cmdstan()"},{"path":[]},{"path":"https://mangiolalaboratory.github.io/sccomp/index.html","id":"analysis-tutorial","dir":"","previous_headings":"","what":"Analysis Tutorial","title":"Differential Composition and Variability Analysis for Single-Cell Data","text":"","code":"library(dplyr) library(sccomp) library(ggplot2) library(forcats) library(tidyr) data(\"seurat_obj\") data(\"sce_obj\") data(\"counts_obj\")"},{"path":"https://mangiolalaboratory.github.io/sccomp/index.html","id":"binary-factor-analysis","dir":"","previous_headings":"","what":"Binary Factor Analysis","title":"Differential Composition and Variability Analysis for Single-Cell Data","text":"output table, estimate columns start prefix c_ indicate composition, v_ indicate variability (formula_variability set).","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/index.html","id":"from-seurat-singlecellexperiment-metadata-objects","dir":"","previous_headings":"Binary Factor Analysis","what":"From Seurat, SingleCellExperiment, metadata objects","title":"Differential Composition and Variability Analysis for Single-Cell Data","text":"","code":"sccomp_result =    sce_obj |>   sccomp_estimate(      formula_composition = ~ type,      sample = \"sample\",      cell_group = \"cell_group\",      cores = 1,     verbose = FALSE   ) |>    sccomp_test()"},{"path":"https://mangiolalaboratory.github.io/sccomp/index.html","id":"from-counts","dir":"","previous_headings":"Binary Factor Analysis","what":"From counts","title":"Differential Composition and Variability Analysis for Single-Cell Data","text":"see results fit, effects factor composition variability. also can see uncertainty around effects. output tibble containing Following columns cell_group - cell groups tested. parameter - parameter estimated design matrix described input formula_composition formula_variability. factor - covariate factor formula, applicable (e.g., present Intercept contrasts). c_lower - Lower (2.5%) quantile posterior distribution composition (c) parameter. c_effect - Mean posterior distribution composition (c) parameter. c_upper - Upper (97.5%) quantile posterior distribution composition (c) parameter. c_pH0 - Probability null hypothesis (difference) composition (c). p-value. c_FDR - False-discovery rate null hypothesis composition (c). v_lower - Lower (2.5%) quantile posterior distribution variability (v) parameter. v_effect - Mean posterior distribution variability (v) parameter. v_upper - Upper (97.5%) quantile posterior distribution variability (v) parameter. v_pH0 - Probability null hypothesis variability (v). v_FDR - False-discovery rate null hypothesis variability (v). count_data - Nested input count data.","code":"sccomp_result =    counts_obj |>   sccomp_estimate(      formula_composition = ~ type,      sample = \"sample\",     cell_group = \"cell_group\",     abundance = \"count\",      cores = 1, verbose = FALSE   ) |>    sccomp_test() sccomp_result ## sccomp model ## ============ ##  ## Model specifications: ##   Family: multi_beta_binomial  ##   Composition formula: ~type  ##   Variability formula: ~1  ##   Inference method: pathfinder  ##  ## Data: Samples: 20   Cell groups: 36  ##  ## Column prefixes: c_ -> composition parameters  v_ -> variability parameters ##  ## Convergence diagnostics: ##   For each parameter, n_eff is the effective sample size and R_k_hat is the potential ##   scale reduction factor on split chains (at convergence, R_k_hat = 1). ##  ## # A tibble: 72 × 19 ##    cell_group parameter   factor c_lower c_effect c_upper   c_pH0   c_FDR c_rhat ##    <chr>      <chr>       <chr>    <dbl>    <dbl>   <dbl>   <dbl>   <dbl>  <dbl> ##  1 B1         (Intercept) <NA>    0.946     1.19   1.45   0       0        1.000 ##  2 B1         typecancer  type   -0.927    -0.611 -0.288  7.50e-4 6.82e-5  1.000 ##  3 B2         (Intercept) <NA>    0.507     0.765  1.04   0       0        1.00  ##  4 B2         typecancer  type   -0.991    -0.669 -0.359  0       0        1.00  ##  5 B3         (Intercept) <NA>   -0.582    -0.331 -0.0661 4.17e-2 3.52e-3  1.00  ##  6 B3         typecancer  type   -0.577    -0.280  0.0152 1.21e-1 2.47e-2  1.00  ##  7 BM         (Intercept) <NA>   -1.23     -0.968 -0.716  0       0        1.00  ##  8 BM         typecancer  type   -0.587    -0.286  0.0191 1.14e-1 1.62e-2  1.00  ##  9 CD4 1      (Intercept) <NA>    0.201     0.367  0.535  1.00e-3 7.00e-5  1.00  ## 10 CD4 1      typecancer  type   -0.0129    0.205  0.410  1.67e-1 3.04e-2  1.00  ## # ℹ 62 more rows ## # ℹ 10 more variables: c_ess_bulk <dbl>, c_ess_tail <dbl>, v_lower <dbl>, ## #   v_effect <dbl>, v_upper <dbl>, v_pH0 <dbl>, v_FDR <dbl>, v_rhat <dbl>, ## #   v_ess_bulk <dbl>, v_ess_tail <dbl>"},{"path":"https://mangiolalaboratory.github.io/sccomp/index.html","id":"outlier-identification","dir":"","previous_headings":"","what":"Outlier Identification","title":"Differential Composition and Variability Analysis for Single-Cell Data","text":"sccomp can identify outliers probabilistically exclude estimation.","code":"sccomp_result =    counts_obj |>   sccomp_estimate(      formula_composition = ~ type,      sample = \"sample\",     cell_group = \"cell_group\",     abundance = \"count\",      cores = 1, verbose = FALSE   ) |>       # max_sampling_iterations is used her to not exceed the maximum file size for GitHub action of 100Mb   sccomp_remove_outliers(cores = 1, verbose = FALSE, max_sampling_iterations = 2000) |> # Optional   sccomp_test() ## Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... ##  ## Chain 1 finished in 0.0 seconds.  ## Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... ##  ## Chain 1 finished in 0.0 seconds."},{"path":"https://mangiolalaboratory.github.io/sccomp/index.html","id":"visualization-and-summary-plots","dir":"","previous_headings":"","what":"Visualization and Summary Plots","title":"Differential Composition and Variability Analysis for Single-Cell Data","text":"plot group proportions, faceted groups. blue boxplots represent posterior predictive check. model descriptively adequate data, blue boxplots roughly overlay black boxplots, represent observed data. outliers coloured red. boxplot returned every (discrete) covariate present formula_composition. colour coding represents significant associations composition /variability.  can plot proportions adjusted unwanted effects. helpful especially complex models, multiple factors can significantly impact proportions.  plot estimates differential composition (c_) x-axis differential variability (v_) y-axis. error bars represent 95% credible intervals. dashed lines represent minimal effect hypothesis test based . effect labelled significant exceeds minimal effect according 95% credible interval. Facets represent covariates model.  can plot relationship abundance variability. can see , positively correlated. sccomp models relationship obtain shrinkage effect estimates abundance variability. shrinkage adaptive modelled jointly, thanks Bayesian inference.  can produce series plots calling plot method.","code":"sccomp_result |>    sccomp_boxplot(factor = \"type\") ## Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... ##  ## Chain 1 finished in 0.0 seconds. sccomp_result |>    sccomp_boxplot(factor = \"type\", remove_unwanted_effects = TRUE) ## Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... ##  ## Chain 1 finished in 0.0 seconds.  ## Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... ##  ## Chain 1 finished in 0.0 seconds.  ## Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... ##  ## Chain 1 finished in 0.0 seconds. sccomp_result |>    plot_1D_intervals() sccomp_result |>    plot_2D_intervals() sccomp_result |> plot()"},{"path":"https://mangiolalaboratory.github.io/sccomp/index.html","id":"model-proportions-directly-eg-from-deconvolution","dir":"","previous_headings":"","what":"Model Proportions Directly (e.g. from deconvolution)","title":"Differential Composition and Variability Analysis for Single-Cell Data","text":"Note: counts available, strongly discourage use proportions, important source uncertainty (.e., rare groups/cell types) modeled. use proportions better suited modelling deconvolution results (e.g., bulk RNA data), case counts available. Proportions greater 0. Assuming zeros derive precision threshold (e.g., deconvolution), zeros converted smallest non-zero value.","code":"sccomp_result =    counts_obj |>   sccomp_estimate(      formula_composition = ~ type,      sample = \"sample\",     cell_group = \"cell_group\",     abundance = \"proportion\",      cores = 1, verbose = FALSE   ) |>    sccomp_test()"},{"path":"https://mangiolalaboratory.github.io/sccomp/index.html","id":"continuous-factor-analysis","dir":"","previous_headings":"","what":"Continuous Factor Analysis","title":"Differential Composition and Variability Analysis for Single-Cell Data","text":"sccomp able fit arbitrary complex models. example continuous binary covariate.","code":"res =     seurat_obj |>     sccomp_estimate(       formula_composition = ~ type + continuous_covariate,        sample = \"sample\",        cell_group = \"cell_group\",       cores = 1, verbose=FALSE     )  res ## sccomp model ## ============ ##  ## Model specifications: ##   Family: multi_beta_binomial  ##   Composition formula: ~type + continuous_covariate  ##   Variability formula: ~1  ##   Inference method: pathfinder  ##  ## Data: Samples: 20   Cell groups: 30  ##  ## Column prefixes: c_ -> composition parameters  v_ -> variability parameters ##  ## Convergence diagnostics: ##   For each parameter, n_eff is the effective sample size and R_k_hat is the potential ##   scale reduction factor on split chains (at convergence, R_k_hat = 1). ##  ## # A tibble: 90 × 15 ##    cell_group        parameter factor c_lower c_effect c_upper c_rhat c_ess_bulk ##    <chr>             <chr>     <chr>    <dbl>    <dbl>   <dbl>  <dbl>      <dbl> ##  1 B immature        (Interce… <NA>     0.567   0.834    1.11   1.00       3604. ##  2 B immature        typeheal… type     1.02    1.35     1.67   1.000      3998. ##  3 B immature        continuo… conti…  -0.277   0.0479   0.373  1.000      3755. ##  4 B mem             (Interce… <NA>    -0.978  -0.674   -0.362  1.00       3907. ##  5 B mem             typeheal… type     1.21    1.57     1.95   1.00       3564. ##  6 B mem             continuo… conti…  -0.275   0.0684   0.411  1.00       3928. ##  7 CD4 cm S100A4     (Interce… <NA>     1.33    1.55     1.79   1.00       3739. ##  8 CD4 cm S100A4     typeheal… type     0.859   1.13     1.40   1.00       4241. ##  9 CD4 cm S100A4     continuo… conti…  -0.103   0.172    0.458  1.00       3766. ## 10 CD4 cm high cyto… (Interce… <NA>    -0.923  -0.582   -0.242  1.000      4070. ## # ℹ 80 more rows ## # ℹ 7 more variables: c_ess_tail <dbl>, v_lower <dbl>, v_effect <dbl>, ## #   v_upper <dbl>, v_rhat <dbl>, v_ess_bulk <dbl>, v_ess_tail <dbl>"},{"path":"https://mangiolalaboratory.github.io/sccomp/index.html","id":"random-effect-modeling-mixed-effect-modeling","dir":"","previous_headings":"","what":"Random Effect Modeling (Mixed-Effect Modeling)","title":"Differential Composition and Variability Analysis for Single-Cell Data","text":"sccomp supports multilevel modeling allowing inclusion random effects compositional variability formulas. particularly useful data hierarchical grouped structures, measurements nested within subjects, batches, experimental units. incorporating random effects, sccomp can account variability different levels data, improving model fit inference accuracy.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/index.html","id":"random-intercept-model","dir":"","previous_headings":"Random Effect Modeling (Mixed-Effect Modeling)","what":"Random Intercept Model","title":"Differential Composition and Variability Analysis for Single-Cell Data","text":"example, demonstrate fit random intercept model using sccomp. ’ll model cell-type proportions fixed effects (e.g., treatment) random effects (e.g., subject-specific variability). input data","code":"seurat_obj[[]] |> as_tibble() ## # A tibble: 106,297 × 9 ##    cell_group nCount_RNA nFeature_RNA group__ group__wrong sample type  group2__ ##    <chr>           <dbl>        <int> <chr>   <chr>        <chr>  <chr> <chr>    ##  1 CD4 naive           0            0 GROUP1  1            SI-GA… canc… GROUP21  ##  2 Mono clas…          0            0 GROUP1  1            SI-GA… canc… GROUP21  ##  3 CD4 cm S1…          0            0 GROUP1  1            SI-GA… canc… GROUP21  ##  4 B immature          0            0 GROUP1  1            SI-GA… canc… GROUP21  ##  5 CD8 naive           0            0 GROUP1  1            SI-GA… canc… GROUP21  ##  6 CD4 naive           0            0 GROUP1  1            SI-GA… canc… GROUP21  ##  7 Mono clas…          0            0 GROUP1  1            SI-GA… canc… GROUP21  ##  8 CD4 cm S1…          0            0 GROUP1  1            SI-GA… canc… GROUP21  ##  9 CD4 cm hi…          0            0 GROUP1  1            SI-GA… canc… GROUP21  ## 10 B immature          0            0 GROUP1  1            SI-GA… canc… GROUP21  ## # ℹ 106,287 more rows ## # ℹ 1 more variable: continuous_covariate <dbl> res =    seurat_obj |>   sccomp_estimate(      formula_composition = ~ type + (1 | group__),      sample = \"sample\",     cell_group = \"cell_group\",     bimodal_mean_variability_association = TRUE,     cores = 1, verbose = FALSE   )   res ## sccomp model ## ============ ##  ## Model specifications: ##   Family: multi_beta_binomial  ##   Composition formula: ~type + (1 | group__)  ##   Variability formula: ~1  ##   Inference method: pathfinder  ##  ## Data: Samples: 20   Cell groups: 30  ##  ## Column prefixes: c_ -> composition parameters  v_ -> variability parameters ##  ## Convergence diagnostics: ##   For each parameter, n_eff is the effective sample size and R_k_hat is the potential ##   scale reduction factor on split chains (at convergence, R_k_hat = 1). ##  ## # A tibble: 180 × 15 ##    cell_group parameter        factor c_lower c_effect c_upper c_rhat c_ess_bulk ##    <chr>      <chr>            <chr>    <dbl>    <dbl>   <dbl>  <dbl>      <dbl> ##  1 B immature (Intercept)      <NA>     0.500   0.846   1.16    1.00        218. ##  2 B immature typehealthy      type     0.755   1.21    1.65    1.00        115. ##  3 B immature (Intercept)___G… <NA>    -0.320   0.0226  0.478   1.00        127. ##  4 B immature (Intercept)___G… <NA>    -0.105   0.233   0.703   1.000       128. ##  5 B immature (Intercept)___G… <NA>    -0.101   0.225   0.620   1.00        184. ##  6 B immature (Intercept)___G… <NA>    -0.711  -0.288   0.0297  1.00        201. ##  7 B mem      (Intercept)      <NA>    -0.857  -0.466  -0.0933  1.00        130. ##  8 B mem      typehealthy      type     0.797   1.27    1.78    1.00        103. ##  9 B mem      (Intercept)___G… <NA>    -0.469   0.0137  0.484   1.02        123. ## 10 B mem      (Intercept)___G… <NA>    -0.166   0.271   0.763   1.01        161. ## # ℹ 170 more rows ## # ℹ 7 more variables: c_ess_tail <dbl>, v_lower <dbl>, v_effect <dbl>, ## #   v_upper <dbl>, v_rhat <dbl>, v_ess_bulk <dbl>, v_ess_tail <dbl>"},{"path":"https://mangiolalaboratory.github.io/sccomp/index.html","id":"random-effect-model-random-slopes","dir":"","previous_headings":"Random Effect Modeling (Mixed-Effect Modeling)","what":"Random Effect Model (random slopes)","title":"Differential Composition and Variability Analysis for Single-Cell Data","text":"sccomp can model random slopes. provide example .","code":"res =    seurat_obj |>   sccomp_estimate(       formula_composition = ~ type + (type | group__),       sample = \"sample\",       cell_group = \"cell_group\",       bimodal_mean_variability_association = TRUE,       cores = 1, verbose = FALSE     )  res ## sccomp model ## ============ ##  ## Model specifications: ##   Family: multi_beta_binomial  ##   Composition formula: ~type + (type | group__)  ##   Variability formula: ~1  ##   Inference method: pathfinder  ##  ## Data: Samples: 20   Cell groups: 30  ##  ## Column prefixes: c_ -> composition parameters  v_ -> variability parameters ##  ## Convergence diagnostics: ##   For each parameter, n_eff is the effective sample size and R_k_hat is the potential ##   scale reduction factor on split chains (at convergence, R_k_hat = 1). ##  ## # A tibble: 240 × 15 ##    cell_group parameter        factor c_lower c_effect c_upper c_rhat c_ess_bulk ##    <chr>      <chr>            <chr>    <dbl>    <dbl>   <dbl>  <dbl>      <dbl> ##  1 B immature (Intercept)      <NA>    0.466    0.836   1.20     1.01      135.  ##  2 B immature typehealthy      type    0.758    1.20    1.62     1.00      139.  ##  3 B immature (Intercept)___G… <NA>   -0.234    0.0271  0.331    1.00      235.  ##  4 B immature typehealthy___G… <NA>   -0.233    0.0139  0.330    1.02      127.  ##  5 B immature (Intercept)___G… <NA>   -0.179    0.142   0.488    1.08       11.3 ##  6 B immature typehealthy___G… <NA>   -0.140    0.0934  0.433    1.01      125.  ##  7 B immature (Intercept)___G… <NA>   -0.0735   0.197   0.535    1.02      119.  ##  8 B immature (Intercept)___G… <NA>   -0.675   -0.242   0.0492   1.00      111.  ##  9 B mem      (Intercept)      <NA>   -1.01    -0.568  -0.205    1.00      181.  ## 10 B mem      typehealthy      type    0.902    1.35    1.89     1.01      113.  ## # ℹ 230 more rows ## # ℹ 7 more variables: c_ess_tail <dbl>, v_lower <dbl>, v_effect <dbl>, ## #   v_upper <dbl>, v_rhat <dbl>, v_ess_bulk <dbl>, v_ess_tail <dbl>"},{"path":"https://mangiolalaboratory.github.io/sccomp/index.html","id":"nested-random-effects","dir":"","previous_headings":"Random Effect Modeling (Mixed-Effect Modeling)","what":"Nested Random Effects","title":"Differential Composition and Variability Analysis for Single-Cell Data","text":"complex hierarchy, measurements nested within subjects subjects nested within batches, can include multiple grouping variables. group2__ nested within group__.","code":"res =    seurat_obj |>   sccomp_estimate(       formula_composition = ~ type + (type | group__) + (1 | group2__),       sample = \"sample\",       cell_group = \"cell_group\",       bimodal_mean_variability_association = TRUE,       cores = 1, verbose = FALSE     )  res ## sccomp model ## ============ ##  ## Model specifications: ##   Family: multi_beta_binomial  ##   Composition formula: ~type + (type | group__) + (1 | group2__)  ##   Variability formula: ~1  ##   Inference method: pathfinder  ##  ## Data: Samples: 20   Cell groups: 30  ##  ## Column prefixes: c_ -> composition parameters  v_ -> variability parameters ##  ## Convergence diagnostics: ##   For each parameter, n_eff is the effective sample size and R_k_hat is the potential ##   scale reduction factor on split chains (at convergence, R_k_hat = 1). ##  ## # A tibble: 300 × 15 ##    cell_group parameter       factor  c_lower c_effect c_upper c_rhat c_ess_bulk ##    <chr>      <chr>           <chr>     <dbl>    <dbl>   <dbl>  <dbl>      <dbl> ##  1 B immature (Intercept)     <NA>    0.444     0.795   1.38     1.02       60.0 ##  2 B immature typehealthy     type    0.808     1.25    1.70     1.02       78.8 ##  3 B immature (Intercept)___… <NA>   -0.154     0.0833  0.450    1.01       93.5 ##  4 B immature typehealthy___… <NA>   -0.166     0.0629  0.431    1.01       84.9 ##  5 B immature (Intercept)___… <NA>   -0.205     0.0588  0.315    1.01      182.  ##  6 B immature typehealthy___… <NA>   -0.168     0.0513  0.342    1.01      157.  ##  7 B immature (Intercept)___… <NA>   -0.123     0.213   0.609    1.02       71.4 ##  8 B immature (Intercept)___… <NA>   -0.728    -0.256   0.0495   1.04       59.2 ##  9 B immature (Intercept)___… <NA>   -0.432    -0.105   0.141    1.01      111.  ## 10 B immature (Intercept)___… <NA>   -0.00115   0.233   0.584    1.00       76.6 ## # ℹ 290 more rows ## # ℹ 7 more variables: c_ess_tail <dbl>, v_lower <dbl>, v_effect <dbl>, ## #   v_upper <dbl>, v_rhat <dbl>, v_ess_bulk <dbl>, v_ess_tail <dbl>"},{"path":"https://mangiolalaboratory.github.io/sccomp/index.html","id":"result-interpretation-and-communication","dir":"","previous_headings":"","what":"Result Interpretation and Communication","title":"Differential Composition and Variability Analysis for Single-Cell Data","text":"estimated effects expressed unconstrained space parameters, similar differential expression analysis expresses changes terms log fold change. However, differences proportion, logit fold change must used, harder interpret understand. Therefore, provide intuitive proportional fold change can easily understood. However, used infer significance (use sccomp_test() instead), lot care must taken given nonlinearity measures (1-fold increase 0.0001 0.0002 carries different weight 1-fold increase 0.4 0.8). estimates, can specify effects interested (can subset full model wish exclude unwanted effects), two points like compare. case categorical variable, starting ending points categories.","code":"res |>     sccomp_proportional_fold_change(      formula_composition = ~  type,      from =  \"healthy\",       to = \"cancer\"     ) |>    select(cell_group, statement) ## Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... ##  ## Chain 1 finished in 0.0 seconds.  ## # A tibble: 30 × 2 ##    cell_group           statement                                 ##    <chr>                <glue>                                    ##  1 B immature           2.1-fold decrease (from 0.1105 to 0.0521) ##  2 B mem                2.4-fold decrease (from 0.0331 to 0.0136) ##  3 CD4 cm high cytokine 8-fold increase (from 0.0015 to 0.0121)   ##  4 CD4 cm ribosome      3.7-fold increase (from 0.0072 to 0.0262) ##  5 CD4 cm S100A4        1.5-fold decrease (from 0.1497 to 0.1007) ##  6 CD4 em high cytokine 4.7-fold increase (from 0.0022 to 0.0105) ##  7 CD4 naive            1.5-fold decrease (from 0.1115 to 0.0748) ##  8 CD4 ribosome         3.1-fold decrease (from 0.085 to 0.0278)  ##  9 CD8 em 1             1.2-fold increase (from 0.0485 to 0.0571) ## 10 CD8 em 2             3.9-fold increase (from 0.0053 to 0.0204) ## # ℹ 20 more rows"},{"path":"https://mangiolalaboratory.github.io/sccomp/index.html","id":"contrasts-analysis","dir":"","previous_headings":"","what":"Contrasts Analysis","title":"Differential Composition and Variability Analysis for Single-Cell Data","text":"","code":"seurat_obj |>   sccomp_estimate(      formula_composition = ~ 0 + type,      sample = \"sample\",     cell_group = \"cell_group\",      cores = 1, verbose = FALSE   ) |>    sccomp_test( contrasts =  c(\"typecancer - typehealthy\", \"typehealthy - typecancer\")) ## sccomp model ## ============ ##  ## Model specifications: ##   Family: multi_beta_binomial  ##   Composition formula: ~0 + type  ##   Variability formula: ~1  ##   Inference method: pathfinder  ##  ## Data: Samples: 20   Cell groups: 30  ##  ## Column prefixes: c_ -> composition parameters  v_ -> variability parameters ##  ## Convergence diagnostics: ##   For each parameter, n_eff is the effective sample size and R_k_hat is the potential ##   scale reduction factor on split chains (at convergence, R_k_hat = 1). ##  ## # A tibble: 60 × 11 ##    cell_group   parameter factor c_lower c_effect c_upper   c_pH0   c_FDR c_rhat ##    <chr>        <chr>     <chr>    <dbl>    <dbl>   <dbl>   <dbl>   <dbl>  <dbl> ##  1 B immature   typecanc… <NA>    -1.90    -1.35   -0.810 0       0           NA ##  2 B immature   typeheal… <NA>     0.810    1.35    1.90  0       0           NA ##  3 B mem        typecanc… <NA>    -2.24    -1.66   -1.04  0       0           NA ##  4 B mem        typeheal… <NA>     1.04     1.66    2.24  0       0           NA ##  5 CD4 cm S100… typecanc… <NA>    -1.46    -0.990  -0.512 2.50e-4 4.17e-5     NA ##  6 CD4 cm S100… typeheal… <NA>     0.512    0.990   1.46  2.50e-4 4.17e-5     NA ##  7 CD4 cm high… typecanc… <NA>     0.964    1.58    2.20  0       0           NA ##  8 CD4 cm high… typeheal… <NA>    -2.20    -1.58   -0.964 0       0           NA ##  9 CD4 cm ribo… typecanc… <NA>     0.350    0.938   1.53  3.  e-3 9.55e-4     NA ## 10 CD4 cm ribo… typeheal… <NA>    -1.53    -0.938  -0.350 3.  e-3 9.55e-4     NA ## # ℹ 50 more rows ## # ℹ 2 more variables: c_ess_bulk <dbl>, c_ess_tail <dbl>"},{"path":"https://mangiolalaboratory.github.io/sccomp/index.html","id":"categorical-factor-analysis-bayesian-anova","dir":"","previous_headings":"","what":"Categorical Factor Analysis (Bayesian ANOVA)","title":"Differential Composition and Variability Analysis for Single-Cell Data","text":"achieved model comparison loo. following example, model association factors better fits data compared baseline model factor association. model comparisons sccomp_remove_outliers() must executed leave-one-must work amount data, outlier elimination guarantee . elpd_diff away zero > 5 se_diff difference 5, confident model better reference. case, -79.9 / 11.5 = -6.9, therefore can conclude model one, one factor association, better model two.","code":"library(loo)  # Fit first model model_with_factor_association =    seurat_obj |>   sccomp_estimate(      formula_composition = ~ type,      sample = \"sample\",      cell_group = \"cell_group\",      inference_method = \"hmc\",     enable_loo = TRUE,     verbose = FALSE   )  # Fit second model model_without_association =    seurat_obj |>   sccomp_estimate(      formula_composition = ~ 1,      sample = \"sample\",      cell_group = \"cell_group\",      inference_method = \"hmc\",     enable_loo = TRUE,     verbose = FALSE   )  # Compare models loo_compare(    attr(model_with_factor_association, \"fit\")$loo(),    attr(model_without_association, \"fit\")$loo() ) ##        elpd_diff se_diff ## model1   0.0       0.0   ## model2 -83.6      10.4"},{"path":"https://mangiolalaboratory.github.io/sccomp/index.html","id":"differential-variability-analysis","dir":"","previous_headings":"","what":"Differential Variability Analysis","title":"Differential Composition and Variability Analysis for Single-Cell Data","text":"can model cell-group variability also dependent type, test differences variability Plot 1D significance plot  Plot 2D significance plot Data points cell groups. Error bars 95% credible interval. dashed lines represent default threshold fold change probabilities (c_pH0, v_pH0) calculated. pH0 0 represent rejection null hypothesis effect observed. plot provided differential variability tested. differential variability estimates reliable linear association mean variability (intercept) (left-hand side facet) satisfied. scatterplot (besides Intercept) provided category interest. category interest, composition variability effects generally uncorrelated.","code":"res =    seurat_obj |>   sccomp_estimate(      formula_composition = ~ type,      formula_variability = ~ type,     sample = \"sample\",     cell_group = \"cell_group\",     cores = 1, verbose = FALSE   )  res ## sccomp model ## ============ ##  ## Model specifications: ##   Family: multi_beta_binomial  ##   Composition formula: ~type  ##   Variability formula: ~type  ##   Inference method: pathfinder  ##  ## Data: Samples: 20   Cell groups: 30  ##  ## Column prefixes: c_ -> composition parameters  v_ -> variability parameters ##  ## Convergence diagnostics: ##   For each parameter, n_eff is the effective sample size and R_k_hat is the potential ##   scale reduction factor on split chains (at convergence, R_k_hat = 1). ##  ## # A tibble: 60 × 15 ##    cell_group        parameter factor c_lower c_effect c_upper c_rhat c_ess_bulk ##    <chr>             <chr>     <chr>    <dbl>    <dbl>   <dbl>  <dbl>      <dbl> ##  1 B immature        (Interce… <NA>    0.523     0.819   1.13   1.00      3685.  ##  2 B immature        typeheal… type    1.01      1.38    1.71   1.00      1873.  ##  3 B mem             (Interce… <NA>   -1.07     -0.663  -0.270  1.00       206.  ##  4 B mem             typeheal… type    1.16      1.58    2.02   1.00       195.  ##  5 CD4 cm S100A4     (Interce… <NA>    1.45      1.70    1.96   1.000     1206.  ##  6 CD4 cm S100A4     typeheal… type    0.590     0.896   1.19   1.00       285.  ##  7 CD4 cm high cyto… (Interce… <NA>   -0.993    -0.605  -0.212  1.00       592.  ##  8 CD4 cm high cyto… typeheal… type   -1.90     -1.21   -0.553  1.00        62.8 ##  9 CD4 cm ribosome   (Interce… <NA>   -0.0706    0.303   0.676  1.00      3661.  ## 10 CD4 cm ribosome   typeheal… type   -1.34     -0.925  -0.496  1.00       891.  ## # ℹ 50 more rows ## # ℹ 7 more variables: c_ess_tail <dbl>, v_lower <dbl>, v_effect <dbl>, ## #   v_upper <dbl>, v_rhat <dbl>, v_ess_bulk <dbl>, v_ess_tail <dbl> plots = res |> sccomp_test() |> plot() ## Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... ##  ## Chain 1 finished in 0.0 seconds. plots$credible_intervals_1D plots$credible_intervals_2D"},{"path":[]},{"path":"https://mangiolalaboratory.github.io/sccomp/index.html","id":"for-single-cell-rna-sequencing","dir":"","previous_headings":"","what":"For Single-Cell RNA Sequencing","title":"Differential Composition and Variability Analysis for Single-Cell Data","text":"recommend setting bimodal_mean_variability_association  = TRUE. bimodality mean-variability association can confirmed plots$credible_intervals_2D (see ).","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/index.html","id":"for-cytof-and-microbiome-data","dir":"","previous_headings":"","what":"For CyTOF and Microbiome Data","title":"Differential Composition and Variability Analysis for Single-Cell Data","text":"recommend setting bimodal_mean_variability_association  = FALSE (Default).","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/index.html","id":"mcmc-chain-visualization","dir":"","previous_headings":"","what":"MCMC Chain Visualization","title":"Differential Composition and Variability Analysis for Single-Cell Data","text":"possible directly evaluate posterior distribution. example, plot Monte Carlo chain slope parameter first cell type. can see converged negative probability 1.","code":"library(cmdstanr) library(posterior) library(bayesplot)  # Assuming res contains the fit object from cmdstanr fit <- res |> attr(\"fit\")  # Extract draws for 'beta[2,1]' draws <- as_draws_array(fit$draws(\"beta[2,1]\"))  # Create a traceplot for 'beta[2,1]' mcmc_trace(draws, pars = \"beta[2,1]\") + theme_bw() sessionInfo() ## R version 4.5.0 (2025-04-11) ## Platform: x86_64-apple-darwin20 ## Running under: macOS Sonoma 14.6.1 ##  ## Matrix products: default ## BLAS:   /Library/Frameworks/R.framework/Versions/4.5-x86_64/Resources/lib/libRblas.0.dylib  ## LAPACK: /Library/Frameworks/R.framework/Versions/4.5-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: Australia/Adelaide ## tzcode source: internal ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ##  [1] bayesplot_1.12.0   posterior_1.6.1    cmdstanr_0.9.0     loo_2.8.0          ##  [5] tidyr_1.3.1        forcats_1.0.0      ggplot2_3.5.2.9001 sccomp_2.1.16      ##  [9] instantiate_0.2.3  dplyr_1.1.4        ##  ## loaded via a namespace (and not attached): ##  [1] tidyselect_1.2.1            farver_2.1.2                ##  [3] S7_0.2.0                    fastmap_1.2.0               ##  [5] SingleCellExperiment_1.30.1 tensorA_0.36.2.1            ##  [7] dotCall64_1.2               digest_0.6.37               ##  [9] lifecycle_1.0.4             SeuratObject_5.1.0          ## [11] processx_3.8.6              magrittr_2.0.3              ## [13] compiler_4.5.0              rlang_1.1.6                 ## [15] tools_4.5.0                 utf8_1.2.6                  ## [17] yaml_2.3.10                 data.table_1.17.8           ## [19] knitr_1.50                  S4Arrays_1.8.1              ## [21] labeling_0.4.3              sp_2.2-0                    ## [23] DelayedArray_0.34.1         plyr_1.8.9                  ## [25] RColorBrewer_1.1-3          abind_1.4-8                 ## [27] withr_3.0.2                 purrr_1.1.0                 ## [29] BiocGenerics_0.54.0         grid_4.5.0                  ## [31] stats4_4.5.0                future_1.58.0               ## [33] progressr_0.15.1            globals_0.18.0              ## [35] scales_1.4.0                SummarizedExperiment_1.38.1 ## [37] cli_3.6.5                   rmarkdown_2.29              ## [39] crayon_1.5.3                generics_0.1.4              ## [41] future.apply_1.20.0         rstudioapi_0.17.1           ## [43] reshape2_1.4.4              httr_1.4.7                  ## [45] tzdb_0.5.0                  stringr_1.5.1               ## [47] parallel_4.5.0              XVector_0.48.0              ## [49] matrixStats_1.5.0           vctrs_0.6.5                 ## [51] Matrix_1.7-3                jsonlite_2.0.0              ## [53] callr_3.7.6                 IRanges_2.42.0              ## [55] hms_1.1.3                   patchwork_1.3.1             ## [57] S4Vectors_0.46.0            ggrepel_0.9.6               ## [59] listenv_0.9.1               spam_2.11-1                 ## [61] glue_1.8.0                  parallelly_1.45.0           ## [63] codetools_0.2-20            ps_1.9.1                    ## [65] distributional_0.5.0        stringi_1.8.7               ## [67] gtable_0.3.6                GenomeInfoDb_1.44.0         ## [69] GenomicRanges_1.60.0        UCSC.utils_1.4.0            ## [71] tibble_3.3.0                pillar_1.11.0               ## [73] htmltools_0.5.8.1           GenomeInfoDbData_1.2.14     ## [75] R6_2.6.1                    rprojroot_2.1.0             ## [77] evaluate_1.0.4              lattice_0.22-7              ## [79] Biobase_2.68.0              readr_2.1.5                 ## [81] backports_1.5.0             Rcpp_1.1.0                  ## [83] SparseArray_1.8.0           checkmate_2.3.2             ## [85] xfun_0.52                   fs_1.6.6                    ## [87] MatrixGenerics_1.20.0       pkgconfig_2.0.3"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/clear_stan_model_cache.html","id":null,"dir":"Reference","previous_headings":"","what":"Clear Stan Model Cache — clear_stan_model_cache","title":"Clear Stan Model Cache — clear_stan_model_cache","text":"function removes Stan model cache directory contents. cache used cmdstanr store compiled Stan models. Clearing cache can useful : experiencing issues cached models want force recompilation models switching different versions Stan","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/clear_stan_model_cache.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Clear Stan Model Cache — clear_stan_model_cache","text":"","code":"clear_stan_model_cache(cache_dir = sccomp_stan_models_cache_dir)"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/clear_stan_model_cache.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Clear Stan Model Cache — clear_stan_model_cache","text":"cache_dir character string representing path cache directory delete. Defaults sccomp_stan_models_cache_dir, default cache location used sccomp.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/clear_stan_model_cache.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Clear Stan Model Cache — clear_stan_model_cache","text":"NULL invisibly. function called side effect removing cache directory.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/clear_stan_model_cache.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Clear Stan Model Cache — clear_stan_model_cache","text":"function uses unlink() recursive = TRUE remove directory contents. cache directory exist, function simply print message continue. safe operation cmdstanr recreate cache directory needed.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/clear_stan_model_cache.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Clear Stan Model Cache — clear_stan_model_cache","text":"S. Mangiola, .J. Roth-Schulze, M. Trussart, E. Zozaya-Valdés, M. Ma, Z. Gao, .F. Rubin, T.P. Speed, H. Shim, & .T. Papenfuss, sccomp: Robust differential composition variability analysis single-cell data, Proc. Natl. Acad. Sci. U.S.. 120 (33) e2203828120, https://doi.org/10.1073/pnas.2203828120 (2023).","code":""},{"path":[]},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/clear_stan_model_cache.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Clear Stan Model Cache — clear_stan_model_cache","text":"","code":"# Clear the default sccomp cache directory clear_stan_model_cache() #> Cache does not exist: /home/runner/.sccomp_models  # Clear a specific cache directory clear_stan_model_cache(\"path/to/custom/cache\") #> Cache does not exist: path/to/custom/cache  # Example of when you might want to clear the cache if (FALSE) { # \\dontrun{ # If you're experiencing issues with model compilation clear_stan_model_cache() # Then try running your model again } # }"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/counts_obj.html","id":null,"dir":"Reference","previous_headings":"","what":"counts_obj — counts_obj","title":"counts_obj — counts_obj","text":"tidy example dataset containing cell counts per cell group (cluster), sample, phenotype differential analysis. dataset represents counts cells various phenotypes cell groups across multiple samples.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/counts_obj.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"counts_obj — counts_obj","text":"","code":"data(counts_obj)"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/counts_obj.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"counts_obj — counts_obj","text":"tidy data frame following columns: sample: Factor, representing sample identifier. type: Factor, indicating sample type (e.g., benign, cancerous). phenotype: Factor, representing cell phenotype (e.g., B_cell, HSC, etc.). count: Integer, representing number cells cell group within sample. cell_group: Factor, representing cell group (e.g., BM, B1, Dm, etc.).","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/counts_obj.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"counts_obj — counts_obj","text":"tibble representing cell counts per cluster, columns sample, type, phenotype, cell group, counts.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/handle_missing_values.html","id":null,"dir":"Reference","previous_headings":"","what":"Handle missing values in a data frame — handle_missing_values","title":"Handle missing values in a data frame — handle_missing_values","text":"Handle missing values data frame","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/handle_missing_values.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Handle missing values in a data frame — handle_missing_values","text":"","code":"handle_missing_values(data)"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/handle_missing_values.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Handle missing values in a data frame — handle_missing_values","text":"data data frame process","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/handle_missing_values.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Handle missing values in a data frame — handle_missing_values","text":"data frame missing values handled: categorical variables (factor/character): NA values converted factor level \"NA\" numeric variables: NA values replaced mean column","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/no_significance_df.html","id":null,"dir":"Reference","previous_headings":"","what":"no_significance_df — no_significance_df","title":"no_significance_df — no_significance_df","text":"small example dataset containing cell counts across samples, conditions, cell groups. dataset used demonstrate use sccomp functions scenarios significant difference cell composition conditions.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/no_significance_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"no_significance_df — no_significance_df","text":"","code":"data(no_significance_df)"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/no_significance_df.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"no_significance_df — no_significance_df","text":"tibble following columns: sample: Character. Identifier sample. condition: Character. Experimental condition group (e.g., \"X\" \"Y\"). cell_group: Character. Cell group cell type (e.g., \"\", \"B\"). count: Numeric. Count cells given sample, condition, cell group.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/no_significance_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"no_significance_df — no_significance_df","text":"tibble 34 rows 4 columns: sample, condition, cell_group, count.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/no_significance_df.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"no_significance_df — no_significance_df","text":"","code":"data(no_significance_df) head(no_significance_df) #> # A tibble: 6 × 4 #>   sample condition cell_group count #>   <chr>  <chr>     <chr>      <dbl> #> 1 1      X         A            713 #> 2 12     X         A            556 #> 3 12     X         B             43 #> 4 16     X         A            164 #> 5 17     X         A            579 #> 6 17     X         B             21"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/plot.sccomp_tbl.html","id":null,"dir":"Reference","previous_headings":"","what":"plot — plot.sccomp_tbl","title":"plot — plot.sccomp_tbl","text":"function plots summary results model.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/plot.sccomp_tbl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot — plot.sccomp_tbl","text":"","code":"# S3 method for class 'sccomp_tbl' plot(   x,   significance_threshold = 0.05,   test_composition_above_logit_fold_change = attr(.data,     \"test_composition_above_logit_fold_change\"),   significance_statistic = c(\"FDR\", \"pH0\"),   show_fdr_message = TRUE,   ... )"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/plot.sccomp_tbl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot — plot.sccomp_tbl","text":"x tibble including cell_group name column | sample name column | read counts column | factor columns | Pvalue column | significance column significance_threshold Numeric value specifying significance threshold highlighting differences. Default 0.025. test_composition_above_logit_fold_change positive integer. effect threshold used hypothesis test. value 0.2 correspond change cell proportion 10% cell type baseline proportion 50%. , cell type goes 45% 50%. baseline proportion closer 0 1 effect thrshold consistent value logit uncontrained scale. significance_statistic Character vector indicating statistic highlight. Default \"FDR\". show_fdr_message Logical. Whether show Bayesian FDR interpretation message plot. Default TRUE. ... internal use","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/plot.sccomp_tbl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plot — plot.sccomp_tbl","text":"ggplot","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/plot.sccomp_tbl.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"plot — plot.sccomp_tbl","text":"S. Mangiola, .J. Roth-Schulze, M. Trussart, E. Zozaya-Valdés, M. Ma, Z. Gao, .F. Rubin, T.P. Speed, H. Shim, & .T. Papenfuss, sccomp: Robust differential composition variability analysis single-cell data, Proc. Natl. Acad. Sci. U.S.. 120 (33) e2203828120, https://doi.org/10.1073/pnas.2203828120 (2023).","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/plot.sccomp_tbl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"plot — plot.sccomp_tbl","text":"","code":"print(\"cmdstanr is needed to run this example.\") #> [1] \"cmdstanr is needed to run this example.\" # Note: Before running the example, ensure that the 'cmdstanr' package is installed: # install.packages(\"cmdstanr\", repos = c(\"https://stan-dev.r-universe.dev/\", getOption(\"repos\")))  # \\donttest{   if (instantiate::stan_cmdstan_exists()) {     data(\"counts_obj\")      estimate = sccomp_estimate(       counts_obj,       ~ type, ~1, \"sample\", \"cell_group\", \"count\",       cores = 1     )      # estimate |> plot()   } #> sccomp says: count column is an integer. The sum-constrained beta binomial model will be used #> sccomp says: estimation #> sccomp says: the composition design matrix has columns: (Intercept), typecancer #> sccomp says: the variability design matrix has columns: (Intercept) #> Precompiled model not found. Compiling the model... #> Running make /tmp/RtmpFf0i1u/model-3ca024f58da9 \"STAN_THREADS=TRUE\" \\ #>   \"STANCFLAGS += --include-paths=/tmp/RtmpFf0i1u/temp_libpath3ca03c17963f/sccomp/stan --name='glm_multi_beta_binomial_model'\" #>  #> --- Translating Stan model to C++ code --- #> bin/stanc --include-paths=/tmp/RtmpFf0i1u/temp_libpath3ca03c17963f/sccomp/stan --name='glm_multi_beta_binomial_model' --o=/tmp/RtmpFf0i1u/model-3ca024f58da9.hpp /tmp/RtmpFf0i1u/model-3ca024f58da9.stan #>  #> --- Compiling C++ code --- #> g++ -Wno-deprecated-declarations -std=c++17 -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes -Wno-class-memaccess     -DSTAN_THREADS -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.87.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS          -c -Wno-ignored-attributes   -x c++ -o /tmp/RtmpFf0i1u/model-3ca024f58da9.o /tmp/RtmpFf0i1u/model-3ca024f58da9.hpp #>  #> --- Linking model --- #> g++ -Wno-deprecated-declarations -std=c++17 -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes -Wno-class-memaccess     -DSTAN_THREADS -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.87.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS               -Wl,-L,\"/home/runner/.cmdstan/cmdstan-2.37.0/stan/lib/stan_math/lib/tbb\"   -Wl,-rpath,\"/home/runner/.cmdstan/cmdstan-2.37.0/stan/lib/stan_math/lib/tbb\"      /tmp/RtmpFf0i1u/model-3ca024f58da9.o src/cmdstan/main_threads.o       -ltbb   stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_nvecserial.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_cvodes.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_idas.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_kinsol.a  stan/lib/stan_math/lib/tbb/libtbb.so.2 -o /tmp/RtmpFf0i1u/model-3ca024f58da9 #> rm /tmp/RtmpFf0i1u/model-3ca024f58da9.hpp /tmp/RtmpFf0i1u/model-3ca024f58da9.o #> Model compiled and saved to cache successfully. #> Path [1] :Initial log joint density = -481862.988576  #> Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.531e-02   2.088e-01    1.000e+00  1.000e+00      3593 -3.701e+03 -3.700e+03                    #> Path [1] :Best Iter: [59] ELBO (-3700.231028) evaluations: (3593)  #> Path [2] :Initial log joint density = -482290.585323  #> Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      4.589e-03   2.126e-01    1.000e+00  1.000e+00      3072 -3.708e+03 -3.713e+03                    #> Path [2] :Best Iter: [48] ELBO (-3707.987035) evaluations: (3072)  #> Path [3] :Initial log joint density = -481684.913644  #> Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              51      -4.788e+05      5.032e-03   2.097e-01    9.523e-01  9.523e-01      2798 -3.705e+03 -3.717e+03                    #> Path [3] :Best Iter: [48] ELBO (-3705.289391) evaluations: (2798)  #> Path [4] :Initial log joint density = -481700.614186  #> Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      1.037e-02   2.289e-01    1.000e+00  1.000e+00      3293 -3.702e+03 -3.709e+03                    #> Path [4] :Best Iter: [56] ELBO (-3701.509975) evaluations: (3293)  #> Path [5] :Initial log joint density = -481696.455772  #> Path [5] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      9.517e-03   1.964e-01    1.000e+00  1.000e+00      3245 -3.702e+03 -3.698e+03                    #> Path [5] :Best Iter: [57] ELBO (-3697.824691) evaluations: (3245)  #> Path [6] :Initial log joint density = -481317.790661  #> Path [6] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      1.652e-02   3.997e-01    1.000e+00  1.000e+00      3082 -3.706e+03 -3.717e+03                    #> Path [6] :Best Iter: [43] ELBO (-3706.376535) evaluations: (3082)  #> Path [7] :Initial log joint density = -481456.506182  #> Path [7] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      1.445e-02   3.905e-01    1.000e+00  1.000e+00      3149 -3.698e+03 -3.704e+03                    #> Path [7] :Best Iter: [55] ELBO (-3698.257585) evaluations: (3149)  #> Path [8] :Initial log joint density = -481503.105373  #> Path [8] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      1.569e-02   3.697e-01    1.000e+00  1.000e+00      3136 -3.700e+03 -3.708e+03                    #> Path [8] :Best Iter: [56] ELBO (-3699.858984) evaluations: (3136)  #> Path [9] :Initial log joint density = -481319.923982  #> Path [9] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      1.860e-02   4.522e-01    1.000e+00  1.000e+00      3177 -3.708e+03 -3.706e+03                    #> Path [9] :Best Iter: [55] ELBO (-3705.645267) evaluations: (3177)  #> Path [10] :Initial log joint density = -481742.182993  #> Path [10] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      6.243e-03   1.800e-01    1.000e+00  1.000e+00      3080 -3.704e+03 -3.716e+03                    #> Path [10] :Best Iter: [42] ELBO (-3703.921100) evaluations: (3080)  #> Path [11] :Initial log joint density = -483411.221409  #> Path [11] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      8.616e-03   2.562e-01    1.000e+00  1.000e+00      3344 -3.706e+03 -3.710e+03                    #> Path [11] :Best Iter: [45] ELBO (-3705.960071) evaluations: (3344)  #> Path [12] :Initial log joint density = -481627.486259  #> Path [12] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      5.817e-03   2.465e-01    8.348e-01  8.348e-01      3382 -3.702e+03 -3.715e+03                    #> Path [12] :Best Iter: [57] ELBO (-3701.983691) evaluations: (3382)  #> Path [13] :Initial log joint density = -482097.177815  #> Path [13] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      1.426e-02   2.661e-01    1.000e+00  1.000e+00      3480 -3.698e+03 -3.699e+03                    #> Path [13] :Best Iter: [59] ELBO (-3697.720469) evaluations: (3480)  #> Path [14] :Initial log joint density = -482761.842072  #> Path [14] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      1.270e-02   3.223e-01    1.000e+00  1.000e+00      3503 -3.701e+03 -3.706e+03                    #> Path [14] :Best Iter: [59] ELBO (-3700.502409) evaluations: (3503)  #> Path [15] :Initial log joint density = -481410.820999  #> Path [15] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      6.646e-03   2.095e-01    4.505e-01  1.000e+00      2906 -3.709e+03 -3.720e+03                    #> Path [15] :Best Iter: [47] ELBO (-3708.806655) evaluations: (2906)  #> Path [16] :Initial log joint density = -483251.937308  #> Path [16] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      5.046e-03   2.137e-01    8.471e-01  8.471e-01      3544 -3.704e+03 -3.708e+03                    #> Path [16] :Best Iter: [58] ELBO (-3703.780707) evaluations: (3544)  #> Path [17] :Initial log joint density = -482259.803342  #> Path [17] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      6.613e-03   2.576e-01    1.000e+00  1.000e+00      2995 -3.709e+03 -3.718e+03                    #> Path [17] :Best Iter: [47] ELBO (-3709.439874) evaluations: (2995)  #> Path [18] :Initial log joint density = -482480.541580  #> Path [18] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      9.615e-03   2.669e-01    1.000e+00  1.000e+00      3373 -3.701e+03 -3.711e+03                    #> Path [18] :Best Iter: [56] ELBO (-3701.263421) evaluations: (3373)  #> Path [19] :Initial log joint density = -481757.440327  #> Path [19] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      9.705e-03   2.535e-01    1.000e+00  1.000e+00      3357 -3.701e+03 -3.700e+03                    #> Path [19] :Best Iter: [59] ELBO (-3700.260288) evaluations: (3357)  #> Path [20] :Initial log joint density = -481673.755792  #> Path [20] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      1.370e-02   3.480e-01    1.000e+00  1.000e+00      3495 -3.700e+03 -3.702e+03                    #> Path [20] :Best Iter: [55] ELBO (-3700.221937) evaluations: (3495)  #> Path [21] :Initial log joint density = -482673.895844  #> Path [21] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      8.760e-03   1.553e-01    7.828e-01  7.828e-01      3162 -3.702e+03 -3.710e+03                    #> Path [21] :Best Iter: [55] ELBO (-3701.737683) evaluations: (3162)  #> Path [22] :Initial log joint density = -481798.629188  #> Path [22] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      5.909e-03   2.428e-01    7.363e-01  7.363e-01      3130 -3.708e+03 -3.723e+03                    #> Path [22] :Best Iter: [40] ELBO (-3707.584316) evaluations: (3130)  #> Path [23] :Initial log joint density = -481768.942323  #> Path [23] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      6.012e-03   2.389e-01    9.176e-01  9.176e-01      2914 -3.706e+03 -3.714e+03                    #> Path [23] :Best Iter: [39] ELBO (-3705.554292) evaluations: (2914)  #> Path [24] :Initial log joint density = -481611.961978  #> Path [24] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      1.520e-02   3.540e-01    1.000e+00  1.000e+00      3179 -3.708e+03 -3.716e+03                    #> Path [24] :Best Iter: [34] ELBO (-3708.214485) evaluations: (3179)  #> Path [25] :Initial log joint density = -483188.315722  #> Path [25] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      1.651e-02   2.759e-01    1.000e+00  1.000e+00      3555 -3.699e+03 -3.703e+03                    #> Path [25] :Best Iter: [59] ELBO (-3698.767478) evaluations: (3555)  #> Path [26] :Initial log joint density = -482594.925406  #> Path [26] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      7.085e-03   1.665e-01    1.000e+00  1.000e+00      3271 -3.706e+03 -3.701e+03                    #> Path [26] :Best Iter: [57] ELBO (-3700.573582) evaluations: (3271)  #> Path [27] :Initial log joint density = -481746.267152  #> Path [27] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      6.546e-03   2.785e-01    9.161e-01  9.161e-01      3017 -3.710e+03 -3.711e+03                    #> Path [27] :Best Iter: [40] ELBO (-3710.097717) evaluations: (3017)  #> Path [28] :Initial log joint density = -482838.234823  #> Path [28] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.023e-02   2.678e-01    1.000e+00  1.000e+00      3428 -3.703e+03 -3.703e+03                    #> Path [28] :Best Iter: [59] ELBO (-3703.398838) evaluations: (3428)  #> Path [29] :Initial log joint density = -485360.105071  #> Path [29] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      8.472e-03   2.295e-01    1.000e+00  1.000e+00      3223 -3.708e+03 -3.705e+03                    #> Path [29] :Best Iter: [55] ELBO (-3705.013329) evaluations: (3223)  #> Path [30] :Initial log joint density = -481451.816285  #> Path [30] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      9.781e-03   1.466e-01    1.000e+00  1.000e+00      2918 -3.707e+03 -3.710e+03                    #> Path [30] :Best Iter: [52] ELBO (-3706.920935) evaluations: (2918)  #> Path [31] :Initial log joint density = -481904.295606  #> Path [31] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      1.087e-02   2.142e-01    1.000e+00  1.000e+00      3317 -3.704e+03 -3.709e+03                    #> Path [31] :Best Iter: [55] ELBO (-3704.421405) evaluations: (3317)  #> Path [32] :Initial log joint density = -481764.569795  #> Path [32] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      2.846e-03   2.455e-01    5.932e-01  5.932e-01      3445 -3.702e+03 -3.713e+03                    #> Path [32] :Best Iter: [58] ELBO (-3701.737994) evaluations: (3445)  #> Path [33] :Initial log joint density = -481864.539955  #> Path [33] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              50      -4.788e+05      1.209e-02   3.722e-01    1.000e+00  1.000e+00      2632 -3.708e+03 -3.723e+03                    #> Path [33] :Best Iter: [47] ELBO (-3707.904145) evaluations: (2632)  #> Path [34] :Initial log joint density = -481760.691268  #> Path [34] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      1.542e-02   2.821e-01    1.000e+00  1.000e+00      3161 -3.702e+03 -3.708e+03                    #> Path [34] :Best Iter: [55] ELBO (-3702.218239) evaluations: (3161)  #> Path [35] :Initial log joint density = -481218.809659  #> Path [35] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      1.471e-02   2.909e-01    1.000e+00  1.000e+00      3106 -3.707e+03 -3.702e+03                    #> Path [35] :Best Iter: [56] ELBO (-3702.162515) evaluations: (3106)  #> Path [36] :Initial log joint density = -481595.662328  #> Path [36] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      8.296e-03   2.326e-01    1.000e+00  1.000e+00      2937 -3.709e+03 -3.716e+03                    #> Path [36] :Best Iter: [51] ELBO (-3708.867823) evaluations: (2937)  #> Path [37] :Initial log joint density = -481671.595051  #> Path [37] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      3.304e-03   2.103e-01    8.298e-01  8.298e-01      3391 -3.702e+03 -3.714e+03                    #> Path [37] :Best Iter: [58] ELBO (-3701.524678) evaluations: (3391)  #> Path [38] :Initial log joint density = -481589.764069  #> Path [38] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      9.696e-03   2.576e-01    1.000e+00  1.000e+00      3053 -3.701e+03 -3.700e+03                    #> Path [38] :Best Iter: [56] ELBO (-3700.451759) evaluations: (3053)  #> Path [39] :Initial log joint density = -481836.297725  #> Path [39] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      1.167e-02   4.165e-01    9.490e-01  9.490e-01      3576 -3.700e+03 -3.710e+03                    #> Path [39] :Best Iter: [58] ELBO (-3700.066422) evaluations: (3576)  #> Path [40] :Initial log joint density = -481544.800496  #> Path [40] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      8.980e-03   2.153e-01    1.000e+00  1.000e+00      2909 -3.708e+03 -3.712e+03                    #> Path [40] :Best Iter: [49] ELBO (-3708.077640) evaluations: (2909)  #> Path [41] :Initial log joint density = -481585.005091  #> Path [41] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      3.188e-03   2.584e-01    6.529e-01  6.529e-01      3449 -3.700e+03 -3.712e+03                    #> Path [41] :Best Iter: [57] ELBO (-3700.151413) evaluations: (3449)  #> Path [42] :Initial log joint density = -481936.638697  #> Path [42] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      1.143e-02   2.201e-01    9.419e-01  9.419e-01      3313 -3.701e+03 -3.712e+03                    #> Path [42] :Best Iter: [56] ELBO (-3700.910754) evaluations: (3313)  #> Path [43] :Initial log joint density = -481642.464190  #> Path [43] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      1.181e-02   2.687e-01    7.419e-01  7.419e-01      3318 -3.703e+03 -3.712e+03                    #> Path [43] :Best Iter: [56] ELBO (-3703.238736) evaluations: (3318)  #> Path [44] :Initial log joint density = -481785.839566  #> Path [44] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      1.603e-02   1.972e-01    1.000e+00  1.000e+00      2915 -3.706e+03 -3.712e+03                    #> Path [44] :Best Iter: [52] ELBO (-3705.757674) evaluations: (2915)  #> Path [45] :Initial log joint density = -481993.445979  #> Path [45] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      2.383e-03   2.872e-01    5.858e-01  5.858e-01      3084 -3.707e+03 -3.721e+03                    #> Path [45] :Best Iter: [46] ELBO (-3707.224495) evaluations: (3084)  #> Path [46] :Initial log joint density = -481915.419186  #> Path [46] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      3.342e-03   2.768e-01    6.118e-01  6.118e-01      3356 -3.701e+03 -3.716e+03                    #> Path [46] :Best Iter: [57] ELBO (-3701.083257) evaluations: (3356)  #> Path [47] :Initial log joint density = -481764.274299  #> Path [47] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      3.836e-03   3.522e-01    6.411e-01  6.411e-01      3257 -3.709e+03 -3.716e+03                    #> Path [47] :Best Iter: [55] ELBO (-3708.791195) evaluations: (3257)  #> Path [48] :Initial log joint density = -481797.449839  #> Path [48] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              62      -4.788e+05      8.975e-03   1.846e-01    1.000e+00  1.000e+00      3847 -3.701e+03 -3.706e+03                    #> Path [48] :Best Iter: [58] ELBO (-3701.167893) evaluations: (3847)  #> Path [49] :Initial log joint density = -481668.280115  #> Path [49] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      1.037e-02   1.832e-01    1.000e+00  1.000e+00      3045 -3.709e+03 -3.711e+03                    #> Path [49] :Best Iter: [40] ELBO (-3708.607085) evaluations: (3045)  #> Path [50] :Initial log joint density = -482256.963741  #> Path [50] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      7.239e-03   2.154e-01    1.000e+00  1.000e+00      3156 -3.704e+03 -3.704e+03                    #> Path [50] :Best Iter: [56] ELBO (-3704.449832) evaluations: (3156)  #> Finished in  13.4 seconds. #> sccomp says: to do hypothesis testing run `sccomp_test()`, #>   the `test_composition_above_logit_fold_change` = 0.1 equates to a change of ~10%, and #>   0.7 equates to ~100% increase, if the baseline is ~0.1 proportion. #>   Use `sccomp_proportional_fold_change` to convert c_effect (linear) to proportion difference (non-linear). # }"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/plot_1D_intervals.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot 1D Intervals for Cell-group Effects — plot_1D_intervals","title":"Plot 1D Intervals for Cell-group Effects — plot_1D_intervals","text":"function creates series 1D interval plots cell-group effects, highlighting significant differences based given significance threshold.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/plot_1D_intervals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot 1D Intervals for Cell-group Effects — plot_1D_intervals","text":"","code":"plot_1D_intervals(   .data,   significance_threshold = 0.05,   test_composition_above_logit_fold_change = attr(.data,     \"test_composition_above_logit_fold_change\"),   show_fdr_message = TRUE,   significance_statistic = c(\"FDR\", \"pH0\") )"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/plot_1D_intervals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot 1D Intervals for Cell-group Effects — plot_1D_intervals","text":".data Data frame containing main data. significance_threshold Numeric value specifying significance threshold highlighting differences. test_composition_above_logit_fold_change positive integer. effect threshold used hypothesis test. value 0.2 correspond change cell proportion 10% cell type baseline proportion 50%. , cell type goes 45% 50%. baseline proportion closer 0 1 effect thrshold consistent value logit uncontrained scale. show_fdr_message Logical. Whether show Bayesian FDR interpretation message plot. Default TRUE. significance_statistic Character vector indicating statistic highlight. Default \"FDR\".","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/plot_1D_intervals.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot 1D Intervals for Cell-group Effects — plot_1D_intervals","text":"combined plot 1D interval plots.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/plot_1D_intervals.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot 1D Intervals for Cell-group Effects — plot_1D_intervals","text":"","code":"print(\"cmdstanr is needed to run this example.\") #> [1] \"cmdstanr is needed to run this example.\"  # \\donttest{   if (instantiate::stan_cmdstan_exists()) {     data(\"counts_obj\")      estimate <- sccomp_estimate(       counts_obj,       ~ type,       ~1,       \"sample\",       \"cell_group\",       \"count\",       cores = 1     ) |>      sccomp_test()        # Example usage:   my_plot = plot_1D_intervals(estimate)        } #> sccomp says: count column is an integer. The sum-constrained beta binomial model will be used #> sccomp says: estimation #> sccomp says: the composition design matrix has columns: (Intercept), typecancer #> sccomp says: the variability design matrix has columns: (Intercept) #> Loading model from cache... #> Path [1] :Initial log joint density = -481538.497909  #> Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      4.106e-03   2.266e-01    7.183e-01  7.183e-01      3327 -3.703e+03 -3.710e+03                    #> Path [1] :Best Iter: [56] ELBO (-3702.618174) evaluations: (3327)  #> Path [2] :Initial log joint density = -481504.392291  #> Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      1.444e-02   2.581e-01    1.000e+00  1.000e+00      3109 -3.699e+03 -3.704e+03                    #> Path [2] :Best Iter: [55] ELBO (-3699.193124) evaluations: (3109)  #> Path [3] :Initial log joint density = -481738.716172  #> Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      6.197e-03   2.091e-01    1.000e+00  1.000e+00      3468 -3.702e+03 -3.709e+03                    #> Path [3] :Best Iter: [56] ELBO (-3701.780969) evaluations: (3468)  #> Path [4] :Initial log joint density = -482361.778686  #> Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      9.678e-03   2.996e-01    4.063e-01  1.000e+00      3278 -3.703e+03 -3.715e+03                    #> Path [4] :Best Iter: [57] ELBO (-3703.456210) evaluations: (3278)  #> Path [5] :Initial log joint density = -481531.249410  #> Path [5] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              51      -4.788e+05      5.101e-03   2.158e-01    1.000e+00  1.000e+00      2704 -3.709e+03 -3.721e+03                    #> Path [5] :Best Iter: [33] ELBO (-3709.381746) evaluations: (2704)  #> Path [6] :Initial log joint density = -481617.549582  #> Path [6] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      6.831e-03   1.862e-01    5.122e-01  1.000e+00      3173 -3.711e+03 -3.720e+03                    #> Path [6] :Best Iter: [42] ELBO (-3711.108676) evaluations: (3173)  #> Path [7] :Initial log joint density = -481680.537667  #> Path [7] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      3.166e-03   2.164e-01    6.981e-01  6.981e-01      2863 -3.705e+03 -3.724e+03                    #> Path [7] :Best Iter: [51] ELBO (-3705.333508) evaluations: (2863)  #> Path [8] :Initial log joint density = -481630.409563  #> Path [8] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      8.447e-03   2.286e-01    1.000e+00  1.000e+00      2874 -3.709e+03 -3.716e+03                    #> Path [8] :Best Iter: [48] ELBO (-3708.532817) evaluations: (2874)  #> Path [9] :Initial log joint density = -483534.184390  #> Path [9] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      2.068e-02   2.853e-01    1.000e+00  1.000e+00      3611 -3.697e+03 -3.701e+03                    #> Path [9] :Best Iter: [60] ELBO (-3697.356292) evaluations: (3611)  #> Path [10] :Initial log joint density = -481534.546050  #> Path [10] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.248e-02   2.686e-01    1.000e+00  1.000e+00      3422 -3.698e+03 -3.703e+03                    #> Path [10] :Best Iter: [57] ELBO (-3698.076720) evaluations: (3422)  #> Path [11] :Initial log joint density = -481339.610799  #> Path [11] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      1.546e-02   2.247e-01    1.000e+00  1.000e+00      3520 -3.697e+03 -3.702e+03                    #> Path [11] :Best Iter: [59] ELBO (-3696.676688) evaluations: (3520)  #> Path [12] :Initial log joint density = -481520.886449  #> Path [12] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      8.162e-03   2.647e-01    1.000e+00  1.000e+00      2876 -3.709e+03 -3.706e+03                    #> Path [12] :Best Iter: [52] ELBO (-3705.760576) evaluations: (2876)  #> Path [13] :Initial log joint density = -483046.868786  #> Path [13] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      8.828e-03   2.188e-01    1.000e+00  1.000e+00      3649 -3.699e+03 -3.700e+03                    #> Path [13] :Best Iter: [57] ELBO (-3699.041194) evaluations: (3649)  #> Path [14] :Initial log joint density = -481719.817104  #> Path [14] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      1.586e-02   2.673e-01    1.000e+00  1.000e+00      3136 -3.698e+03 -3.703e+03                    #> Path [14] :Best Iter: [55] ELBO (-3697.662174) evaluations: (3136)  #> Path [15] :Initial log joint density = -481443.459531  #> Path [15] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      1.066e-02   3.599e-01    1.000e+00  1.000e+00      3026 -3.708e+03 -3.708e+03                    #> Path [15] :Best Iter: [55] ELBO (-3707.703186) evaluations: (3026)  #> Path [16] :Initial log joint density = -481707.040474  #> Path [16] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      1.233e-02   3.941e-01    1.000e+00  1.000e+00      2944 -3.705e+03 -3.715e+03                    #> Path [16] :Best Iter: [50] ELBO (-3704.913616) evaluations: (2944)  #> Path [17] :Initial log joint density = -481912.411725  #> Path [17] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      7.903e-03   2.280e-01    1.000e+00  1.000e+00      2975 -3.706e+03 -3.707e+03                    #> Path [17] :Best Iter: [50] ELBO (-3705.880134) evaluations: (2975)  #> Path [18] :Initial log joint density = -481648.510742  #> Path [18] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      4.572e-03   1.971e-01    8.187e-01  8.187e-01      3485 -3.703e+03 -3.716e+03                    #> Path [18] :Best Iter: [55] ELBO (-3703.195035) evaluations: (3485)  #> Path [19] :Initial log joint density = -481575.899175  #> Path [19] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      1.144e-02   2.817e-01    5.228e-01  1.000e+00      3136 -3.708e+03 -3.709e+03                    #> Path [19] :Best Iter: [49] ELBO (-3707.995278) evaluations: (3136)  #> Path [20] :Initial log joint density = -488440.609809  #> Path [20] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      1.361e-02   2.405e-01    1.000e+00  1.000e+00      3238 -3.705e+03 -3.702e+03                    #> Path [20] :Best Iter: [55] ELBO (-3701.824604) evaluations: (3238)  #> Path [21] :Initial log joint density = -481760.379316  #> Path [21] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      1.117e-02   2.482e-01    1.000e+00  1.000e+00      3220 -3.698e+03 -3.701e+03                    #> Path [21] :Best Iter: [57] ELBO (-3698.464849) evaluations: (3220)  #> Path [22] :Initial log joint density = -481779.188557  #> Path [22] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      8.964e-03   2.349e-01    1.000e+00  1.000e+00      3136 -3.707e+03 -3.711e+03                    #> Path [22] :Best Iter: [44] ELBO (-3706.525131) evaluations: (3136)  #> Path [23] :Initial log joint density = -481562.467890  #> Path [23] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      1.381e-02   1.951e-01    1.000e+00  1.000e+00      3324 -3.697e+03 -3.696e+03                    #> Path [23] :Best Iter: [58] ELBO (-3696.037430) evaluations: (3324)  #> Path [24] :Initial log joint density = -481529.147109  #> Path [24] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      6.666e-03   2.034e-01    1.000e+00  1.000e+00      3133 -3.704e+03 -3.704e+03                    #> Path [24] :Best Iter: [56] ELBO (-3703.936553) evaluations: (3133)  #> Path [25] :Initial log joint density = -481519.113375  #> Path [25] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      6.784e-03   2.309e-01    7.739e-01  7.739e-01      3087 -3.708e+03 -3.721e+03                    #> Path [25] :Best Iter: [47] ELBO (-3707.692217) evaluations: (3087)  #> Path [26] :Initial log joint density = -481599.545941  #> Path [26] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      6.470e-03   2.133e-01    1.000e+00  1.000e+00      3099 -3.705e+03 -3.712e+03                    #> Path [26] :Best Iter: [42] ELBO (-3704.923755) evaluations: (3099)  #> Path [27] :Initial log joint density = -481596.328389  #> Path [27] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      5.916e-03   2.491e-01    7.395e-01  7.395e-01      3177 -3.704e+03 -3.718e+03                    #> Path [27] :Best Iter: [55] ELBO (-3704.495205) evaluations: (3177)  #> Path [28] :Initial log joint density = -485278.241539  #> Path [28] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              62      -4.788e+05      6.226e-03   1.879e-01    9.938e-01  9.938e-01      3689 -3.697e+03 -3.708e+03                    #> Path [28] :Best Iter: [60] ELBO (-3696.562339) evaluations: (3689)  #> Path [29] :Initial log joint density = -481222.312707  #> Path [29] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      1.074e-02   2.057e-01    1.000e+00  1.000e+00      2863 -3.708e+03 -3.710e+03                    #> Path [29] :Best Iter: [50] ELBO (-3708.409093) evaluations: (2863)  #> Path [30] :Initial log joint density = -484894.370585  #> Path [30] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      5.801e-03   2.586e-01    1.000e+00  1.000e+00      3399 -3.703e+03 -3.700e+03                    #> Path [30] :Best Iter: [59] ELBO (-3699.544693) evaluations: (3399)  #> Path [31] :Initial log joint density = -481558.560173  #> Path [31] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      4.732e-03   2.025e-01    1.000e+00  1.000e+00      2831 -3.707e+03 -3.713e+03                    #> Path [31] :Best Iter: [48] ELBO (-3706.722480) evaluations: (2831)  #> Path [32] :Initial log joint density = -481406.383872  #> Path [32] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      6.086e-03   2.194e-01    1.000e+00  1.000e+00      3040 -3.708e+03 -3.713e+03                    #> Path [32] :Best Iter: [45] ELBO (-3707.803001) evaluations: (3040)  #> Path [33] :Initial log joint density = -481808.754665  #> Path [33] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      1.496e-02   3.043e-01    1.000e+00  1.000e+00      3276 -3.703e+03 -3.703e+03                    #> Path [33] :Best Iter: [56] ELBO (-3702.526089) evaluations: (3276)  #> Path [34] :Initial log joint density = -481703.963497  #> Path [34] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      2.327e-03   1.973e-01    7.020e-01  7.020e-01      3305 -3.702e+03 -3.714e+03                    #> Path [34] :Best Iter: [57] ELBO (-3701.742085) evaluations: (3305)  #> Path [35] :Initial log joint density = -481634.139029  #> Path [35] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      1.008e-02   2.906e-01    1.000e+00  1.000e+00      3570 -3.705e+03 -3.704e+03                    #> Path [35] :Best Iter: [58] ELBO (-3704.425235) evaluations: (3570)  #> Path [36] :Initial log joint density = -481564.583756  #> Path [36] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      1.437e-02   3.077e-01    1.000e+00  1.000e+00      3072 -3.702e+03 -3.703e+03                    #> Path [36] :Best Iter: [54] ELBO (-3701.742071) evaluations: (3072)  #> Path [37] :Initial log joint density = -481852.902124  #> Path [37] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      3.245e-03   2.977e-01    5.592e-01  5.592e-01      3078 -3.710e+03 -3.713e+03                    #> Path [37] :Best Iter: [52] ELBO (-3709.697079) evaluations: (3078)  #> Path [38] :Initial log joint density = -481492.447858  #> Path [38] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              51      -4.788e+05      4.268e-03   2.171e-01    9.343e-01  9.343e-01      2790 -3.708e+03 -3.718e+03                    #> Path [38] :Best Iter: [47] ELBO (-3707.583497) evaluations: (2790)  #> Path [39] :Initial log joint density = -481917.567362  #> Path [39] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      9.317e-03   2.286e-01    1.000e+00  1.000e+00      3328 -3.699e+03 -3.704e+03                    #> Path [39] :Best Iter: [55] ELBO (-3699.193197) evaluations: (3328)  #> Path [40] :Initial log joint density = -482553.963470  #> Path [40] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      8.003e-03   2.276e-01    4.433e-01  1.000e+00      3341 -3.697e+03 -3.710e+03                    #> Path [40] :Best Iter: [56] ELBO (-3696.533466) evaluations: (3341)  #> Path [41] :Initial log joint density = -482489.595121  #> Path [41] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      1.041e-02   3.228e-01    1.000e+00  1.000e+00      3304 -3.700e+03 -3.708e+03                    #> Path [41] :Best Iter: [56] ELBO (-3700.185166) evaluations: (3304)  #> Path [42] :Initial log joint density = -481763.763155  #> Path [42] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      9.933e-03   2.419e-01    1.000e+00  1.000e+00      2991 -3.707e+03 -3.708e+03                    #> Path [42] :Best Iter: [47] ELBO (-3706.675045) evaluations: (2991)  #> Path [43] :Initial log joint density = -482063.277097  #> Path [43] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      5.944e-03   2.105e-01    8.308e-01  8.308e-01      3412 -3.697e+03 -3.710e+03                    #> Path [43] :Best Iter: [57] ELBO (-3697.117810) evaluations: (3412)  #> Path [44] :Initial log joint density = -481451.534993  #> Path [44] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      1.365e-02   3.555e-01    1.000e+00  1.000e+00      2827 -3.705e+03 -3.717e+03                    #> Path [44] :Best Iter: [47] ELBO (-3705.129501) evaluations: (2827)  #> Path [45] :Initial log joint density = -481656.916258  #> Path [45] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      2.921e-03   1.619e-01    7.108e-01  7.108e-01      3485 -3.698e+03 -3.714e+03                    #> Path [45] :Best Iter: [58] ELBO (-3698.015919) evaluations: (3485)  #> Path [46] :Initial log joint density = -482455.480268  #> Path [46] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      9.557e-03   3.567e-01    5.109e-01  1.000e+00      3417 -3.702e+03 -3.711e+03                    #> Path [46] :Best Iter: [58] ELBO (-3701.880309) evaluations: (3417)  #> Path [47] :Initial log joint density = -481688.401390  #> Path [47] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      6.087e-03   1.733e-01    1.000e+00  1.000e+00      2991 -3.707e+03 -3.714e+03                    #> Path [47] :Best Iter: [41] ELBO (-3707.342228) evaluations: (2991)  #> Path [48] :Initial log joint density = -481710.207369  #> Path [48] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      4.594e-03   2.194e-01    9.536e-01  9.536e-01      2825 -3.710e+03 -3.719e+03                    #> Path [48] :Best Iter: [39] ELBO (-3710.199231) evaluations: (2825)  #> Path [49] :Initial log joint density = -481513.204411  #> Path [49] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      9.122e-03   2.399e-01    8.344e-01  8.344e-01      3653 -3.698e+03 -3.707e+03                    #> Path [49] :Best Iter: [55] ELBO (-3698.180400) evaluations: (3653)  #> Path [50] :Initial log joint density = -481940.265448  #> Path [50] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      1.061e-02   1.965e-01    1.000e+00  1.000e+00      3219 -3.702e+03 -3.703e+03                    #> Path [50] :Best Iter: [56] ELBO (-3701.575758) evaluations: (3219)  #> Finished in  13.4 seconds. #> sccomp says: to do hypothesis testing run `sccomp_test()`, #>   the `test_composition_above_logit_fold_change` = 0.1 equates to a change of ~10%, and #>   0.7 equates to ~100% increase, if the baseline is ~0.1 proportion. #>   Use `sccomp_proportional_fold_change` to convert c_effect (linear) to proportion difference (non-linear). # }"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/plot_2D_intervals.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot 2D Intervals for Mean-Variance Association — plot_2D_intervals","title":"Plot 2D Intervals for Mean-Variance Association — plot_2D_intervals","text":"function creates 2D interval plot mean-variance association, highlighting significant differences based given significance threshold.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/plot_2D_intervals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot 2D Intervals for Mean-Variance Association — plot_2D_intervals","text":"","code":"plot_2D_intervals(   .data,   significance_threshold = 0.05,   test_composition_above_logit_fold_change = attr(.data,     \"test_composition_above_logit_fold_change\"),   show_fdr_message = TRUE,   significance_statistic = c(\"FDR\", \"pH0\") )"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/plot_2D_intervals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot 2D Intervals for Mean-Variance Association — plot_2D_intervals","text":".data Data frame containing main data. significance_threshold Numeric value specifying significance threshold highlighting differences. Default 0.025. test_composition_above_logit_fold_change positive integer. effect threshold used hypothesis test. value 0.2 correspond change cell proportion 10% cell type baseline proportion 50%. , cell type goes 45% 50%. baseline proportion closer 0 1 effect thrshold consistent value logit uncontrained scale. show_fdr_message Logical. Whether show Bayesian FDR interpretation message plot. Default TRUE. significance_statistic Character vector indicating statistic highlight. Default \"FDR\".","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/plot_2D_intervals.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot 2D Intervals for Mean-Variance Association — plot_2D_intervals","text":"ggplot object representing 2D interval plot.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/plot_2D_intervals.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot 2D Intervals for Mean-Variance Association — plot_2D_intervals","text":"","code":"print(\"cmdstanr is needed to run this example.\") #> [1] \"cmdstanr is needed to run this example.\"  # \\donttest{   if (instantiate::stan_cmdstan_exists()) {     data(\"counts_obj\")      estimate <- sccomp_estimate(       counts_obj,       ~ type,       ~type,       \"sample\",       \"cell_group\",       \"count\",       cores = 1     ) |>      sccomp_test()        # Example usage:   my_plot = plot_2D_intervals(estimate)        } #> sccomp says: count column is an integer. The sum-constrained beta binomial model will be used #> sccomp says: estimation #> sccomp says: the composition design matrix has columns: (Intercept), typecancer #> sccomp says: the variability design matrix has columns: (Intercept), typecancer #> Loading model from cache... #> Path [1] :Initial log joint density = -481597.479556  #> Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      5.132e-02   5.749e+03    1.575e-02  1.575e-02      8435 -3.787e+03 -5.960e+05                    #> Path [1] :Best Iter: [37] ELBO (-3786.811524) evaluations: (8435)  #> Path [2] :Initial log joint density = -482946.252425  #> Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      6.395e-02   6.545e+03    1.531e-02  1.531e-02      8207 -3.799e+03 -2.266e+06                    #> Path [2] :Best Iter: [38] ELBO (-3799.252101) evaluations: (8207)  #> Path [3] :Initial log joint density = -483899.219127  #> Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.786e+05      1.158e-01   5.257e+03    2.818e-02  2.818e-02      8322 -3.792e+03 -1.912e+11                    #> Path [3] :Best Iter: [45] ELBO (-3791.835480) evaluations: (8322)  #> Path [4] :Initial log joint density = -482593.869009  #> Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      8.617e-02   2.054e+03    2.425e-02  2.425e-02      8156 -3.785e+03 -8.857e+05                    #> Path [4] :Best Iter: [40] ELBO (-3785.117901) evaluations: (8156)  #> Path [5] :Initial log joint density = -481655.705826  #> Path [5] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      1.282e-02   1.112e+03    2.317e-02  2.317e-02      8081 -3.771e+03 -9.088e+03                    #> Path [5] :Best Iter: [41] ELBO (-3770.830500) evaluations: (8081)  #> Path [6] :Initial log joint density = -481553.763429  #> Path [6] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      7.083e-02   1.987e+03    2.706e-02  2.706e-02      8276 -3.776e+03 -1.170e+04                    #> Path [6] :Best Iter: [45] ELBO (-3775.832706) evaluations: (8276)  #> Path [7] :Initial log joint density = -481417.084915  #> Path [7] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.786e+05      2.930e-02   2.243e+04    7.729e-03  7.729e-03      8335 -3.810e+03 -6.521e+04                    #> Path [7] :Best Iter: [36] ELBO (-3810.032070) evaluations: (8335)  #> Path [8] :Initial log joint density = -481684.603159  #> Path [8] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.786e+05      7.051e-02   9.150e+03    9.812e-03  9.812e-03      8247 -3.803e+03 -6.060e+11                    #> Path [8] :Best Iter: [38] ELBO (-3802.759701) evaluations: (8247)  #> Path [9] :Initial log joint density = -488330.727436  #> Path [9] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      4.710e-02   1.240e+03    2.844e-02  2.844e-02      8214 -3.771e+03 -9.012e+03                    #> Path [9] :Best Iter: [51] ELBO (-3771.317827) evaluations: (8214)  #> Path [10] :Initial log joint density = -481868.537444  #> Path [10] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      4.464e-02   3.402e+02    6.458e-02  6.458e-02      8050 -3.764e+03 -4.420e+03                    #> Path [10] :Best Iter: [51] ELBO (-3763.545131) evaluations: (8050)  #> Path [11] :Initial log joint density = -481883.239560  #> Path [11] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.786e+05      1.240e-02   6.046e+03    2.258e-02  2.258e-02      8168 -3.796e+03 -2.427e+04                    #> Path [11] :Best Iter: [42] ELBO (-3795.967872) evaluations: (8168)  #> Path [12] :Initial log joint density = -481865.584664  #> Path [12] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      7.268e-02   5.477e+03    2.916e-02  2.916e-02      8550 -3.784e+03 -2.823e+05                    #> Path [12] :Best Iter: [46] ELBO (-3784.078547) evaluations: (8550)  #> Path [13] :Initial log joint density = -481709.849506  #> Path [13] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      1.308e+00   1.008e+02    1.675e-01  1.675e-01      7865 -3.732e+03 -4.563e+03                    #> Path [13] :Best Iter: [78] ELBO (-3732.353027) evaluations: (7865)  #> Path [14] :Initial log joint density = -485549.132760  #> Path [14] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      1.679e-01   1.970e+03    5.214e-02  5.214e-02      8050 -3.775e+03 -4.307e+05                    #> Path [14] :Best Iter: [53] ELBO (-3774.830027) evaluations: (8050)  #> Path [15] :Initial log joint density = -481973.542059  #> Path [15] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.786e+05      1.535e-02   6.299e+03    2.438e-02  2.438e-02      8554 -3.817e+03 -7.157e+03                    #> Path [15] :Best Iter: [30] ELBO (-3817.047548) evaluations: (8554)  #> Path [16] :Initial log joint density = -482213.169603  #> Path [16] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              87      -4.787e+05      1.035e-02   1.662e-01    4.822e-01  1.000e+00      6235 -3.733e+03 -3.755e+03                    #> Path [16] :Best Iter: [76] ELBO (-3733.234305) evaluations: (6235)  #> Path [17] :Initial log joint density = -482057.782612  #> Path [17] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              84      -4.787e+05      6.862e-03   2.391e-01    6.575e-01  6.575e-01      5834 -3.734e+03 -3.755e+03                    #> Path [17] :Best Iter: [82] ELBO (-3733.677683) evaluations: (5834)  #> Path [18] :Initial log joint density = -481553.704194  #> Path [18] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.786e+05      9.546e-02   6.227e+03    2.784e-02  2.784e-02      8441 -3.795e+03 -1.135e+05                    #> Path [18] :Best Iter: [40] ELBO (-3794.829968) evaluations: (8441)  #> Path [19] :Initial log joint density = -481906.935406  #> Path [19] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.786e+05      6.629e-02   4.645e+03    2.511e-02  6.291e-02      8387 -3.796e+03 -2.440e+08                    #> Path [19] :Best Iter: [39] ELBO (-3796.474297) evaluations: (8387)  #> Path [20] :Initial log joint density = -481488.509206  #> Path [20] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.786e+05      4.293e-02   4.786e+03    8.934e-03  2.608e-02      8123 -3.797e+03 -3.137e+07                    #> Path [20] :Best Iter: [40] ELBO (-3797.209252) evaluations: (8123)  #> Path [21] :Initial log joint density = -481624.983410  #> Path [21] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      1.186e-01   1.967e+03    3.947e-02  3.947e-02      7905 -3.780e+03 -2.218e+04                    #> Path [21] :Best Iter: [41] ELBO (-3779.999510) evaluations: (7905)  #> Path [22] :Initial log joint density = -482032.303308  #> Path [22] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      4.074e-02   1.006e+03    1.297e-02  2.351e-02      8204 -3.767e+03 -6.404e+04                    #> Path [22] :Best Iter: [55] ELBO (-3767.222243) evaluations: (8204)  #> Path [23] :Initial log joint density = -481558.098722  #> Path [23] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.786e+05      8.492e-02   4.713e+03    2.266e-02  2.266e-02      8251 -3.808e+03 -8.369e+04                    #> Path [23] :Best Iter: [32] ELBO (-3807.984027) evaluations: (8251)  #> Path [24] :Initial log joint density = -482061.158968  #> Path [24] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      1.551e-01   1.207e+02    1.179e-01  2.657e-01      7992 -3.740e+03 -1.895e+04                    #> Path [24] :Best Iter: [77] ELBO (-3740.388748) evaluations: (7992)  #> Path [25] :Initial log joint density = -481721.246228  #> Path [25] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      8.763e-02   2.225e+03    3.240e-02  3.240e-02      8182 -3.769e+03 -2.435e+05                    #> Path [25] :Best Iter: [51] ELBO (-3768.995390) evaluations: (8182)  #> Path [26] :Initial log joint density = -482078.266274  #> Path [26] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              87      -4.787e+05      1.573e-02   1.915e-01    1.000e+00  1.000e+00      6170 -3.732e+03 -3.738e+03                    #> Path [26] :Best Iter: [86] ELBO (-3731.542720) evaluations: (6170)  #> Path [27] :Initial log joint density = -485063.451206  #> Path [27] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      1.253e-01   6.083e+02    4.971e-02  4.971e-02      8053 -3.772e+03 -3.703e+06                    #> Path [27] :Best Iter: [57] ELBO (-3771.915623) evaluations: (8053)  #> Path [28] :Initial log joint density = -482378.323345  #> Path [28] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      5.282e-01   1.420e+02    1.562e-01  1.562e-01      8073 -3.737e+03 -5.615e+03                    #> Path [28] :Best Iter: [76] ELBO (-3737.110287) evaluations: (8073)  #> Path [29] :Initial log joint density = -481355.569507  #> Path [29] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      5.208e-02   1.997e+03    2.441e-02  2.441e-02      8385 -3.779e+03 -6.926e+05                    #> Path [29] :Best Iter: [38] ELBO (-3779.244262) evaluations: (8385)  #> Path [30] :Initial log joint density = -481910.612965  #> Path [30] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      1.129e-01   2.641e+03    4.024e-02  4.024e-02      8200 -3.774e+03 -9.735e+04                    #> Path [30] :Best Iter: [43] ELBO (-3774.285315) evaluations: (8200)  #> Path [31] :Initial log joint density = -481735.284109  #> Path [31] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      4.772e-02   1.151e+03    2.034e-02  2.034e-02      8137 -3.762e+03 -3.825e+07                    #> Path [31] :Best Iter: [57] ELBO (-3762.484244) evaluations: (8137)  #> Path [32] :Initial log joint density = -481827.798675  #> Path [32] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              81      -4.787e+05      1.656e-02   2.102e-01    1.000e+00  1.000e+00      5428 -3.734e+03 -3.745e+03                    #> Path [32] :Best Iter: [78] ELBO (-3733.885196) evaluations: (5428)  #> Path [33] :Initial log joint density = -481784.738248  #> Path [33] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      7.070e-02   3.122e+03    2.022e-02  3.930e-02      8351 -3.809e+03 -4.146e+04                    #> Path [33] :Best Iter: [38] ELBO (-3808.859075) evaluations: (8351)  #> Path [34] :Initial log joint density = -481697.446474  #> Path [34] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.786e+05      6.917e-02   3.750e+03    1.384e-02  2.650e-02      8493 -3.804e+03 -5.760e+09                    #> Path [34] :Best Iter: [36] ELBO (-3803.743817) evaluations: (8493)  #> Path [35] :Initial log joint density = -481776.510109  #> Path [35] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      9.183e-02   2.710e+03    2.128e-02  6.484e-02      8237 -3.794e+03 -1.437e+05                    #> Path [35] :Best Iter: [36] ELBO (-3793.873661) evaluations: (8237)  #> Path [36] :Initial log joint density = -482011.186690  #> Path [36] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      8.327e-02   3.419e+03    2.188e-02  2.188e-02      8149 -3.778e+03 -2.501e+05                    #> Path [36] :Best Iter: [41] ELBO (-3778.071386) evaluations: (8149)  #> Path [37] :Initial log joint density = -481873.669336  #> Path [37] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.786e+05      5.981e-02   3.356e+03    1.559e-02  1.559e-02      8652 -3.790e+03 -2.709e+05                    #> Path [37] :Best Iter: [40] ELBO (-3790.032543) evaluations: (8652)  #> Path [38] :Initial log joint density = -481759.165078  #> Path [38] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.786e+05      9.865e-02   1.462e+04    4.303e-02  4.303e-02      8529 -3.812e+03 -4.165e+04                    #> Path [38] :Best Iter: [32] ELBO (-3811.587329) evaluations: (8529)  #> Path [39] :Initial log joint density = -481694.096055  #> Path [39] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      1.169e-01   1.862e+03    1.891e-02  3.407e-02      8360 -3.767e+03 -6.284e+05                    #> Path [39] :Best Iter: [56] ELBO (-3767.185397) evaluations: (8360)  #> Path [40] :Initial log joint density = -482693.319618  #> Path [40] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      1.072e-01   5.129e+02    4.791e-02  4.791e-02      8084 -3.762e+03 -5.019e+04                    #> Path [40] :Best Iter: [46] ELBO (-3761.734869) evaluations: (8084)  #> Path [41] :Initial log joint density = -482230.240788  #> Path [41] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              85      -4.787e+05      6.682e-03   1.687e-01    9.290e-01  9.290e-01      6094 -3.730e+03 -3.755e+03                    #> Path [41] :Best Iter: [79] ELBO (-3729.957099) evaluations: (6094)  #> Path [42] :Initial log joint density = -481619.358493  #> Path [42] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      1.578e-01   1.001e+03    4.799e-02  4.799e-02      8294 -3.758e+03 -4.054e+04                    #> Path [42] :Best Iter: [59] ELBO (-3758.317041) evaluations: (8294)  #> Path [43] :Initial log joint density = -481864.066810  #> Path [43] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.786e+05      8.639e-02   5.176e+03    2.502e-02  2.502e-02      8288 -3.811e+03 -2.912e+04                    #> Path [43] :Best Iter: [37] ELBO (-3811.168762) evaluations: (8288)  #> Path [44] :Initial log joint density = -481423.973525  #> Path [44] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      4.375e-02   2.603e+03    9.504e-03  9.504e-03      8263 -3.778e+03 -4.503e+10                    #> Path [44] :Best Iter: [45] ELBO (-3777.726776) evaluations: (8263)  #> Path [45] :Initial log joint density = -481987.071785  #> Path [45] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              89      -4.787e+05      7.410e-03   2.417e-01    1.000e+00  1.000e+00      6582 -3.733e+03 -3.747e+03                    #> Path [45] :Best Iter: [85] ELBO (-3732.978050) evaluations: (6582)  #> Path [46] :Initial log joint density = -482642.076068  #> Path [46] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      1.986e-01   6.530e+02    8.160e-02  8.160e-02      7968 -3.766e+03 -7.866e+04                    #> Path [46] :Best Iter: [59] ELBO (-3766.393718) evaluations: (7968)  #> Path [47] :Initial log joint density = -481565.382487  #> Path [47] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              83      -4.787e+05      8.047e-03   1.801e-01    7.973e-01  7.973e-01      5867 -3.732e+03 -3.759e+03                    #> Path [47] :Best Iter: [80] ELBO (-3732.392389) evaluations: (5867)  #> Path [48] :Initial log joint density = -483956.474593  #> Path [48] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.786e+05      9.448e-02   5.849e+03    3.183e-02  6.278e-02      8415 -3.799e+03 -6.484e+04                    #> Path [48] :Best Iter: [40] ELBO (-3798.507927) evaluations: (8415)  #> Path [49] :Initial log joint density = -481595.111520  #> Path [49] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.787e+05      2.566e-02   2.950e+03    2.219e-02  2.219e-02      8181 -3.779e+03 -5.741e+05                    #> Path [49] :Best Iter: [52] ELBO (-3779.159335) evaluations: (8181)  #> Path [50] :Initial log joint density = -481843.794082  #> Path [50] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.786e+05      7.295e-02   7.275e+03    1.967e-02  1.967e-02      8497 -3.823e+03 -6.512e+04                    #> Path [50] :Best Iter: [32] ELBO (-3822.691190) evaluations: (8497)  #> Finished in  25.9 seconds. #> sccomp says: to do hypothesis testing run `sccomp_test()`, #>   the `test_composition_above_logit_fold_change` = 0.1 equates to a change of ~10%, and #>   0.7 equates to ~100% increase, if the baseline is ~0.1 proportion. #>   Use `sccomp_proportional_fold_change` to convert c_effect (linear) to proportion difference (non-linear). # }"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/plot_scatterplot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Scatterplot of Cell-group Proportion — plot_scatterplot","title":"Plot Scatterplot of Cell-group Proportion — plot_scatterplot","text":"function creates scatterplot cell-group proportions, optionally highlighting significant differences based given significance threshold.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/plot_scatterplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Scatterplot of Cell-group Proportion — plot_scatterplot","text":"","code":"plot_scatterplot(   .data,   data_proportion,   factor_of_interest,   .cell_group,   .sample,   significance_threshold = 0.05,   my_theme )"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/plot_scatterplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Scatterplot of Cell-group Proportion — plot_scatterplot","text":".data Data frame containing main data. data_proportion Data frame containing proportions cell groups. factor_of_interest factor indicating biological condition interest. .cell_group cell group analysed. .sample sample identifier. significance_threshold Numeric value specifying significance threshold highlighting differences. Default 0.025. my_theme ggplot2 theme object applied plot.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/plot_scatterplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Scatterplot of Cell-group Proportion — plot_scatterplot","text":"ggplot object representing scatterplot.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/plot_scatterplot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Scatterplot of Cell-group Proportion — plot_scatterplot","text":"","code":"# Example usage: # plot_scatterplot(.data, data_proportion, \"condition\", \"cell_group\", \"sample\", 0.025, theme_minimal())"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/print.sccomp_tbl.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for sccomp objects — print.sccomp_tbl","title":"Print method for sccomp objects — print.sccomp_tbl","text":"Print method sccomp objects. print method sccomp objects provides summary model specifications, data dimensions, convergence diagnostics. output formatted easy read understand.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/print.sccomp_tbl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for sccomp objects — print.sccomp_tbl","text":"","code":"# S3 method for class 'sccomp_tbl' print(x, ...)"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/print.sccomp_tbl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for sccomp objects — print.sccomp_tbl","text":"x sccomp object ... Additional arguments passed print","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/print.sccomp_tbl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print method for sccomp objects — print.sccomp_tbl","text":"printed object","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/print.sccomp_tbl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print method for sccomp objects — print.sccomp_tbl","text":"","code":"# Note: Before running the example, ensure that the 'cmdstanr' package is installed: # install.packages(\"cmdstanr\", repos = c(\"https://stan-dev.r-universe.dev/\", getOption(\"repos\")))  # \\donttest{ if (instantiate::stan_cmdstan_exists()) {   # Create a sccomp object   data(\"counts_obj\")    estimate <- sccomp_estimate(     counts_obj,     ~ type,     ~1,     \"sample\",     \"cell_group\",     \"count\",     cores = 1   )   print(estimate) } #> sccomp says: count column is an integer. The sum-constrained beta binomial model will be used #> sccomp says: estimation #> sccomp says: the composition design matrix has columns: (Intercept), typecancer #> sccomp says: the variability design matrix has columns: (Intercept) #> Loading model from cache... #> Path [1] :Initial log joint density = -481519.132435  #> Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              62      -4.788e+05      2.963e-03   2.543e-01    6.736e-01  6.736e-01      3566 -3.701e+03 -3.714e+03                    #> Path [1] :Best Iter: [55] ELBO (-3700.551911) evaluations: (3566)  #> Path [2] :Initial log joint density = -482505.926561  #> Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.592e-02   2.819e-01    1.000e+00  1.000e+00      3411 -3.701e+03 -3.702e+03                    #> Path [2] :Best Iter: [57] ELBO (-3701.021956) evaluations: (3411)  #> Path [3] :Initial log joint density = -481539.444908  #> Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      3.040e-02   3.682e-01    1.000e+00  1.000e+00      3420 -3.697e+03 -3.701e+03                    #> Path [3] :Best Iter: [58] ELBO (-3696.555171) evaluations: (3420)  #> Path [4] :Initial log joint density = -481955.974928  #> Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      8.040e-03   3.419e-01    5.267e-01  1.000e+00      3160 -3.699e+03 -3.708e+03                    #> Path [4] :Best Iter: [55] ELBO (-3698.651697) evaluations: (3160)  #> Path [5] :Initial log joint density = -481813.510514  #> Path [5] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      1.285e-02   2.787e-01    1.000e+00  1.000e+00      3512 -3.700e+03 -3.704e+03                    #> Path [5] :Best Iter: [59] ELBO (-3699.544436) evaluations: (3512)  #> Path [6] :Initial log joint density = -481621.525693  #> Path [6] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              51      -4.788e+05      1.287e-02   3.510e-01    1.000e+00  1.000e+00      2794 -3.706e+03 -3.714e+03                    #> Path [6] :Best Iter: [50] ELBO (-3705.662382) evaluations: (2794)  #> Path [7] :Initial log joint density = -481594.090403  #> Path [7] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              62      -4.788e+05      2.338e-02   1.716e-01    1.000e+00  1.000e+00      3689 -3.703e+03 -3.700e+03                    #> Path [7] :Best Iter: [62] ELBO (-3699.564861) evaluations: (3689)  #> Path [8] :Initial log joint density = -482356.448871  #> Path [8] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      1.576e-02   4.088e-01    1.000e+00  1.000e+00      3302 -3.700e+03 -3.711e+03                    #> Path [8] :Best Iter: [55] ELBO (-3700.357055) evaluations: (3302)  #> Path [9] :Initial log joint density = -481982.345651  #> Path [9] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      1.055e-02   3.255e-01    9.356e-01  9.356e-01      2997 -3.710e+03 -3.718e+03                    #> Path [9] :Best Iter: [52] ELBO (-3710.413108) evaluations: (2997)  #> Path [10] :Initial log joint density = -481520.921594  #> Path [10] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      8.646e-03   1.893e-01    1.000e+00  1.000e+00      3506 -3.701e+03 -3.703e+03                    #> Path [10] :Best Iter: [58] ELBO (-3701.449643) evaluations: (3506)  #> Path [11] :Initial log joint density = -481541.580387  #> Path [11] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      6.021e-03   1.925e-01    7.618e-01  7.618e-01      3077 -3.707e+03 -3.712e+03                    #> Path [11] :Best Iter: [48] ELBO (-3707.475593) evaluations: (3077)  #> Path [12] :Initial log joint density = -481528.633352  #> Path [12] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      8.919e-03   2.616e-01    9.263e-01  9.263e-01      3248 -3.700e+03 -3.713e+03                    #> Path [12] :Best Iter: [55] ELBO (-3700.353286) evaluations: (3248)  #> Path [13] :Initial log joint density = -481560.234891  #> Path [13] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      6.512e-03   1.832e-01    9.357e-01  9.357e-01      3039 -3.708e+03 -3.723e+03                    #> Path [13] :Best Iter: [52] ELBO (-3708.086687) evaluations: (3039)  #> Path [14] :Initial log joint density = -481499.826279  #> Path [14] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      1.942e-02   3.370e-01    1.000e+00  1.000e+00      3300 -3.699e+03 -3.705e+03                    #> Path [14] :Best Iter: [56] ELBO (-3698.705898) evaluations: (3300)  #> Path [15] :Initial log joint density = -481377.436067  #> Path [15] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              63      -4.788e+05      1.131e-02   2.113e-01    1.000e+00  1.000e+00      3794 -3.702e+03 -3.705e+03                    #> Path [15] :Best Iter: [62] ELBO (-3702.407726) evaluations: (3794)  #> Path [16] :Initial log joint density = -481533.485779  #> Path [16] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      1.536e-02   3.338e-01    1.000e+00  1.000e+00      2950 -3.708e+03 -3.707e+03                    #> Path [16] :Best Iter: [53] ELBO (-3706.820636) evaluations: (2950)  #> Path [17] :Initial log joint density = -481680.716203  #> Path [17] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      9.163e-03   1.798e-01    1.000e+00  1.000e+00      3529 -3.700e+03 -3.702e+03                    #> Path [17] :Best Iter: [59] ELBO (-3700.228285) evaluations: (3529)  #> Path [18] :Initial log joint density = -481522.277112  #> Path [18] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      7.002e-03   2.176e-01    1.000e+00  1.000e+00      3154 -3.704e+03 -3.701e+03                    #> Path [18] :Best Iter: [56] ELBO (-3700.806459) evaluations: (3154)  #> Path [19] :Initial log joint density = -482960.472689  #> Path [19] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      7.050e-03   2.572e-01    1.000e+00  1.000e+00      3085 -3.709e+03 -3.721e+03                    #> Path [19] :Best Iter: [46] ELBO (-3708.699345) evaluations: (3085)  #> Path [20] :Initial log joint density = -481884.634542  #> Path [20] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.154e-02   2.570e-01    1.000e+00  1.000e+00      3356 -3.705e+03 -3.710e+03                    #> Path [20] :Best Iter: [57] ELBO (-3704.778768) evaluations: (3356)  #> Path [21] :Initial log joint density = -481762.022200  #> Path [21] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      7.395e-03   2.114e-01    1.000e+00  1.000e+00      2972 -3.708e+03 -3.715e+03                    #> Path [21] :Best Iter: [43] ELBO (-3708.056675) evaluations: (2972)  #> Path [22] :Initial log joint density = -481781.691048  #> Path [22] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      1.065e-02   1.943e-01    1.000e+00  1.000e+00      3163 -3.707e+03 -3.703e+03                    #> Path [22] :Best Iter: [56] ELBO (-3702.698073) evaluations: (3163)  #> Path [23] :Initial log joint density = -481600.717290  #> Path [23] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      4.222e-03   2.074e-01    7.778e-01  7.778e-01      3321 -3.701e+03 -3.713e+03                    #> Path [23] :Best Iter: [57] ELBO (-3701.281674) evaluations: (3321)  #> Path [24] :Initial log joint density = -481729.964525  #> Path [24] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              50      -4.788e+05      1.280e-02   3.900e-01    9.986e-01  9.986e-01      2713 -3.707e+03 -3.722e+03                    #> Path [24] :Best Iter: [49] ELBO (-3707.272483) evaluations: (2713)  #> Path [25] :Initial log joint density = -481738.427441  #> Path [25] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      1.138e-02   1.853e-01    1.000e+00  1.000e+00      3299 -3.704e+03 -3.702e+03                    #> Path [25] :Best Iter: [57] ELBO (-3701.761491) evaluations: (3299)  #> Path [26] :Initial log joint density = -481759.287770  #> Path [26] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      6.094e-03   2.148e-01    7.878e-01  7.878e-01      3555 -3.697e+03 -3.709e+03                    #> Path [26] :Best Iter: [59] ELBO (-3696.594408) evaluations: (3555)  #> Path [27] :Initial log joint density = -483429.718767  #> Path [27] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      1.017e-02   1.968e-01    1.000e+00  1.000e+00      3439 -3.703e+03 -3.700e+03                    #> Path [27] :Best Iter: [58] ELBO (-3699.716308) evaluations: (3439)  #> Path [28] :Initial log joint density = -481615.704268  #> Path [28] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.302e-02   2.694e-01    1.000e+00  1.000e+00      3305 -3.701e+03 -3.702e+03                    #> Path [28] :Best Iter: [58] ELBO (-3700.761654) evaluations: (3305)  #> Path [29] :Initial log joint density = -482146.180662  #> Path [29] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      4.583e-03   1.912e-01    4.776e-01  1.000e+00      3705 -3.701e+03 -3.712e+03                    #> Path [29] :Best Iter: [60] ELBO (-3700.565735) evaluations: (3705)  #> Path [30] :Initial log joint density = -481654.572753  #> Path [30] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      9.777e-03   2.060e-01    1.000e+00  1.000e+00      3305 -3.701e+03 -3.702e+03                    #> Path [30] :Best Iter: [55] ELBO (-3700.895979) evaluations: (3305)  #> Path [31] :Initial log joint density = -481933.407499  #> Path [31] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              63      -4.788e+05      1.319e-02   2.637e-01    1.000e+00  1.000e+00      3688 -3.699e+03 -3.700e+03                    #> Path [31] :Best Iter: [59] ELBO (-3699.036890) evaluations: (3688)  #> Path [32] :Initial log joint density = -481467.003508  #> Path [32] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      1.065e-02   2.485e-01    1.000e+00  1.000e+00      3076 -3.708e+03 -3.707e+03                    #> Path [32] :Best Iter: [54] ELBO (-3707.004209) evaluations: (3076)  #> Path [33] :Initial log joint density = -481621.916356  #> Path [33] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      1.223e-02   1.762e-01    1.000e+00  1.000e+00      3499 -3.698e+03 -3.697e+03                    #> Path [33] :Best Iter: [60] ELBO (-3697.185929) evaluations: (3499)  #> Path [34] :Initial log joint density = -482212.964546  #> Path [34] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.395e-02   3.045e-01    9.768e-01  9.768e-01      3363 -3.699e+03 -3.709e+03                    #> Path [34] :Best Iter: [57] ELBO (-3698.549092) evaluations: (3363)  #> Path [35] :Initial log joint density = -483129.929131  #> Path [35] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      4.541e-03   2.334e-01    6.694e-01  6.694e-01      3644 -3.697e+03 -3.714e+03                    #> Path [35] :Best Iter: [58] ELBO (-3696.890837) evaluations: (3644)  #> Path [36] :Initial log joint density = -481774.389743  #> Path [36] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      6.169e-03   2.509e-01    1.000e+00  1.000e+00      3262 -3.709e+03 -3.704e+03                    #> Path [36] :Best Iter: [55] ELBO (-3704.194206) evaluations: (3262)  #> Path [37] :Initial log joint density = -481379.886200  #> Path [37] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      1.755e-02   3.969e-01    9.917e-01  9.917e-01      3109 -3.701e+03 -3.709e+03                    #> Path [37] :Best Iter: [55] ELBO (-3700.763283) evaluations: (3109)  #> Path [38] :Initial log joint density = -483802.891988  #> Path [38] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      9.527e-03   2.239e-01    1.000e+00  1.000e+00      3381 -3.699e+03 -3.703e+03                    #> Path [38] :Best Iter: [57] ELBO (-3698.689275) evaluations: (3381)  #> Path [39] :Initial log joint density = -481601.015853  #> Path [39] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      1.779e-02   3.222e-01    1.000e+00  1.000e+00      3188 -3.712e+03 -3.705e+03                    #> Path [39] :Best Iter: [55] ELBO (-3705.046014) evaluations: (3188)  #> Path [40] :Initial log joint density = -481405.640036  #> Path [40] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      9.103e-03   2.326e-01    9.653e-01  9.653e-01      2783 -3.707e+03 -3.716e+03                    #> Path [40] :Best Iter: [51] ELBO (-3707.484713) evaluations: (2783)  #> Path [41] :Initial log joint density = -481629.384881  #> Path [41] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      1.884e-02   2.552e-01    9.168e-01  9.168e-01      2990 -3.708e+03 -3.719e+03                    #> Path [41] :Best Iter: [51] ELBO (-3707.782735) evaluations: (2990)  #> Path [42] :Initial log joint density = -481495.803019  #> Path [42] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              50      -4.788e+05      9.727e-03   1.689e-01    1.000e+00  1.000e+00      2673 -3.710e+03 -3.709e+03                    #> Path [42] :Best Iter: [50] ELBO (-3709.336967) evaluations: (2673)  #> Path [43] :Initial log joint density = -481683.905872  #> Path [43] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      5.874e-03   1.578e-01    8.247e-01  8.247e-01      3255 -3.705e+03 -3.712e+03                    #> Path [43] :Best Iter: [55] ELBO (-3705.012040) evaluations: (3255)  #> Path [44] :Initial log joint density = -481449.217773  #> Path [44] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      8.951e-03   2.225e-01    1.000e+00  1.000e+00      2877 -3.706e+03 -3.710e+03                    #> Path [44] :Best Iter: [49] ELBO (-3705.849003) evaluations: (2877)  #> Path [45] :Initial log joint density = -481740.578828  #> Path [45] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      2.586e-03   3.710e-01    5.638e-01  5.638e-01      3117 -3.709e+03 -3.718e+03                    #> Path [45] :Best Iter: [52] ELBO (-3708.593670) evaluations: (3117)  #> Path [46] :Initial log joint density = -481787.181334  #> Path [46] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      1.469e-02   3.082e-01    1.000e+00  1.000e+00      3312 -3.705e+03 -3.703e+03                    #> Path [46] :Best Iter: [58] ELBO (-3702.776413) evaluations: (3312)  #> Path [47] :Initial log joint density = -482721.260156  #> Path [47] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      8.677e-03   2.574e-01    1.000e+00  1.000e+00      3327 -3.700e+03 -3.702e+03                    #> Path [47] :Best Iter: [57] ELBO (-3699.840746) evaluations: (3327)  #> Path [48] :Initial log joint density = -482042.322279  #> Path [48] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              63      -4.788e+05      1.006e-02   3.246e-01    1.000e+00  1.000e+00      3796 -3.700e+03 -3.708e+03                    #> Path [48] :Best Iter: [59] ELBO (-3700.494030) evaluations: (3796)  #> Path [49] :Initial log joint density = -481977.261111  #> Path [49] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      1.203e-02   3.663e-01    1.000e+00  1.000e+00      3220 -3.700e+03 -3.708e+03                    #> Path [49] :Best Iter: [56] ELBO (-3700.226490) evaluations: (3220)  #> Path [50] :Initial log joint density = -481379.579678  #> Path [50] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      4.954e-03   1.247e-01    1.000e+00  1.000e+00      3016 -3.708e+03 -3.717e+03                    #> Path [50] :Best Iter: [41] ELBO (-3708.086923) evaluations: (3016)  #> Finished in  13.6 seconds. #> sccomp says: to do hypothesis testing run `sccomp_test()`, #>   the `test_composition_above_logit_fold_change` = 0.1 equates to a change of ~10%, and #>   0.7 equates to ~100% increase, if the baseline is ~0.1 proportion. #>   Use `sccomp_proportional_fold_change` to convert c_effect (linear) to proportion difference (non-linear). #> sccomp model #> ============ #>  #> Model specifications: #>   Family: multi_beta_binomial  #>   Composition formula: ~type  #>   Variability formula: ~1  #>   Inference method: pathfinder  #>  #> Data: Samples: 20   Cell groups: 36  #>  #> Column prefixes: c_ -> composition parameters  v_ -> variability parameters #>  #> Convergence diagnostics: #>   For each parameter, n_eff is the effective sample size and R_k_hat is the potential #>   scale reduction factor on split chains (at convergence, R_k_hat = 1). #>  #> # A tibble: 72 × 15 #>    cell_group parameter   factor c_lower c_effect c_upper c_rhat c_ess_bulk #>    <chr>      <chr>       <chr>    <dbl>    <dbl>   <dbl>  <dbl>      <dbl> #>  1 B1         (Intercept) NA      0.941     1.20   1.45    1.000      3545. #>  2 B1         typecancer  type   -0.925    -0.614 -0.310   1.00       3933. #>  3 B2         (Intercept) NA      0.506     0.768  1.02    1.000      3645. #>  4 B2         typecancer  type   -0.975    -0.672 -0.357   1.00       3866. #>  5 B3         (Intercept) NA     -0.580    -0.328 -0.0810  1.000      3957. #>  6 B3         typecancer  type   -0.590    -0.276  0.0330  1.00       4077. #>  7 BM         (Intercept) NA     -1.23     -0.964 -0.723   1.000      3867. #>  8 BM         typecancer  type   -0.581    -0.283  0.0153  1.00       4071. #>  9 CD4 1      (Intercept) NA      0.206     0.369  0.530   1.00       3789. #> 10 CD4 1      typecancer  type   -0.0113    0.205  0.422   1.00       3771. #> # ℹ 62 more rows #> # ℹ 7 more variables: c_ess_tail <dbl>, v_lower <dbl>, v_effect <dbl>, #> #   v_upper <dbl>, v_rhat <dbl>, v_ess_bulk <dbl>, v_ess_tail <dbl> # }"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp-package.html","id":null,"dir":"Reference","previous_headings":"","what":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data — sccomp-package","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data — sccomp-package","text":"Comprehensive R package differential composition variability analysis single-cell RNA sequencing, CyTOF, microbiome data. Provides robust Bayesian modeling outlier detection, random effects, advanced statistical methods cell type proportion analysis. Features include probabilistic outlier identification, mixed-effect modeling, differential variability testing, comprehensive visualization tools. Perfect cancer research, immunology, developmental biology, single-cell genomics applications. sccomp package provides comprehensive tools differential composition variability analysis single-cell RNA sequencing, CyTOF, microbiome data. implements robust Bayesian modeling outlier detection, random effects, advanced statistical methods cell type proportion analysis.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data — sccomp-package","text":"main functions : sccomp_estimate - Perform differential composition variability analysis sccomp_test - Test differential composition significance testing sccomp_remove_outliers - Identify remove outlier samples sccomp_predict - Predict cell type proportions new samples sccomp_remove_unwanted_variation - Remove unwanted variation data sccomp_proportional_fold_change - Calculate proportional fold changes Plotting functions: plot.sccomp_tbl, sccomp_boxplot, plot_1D_intervals, plot_2D_intervals detailed information usage, see package vignettes: browseVignettes(\"sccomp\") software-related questions posted GitHub Issues page: https://github.com/MangiolaLaboratory/sccomp/issues code can viewed GitHub repository: https://github.com/MangiolaLaboratory/sccomp","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data — sccomp-package","text":"Mangiola, S., Roth-Schulze, .J., Trussart, M., Zozaya-Valdés, E., Ma, M., Gao, Z., Rubin, .F., Speed, T.P., Shim, H., & Papenfuss, .T. (2023). sccomp: Robust differential composition variability analysis single-cell data. Proceedings National Academy Sciences, 120(33), e2203828120. doi:10.1073/pnas.2203828120","code":""},{"path":[]},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"sccomp: Differential Composition and Variability Analysis for Single-Cell Data — sccomp-package","text":"Maintainer: Stefano Mangiola stefano.mangiola@unimelb.edu.au Authors: Alexandra J. Roth-Schulze Marie Trussart Enrique Zozaya-Valdés Mengyao Ma Zijie Gao Alan F. Rubin Terence P. Speed Heejung Shim Anthony T. Papenfuss","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_boxplot.html","id":null,"dir":"Reference","previous_headings":"","what":"sccomp_boxplot — sccomp_boxplot","title":"sccomp_boxplot — sccomp_boxplot","text":"Creates boxplot visualization model results sccomp. function plots estimated cell proportions across samples, highlighting significant changes cell composition according specified factor.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_boxplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"sccomp_boxplot — sccomp_boxplot","text":"","code":"sccomp_boxplot(   .data,   factor,   significance_threshold = 0.05,   test_composition_above_logit_fold_change = attr(.data,     \"test_composition_above_logit_fold_change\"),   remove_unwanted_effects = FALSE )"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_boxplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"sccomp_boxplot — sccomp_boxplot","text":".data tibble containing results sccomp_estimate sccomp_test, including columns: cell_group name, sample name, read counts, factor(s), p-values, significance indicators. factor character string specifying factor interest included model stratifying boxplot. significance_threshold numeric value indicating False Discovery Rate (FDR) threshold labeling significant cell-groups. Defaults 0.05. test_composition_above_logit_fold_change positive numeric value representing effect size threshold used hypothesis test. value 0.2 corresponds change cell proportion approximately 10% cell type baseline proportion 50% (e.g., 45% 55%). threshold consistent logit-unconstrained scale, even baseline proportion close 0 1. remove_unwanted_effects logical value indicating whether remove unwanted variation data plotting. Defaults FALSE.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_boxplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"sccomp_boxplot — sccomp_boxplot","text":"ggplot object representing boxplot cell proportions across samples, stratified specified factor.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_boxplot.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"sccomp_boxplot — sccomp_boxplot","text":"S. Mangiola, .J. Roth-Schulze, M. Trussart, E. Zozaya-Valdés, M. Ma, Z. Gao, .F. Rubin, T.P. Speed, H. Shim, & .T. Papenfuss, sccomp: Robust differential composition variability analysis single-cell data, Proc. Natl. Acad. Sci. U.S.. 120 (33) e2203828120, https://doi.org/10.1073/pnas.2203828120 (2023).","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_boxplot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"sccomp_boxplot — sccomp_boxplot","text":"","code":"print(\"cmdstanr is needed to run this example.\") #> [1] \"cmdstanr is needed to run this example.\" # Note: Before running the example, ensure that the 'cmdstanr' package is installed: # install.packages(\"cmdstanr\", repos = c(\"https://stan-dev.r-universe.dev/\", getOption(\"repos\")))  # \\donttest{ if (instantiate::stan_cmdstan_exists()) {     data(\"counts_obj\")      estimate <- sccomp_estimate(       counts_obj,       formula_composition = ~ type,       formula_variability = ~ 1,       sample = \"sample\",       cell_group = \"cell_group\",       abundance = \"count\",       cores = 1     ) |>     sccomp_test()      # Plot the boxplot of estimated cell proportions     sccomp_boxplot(         .data = estimate,         factor = \"type\",         significance_threshold = 0.05     ) } #> sccomp says: count column is an integer. The sum-constrained beta binomial model will be used #> sccomp says: estimation #> sccomp says: the composition design matrix has columns: (Intercept), typecancer #> sccomp says: the variability design matrix has columns: (Intercept) #> Loading model from cache... #> Path [1] :Initial log joint density = -481593.112467  #> Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      1.465e-02   2.243e-01    1.000e+00  1.000e+00      3200 -3.705e+03 -3.701e+03                    #> Path [1] :Best Iter: [56] ELBO (-3701.143295) evaluations: (3200)  #> Path [2] :Initial log joint density = -481670.303020  #> Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      1.066e-02   2.504e-01    1.000e+00  1.000e+00      3003 -3.708e+03 -3.714e+03                    #> Path [2] :Best Iter: [52] ELBO (-3708.492344) evaluations: (3003)  #> Path [3] :Initial log joint density = -481906.701290  #> Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      8.589e-03   2.491e-01    9.703e-01  9.703e-01      3358 -3.699e+03 -3.709e+03                    #> Path [3] :Best Iter: [58] ELBO (-3698.720758) evaluations: (3358)  #> Path [4] :Initial log joint density = -483628.136188  #> Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      1.694e-02   2.179e-01    8.130e-01  8.130e-01      3295 -3.704e+03 -3.709e+03                    #> Path [4] :Best Iter: [55] ELBO (-3703.578633) evaluations: (3295)  #> Path [5] :Initial log joint density = -481448.077945  #> Path [5] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      9.229e-03   2.277e-01    1.000e+00  1.000e+00      2974 -3.706e+03 -3.712e+03                    #> Path [5] :Best Iter: [50] ELBO (-3705.777396) evaluations: (2974)  #> Path [6] :Initial log joint density = -483968.465769  #> Path [6] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      7.641e-03   1.796e-01    1.000e+00  1.000e+00      3314 -3.702e+03 -3.702e+03                    #> Path [6] :Best Iter: [56] ELBO (-3701.951071) evaluations: (3314)  #> Path [7] :Initial log joint density = -481463.522092  #> Path [7] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      8.534e-03   2.682e-01    5.009e-01  1.000e+00      3006 -3.708e+03 -3.723e+03                    #> Path [7] :Best Iter: [52] ELBO (-3707.530052) evaluations: (3006)  #> Path [8] :Initial log joint density = -482365.717290  #> Path [8] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      9.877e-03   3.387e-01    1.000e+00  1.000e+00      3158 -3.701e+03 -3.707e+03                    #> Path [8] :Best Iter: [55] ELBO (-3701.408340) evaluations: (3158)  #> Path [9] :Initial log joint density = -481907.441159  #> Path [9] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      1.358e-02   3.302e-01    1.000e+00  1.000e+00      3292 -3.700e+03 -3.707e+03                    #> Path [9] :Best Iter: [57] ELBO (-3700.059080) evaluations: (3292)  #> Path [10] :Initial log joint density = -486165.475784  #> Path [10] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      2.892e-03   2.744e-01    7.388e-01  7.388e-01      3670 -3.701e+03 -3.714e+03                    #> Path [10] :Best Iter: [57] ELBO (-3701.428605) evaluations: (3670)  #> Path [11] :Initial log joint density = -481197.242823  #> Path [11] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      1.198e-02   2.290e-01    1.000e+00  1.000e+00      2944 -3.709e+03 -3.714e+03                    #> Path [11] :Best Iter: [52] ELBO (-3708.798050) evaluations: (2944)  #> Path [12] :Initial log joint density = -481585.347409  #> Path [12] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      7.099e-03   3.002e-01    1.000e+00  1.000e+00      2942 -3.709e+03 -3.714e+03                    #> Path [12] :Best Iter: [45] ELBO (-3709.494961) evaluations: (2942)  #> Path [13] :Initial log joint density = -481890.098066  #> Path [13] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      9.194e-03   2.627e-01    1.000e+00  1.000e+00      3077 -3.710e+03 -3.709e+03                    #> Path [13] :Best Iter: [55] ELBO (-3708.547186) evaluations: (3077)  #> Path [14] :Initial log joint density = -481257.796932  #> Path [14] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              51      -4.788e+05      8.618e-03   2.533e-01    1.000e+00  1.000e+00      2704 -3.708e+03 -3.715e+03                    #> Path [14] :Best Iter: [39] ELBO (-3708.439284) evaluations: (2704)  #> Path [15] :Initial log joint density = -482389.274556  #> Path [15] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      4.977e-03   2.100e-01    1.000e+00  1.000e+00      3221 -3.708e+03 -3.704e+03                    #> Path [15] :Best Iter: [56] ELBO (-3703.626802) evaluations: (3221)  #> Path [16] :Initial log joint density = -481985.000640  #> Path [16] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              63      -4.788e+05      9.145e-03   2.217e-01    1.000e+00  1.000e+00      3780 -3.698e+03 -3.696e+03                    #> Path [16] :Best Iter: [63] ELBO (-3696.053100) evaluations: (3780)  #> Path [17] :Initial log joint density = -481623.707504  #> Path [17] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      8.937e-03   2.059e-01    1.000e+00  1.000e+00      3071 -3.705e+03 -3.702e+03                    #> Path [17] :Best Iter: [55] ELBO (-3702.416843) evaluations: (3071)  #> Path [18] :Initial log joint density = -481455.685424  #> Path [18] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      5.092e-03   1.802e-01    1.000e+00  1.000e+00      3220 -3.702e+03 -3.712e+03                    #> Path [18] :Best Iter: [55] ELBO (-3701.838765) evaluations: (3220)  #> Path [19] :Initial log joint density = -481598.081334  #> Path [19] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      7.002e-03   1.977e-01    8.730e-01  8.730e-01      3531 -3.699e+03 -3.714e+03                    #> Path [19] :Best Iter: [58] ELBO (-3699.021513) evaluations: (3531)  #> Path [20] :Initial log joint density = -481903.643716  #> Path [20] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      4.398e-03   2.093e-01    1.000e+00  1.000e+00      2910 -3.706e+03 -3.718e+03                    #> Path [20] :Best Iter: [50] ELBO (-3706.271558) evaluations: (2910)  #> Path [21] :Initial log joint density = -485552.325282  #> Path [21] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      2.524e-03   3.048e-01    5.485e-01  5.485e-01      3736 -3.702e+03 -3.716e+03                    #> Path [21] :Best Iter: [58] ELBO (-3701.903400) evaluations: (3736)  #> Path [22] :Initial log joint density = -481527.869240  #> Path [22] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      1.918e-02   3.045e-01    1.000e+00  1.000e+00      3139 -3.708e+03 -3.704e+03                    #> Path [22] :Best Iter: [55] ELBO (-3704.427105) evaluations: (3139)  #> Path [23] :Initial log joint density = -481635.521591  #> Path [23] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      1.209e-02   2.223e-01    1.000e+00  1.000e+00      2991 -3.709e+03 -3.714e+03                    #> Path [23] :Best Iter: [39] ELBO (-3709.192346) evaluations: (2991)  #> Path [24] :Initial log joint density = -482573.861711  #> Path [24] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      7.261e-03   2.054e-01    1.000e+00  1.000e+00      3469 -3.702e+03 -3.699e+03                    #> Path [24] :Best Iter: [59] ELBO (-3699.317596) evaluations: (3469)  #> Path [25] :Initial log joint density = -482006.705668  #> Path [25] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      7.967e-03   2.721e-01    1.000e+00  1.000e+00      2944 -3.710e+03 -3.714e+03                    #> Path [25] :Best Iter: [43] ELBO (-3709.880279) evaluations: (2944)  #> Path [26] :Initial log joint density = -481590.125799  #> Path [26] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      3.235e-03   2.608e-01    7.402e-01  7.402e-01      3091 -3.706e+03 -3.710e+03                    #> Path [26] :Best Iter: [55] ELBO (-3705.601867) evaluations: (3091)  #> Path [27] :Initial log joint density = -481607.346272  #> Path [27] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      2.779e-03   2.640e-01    6.674e-01  6.674e-01      3560 -3.699e+03 -3.708e+03                    #> Path [27] :Best Iter: [57] ELBO (-3698.833657) evaluations: (3560)  #> Path [28] :Initial log joint density = -481677.667914  #> Path [28] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      3.022e-03   2.915e-01    5.545e-01  5.545e-01      3055 -3.707e+03 -3.716e+03                    #> Path [28] :Best Iter: [48] ELBO (-3706.775708) evaluations: (3055)  #> Path [29] :Initial log joint density = -481616.858795  #> Path [29] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      9.414e-03   1.949e-01    1.000e+00  1.000e+00      3564 -3.699e+03 -3.702e+03                    #> Path [29] :Best Iter: [59] ELBO (-3699.050151) evaluations: (3564)  #> Path [30] :Initial log joint density = -483060.996259  #> Path [30] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      1.516e-02   4.132e-01    1.000e+00  1.000e+00      2826 -3.709e+03 -3.718e+03                    #> Path [30] :Best Iter: [45] ELBO (-3709.446301) evaluations: (2826)  #> Path [31] :Initial log joint density = -481844.453975  #> Path [31] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      6.356e-03   2.267e-01    1.000e+00  1.000e+00      3112 -3.709e+03 -3.703e+03                    #> Path [31] :Best Iter: [55] ELBO (-3702.922743) evaluations: (3112)  #> Path [32] :Initial log joint density = -481779.135142  #> Path [32] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      2.812e-03   3.364e-01    5.578e-01  5.578e-01      3395 -3.701e+03 -3.714e+03                    #> Path [32] :Best Iter: [55] ELBO (-3701.096905) evaluations: (3395)  #> Path [33] :Initial log joint density = -481640.221820  #> Path [33] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      4.221e-03   1.819e-01    8.432e-01  8.432e-01      3120 -3.708e+03 -3.712e+03                    #> Path [33] :Best Iter: [44] ELBO (-3707.755699) evaluations: (3120)  #> Path [34] :Initial log joint density = -481608.328902  #> Path [34] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      2.609e-03   2.662e-01    5.933e-01  5.933e-01      2863 -3.709e+03 -3.715e+03                    #> Path [34] :Best Iter: [45] ELBO (-3709.431751) evaluations: (2863)  #> Path [35] :Initial log joint density = -483249.245109  #> Path [35] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      6.684e-03   3.133e-01    4.663e-01  1.000e+00      3126 -3.708e+03 -3.710e+03                    #> Path [35] :Best Iter: [46] ELBO (-3708.243988) evaluations: (3126)  #> Path [36] :Initial log joint density = -481782.957723  #> Path [36] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      6.522e-03   2.869e-01    8.013e-01  8.013e-01      2923 -3.707e+03 -3.723e+03                    #> Path [36] :Best Iter: [50] ELBO (-3706.663945) evaluations: (2923)  #> Path [37] :Initial log joint density = -481727.747785  #> Path [37] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      5.778e-03   2.074e-01    1.000e+00  1.000e+00      3038 -3.709e+03 -3.710e+03                    #> Path [37] :Best Iter: [39] ELBO (-3709.230919) evaluations: (3038)  #> Path [38] :Initial log joint density = -482464.239842  #> Path [38] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      6.383e-03   2.782e-01    1.000e+00  1.000e+00      3254 -3.709e+03 -3.709e+03                    #> Path [38] :Best Iter: [56] ELBO (-3708.595914) evaluations: (3254)  #> Path [39] :Initial log joint density = -482847.566976  #> Path [39] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      8.248e-03   2.506e-01    9.068e-01  9.068e-01      3347 -3.701e+03 -3.711e+03                    #> Path [39] :Best Iter: [55] ELBO (-3700.917174) evaluations: (3347)  #> Path [40] :Initial log joint density = -481631.880975  #> Path [40] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      3.851e-03   3.144e-01    6.979e-01  6.979e-01      3147 -3.707e+03 -3.721e+03                    #> Path [40] :Best Iter: [42] ELBO (-3707.415878) evaluations: (3147)  #> Path [41] :Initial log joint density = -481576.006621  #> Path [41] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      1.849e-02   2.533e-01    1.000e+00  1.000e+00      3481 -3.697e+03 -3.703e+03                    #> Path [41] :Best Iter: [56] ELBO (-3696.595810) evaluations: (3481)  #> Path [42] :Initial log joint density = -482023.356144  #> Path [42] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      5.056e-03   2.242e-01    7.769e-01  7.769e-01      3317 -3.703e+03 -3.715e+03                    #> Path [42] :Best Iter: [56] ELBO (-3703.263518) evaluations: (3317)  #> Path [43] :Initial log joint density = -481463.915555  #> Path [43] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              50      -4.788e+05      5.839e-03   2.726e-01    8.595e-01  8.595e-01      2713 -3.706e+03 -3.718e+03                    #> Path [43] :Best Iter: [48] ELBO (-3706.174395) evaluations: (2713)  #> Path [44] :Initial log joint density = -481960.631122  #> Path [44] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      1.090e-02   2.546e-01    1.000e+00  1.000e+00      2908 -3.711e+03 -3.716e+03                    #> Path [44] :Best Iter: [43] ELBO (-3710.730087) evaluations: (2908)  #> Path [45] :Initial log joint density = -481641.132415  #> Path [45] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      1.993e-02   3.295e-01    4.621e-01  1.000e+00      3468 -3.699e+03 -3.705e+03                    #> Path [45] :Best Iter: [59] ELBO (-3698.804534) evaluations: (3468)  #> Path [46] :Initial log joint density = -481747.665598  #> Path [46] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      9.453e-03   2.722e-01    1.000e+00  1.000e+00      2971 -3.703e+03 -3.705e+03                    #> Path [46] :Best Iter: [54] ELBO (-3703.215758) evaluations: (2971)  #> Path [47] :Initial log joint density = -481786.411063  #> Path [47] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      8.965e-03   2.890e-01    1.000e+00  1.000e+00      3157 -3.703e+03 -3.709e+03                    #> Path [47] :Best Iter: [55] ELBO (-3703.294561) evaluations: (3157)  #> Path [48] :Initial log joint density = -481544.947120  #> Path [48] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      3.801e-03   1.938e-01    8.412e-01  8.412e-01      3131 -3.708e+03 -3.706e+03                    #> Path [48] :Best Iter: [55] ELBO (-3706.200379) evaluations: (3131)  #> Path [49] :Initial log joint density = -483370.355694  #> Path [49] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      2.731e-03   3.040e-01    5.707e-01  5.707e-01      3657 -3.701e+03 -3.711e+03                    #> Path [49] :Best Iter: [59] ELBO (-3700.585585) evaluations: (3657)  #> Path [50] :Initial log joint density = -482987.584645  #> Path [50] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      6.350e-03   2.093e-01    1.000e+00  1.000e+00      3418 -3.705e+03 -3.707e+03                    #> Path [50] :Best Iter: [56] ELBO (-3704.539424) evaluations: (3418)  #> Finished in  13.4 seconds. #> sccomp says: to do hypothesis testing run `sccomp_test()`, #>   the `test_composition_above_logit_fold_change` = 0.1 equates to a change of ~10%, and #>   0.7 equates to ~100% increase, if the baseline is ~0.1 proportion. #>   Use `sccomp_proportional_fold_change` to convert c_effect (linear) to proportion difference (non-linear). #> sccomp says: When visualising proportions, especially for complex models, consider setting `remove_unwanted_effects=TRUE`. This will adjust the proportions, preserving only the observed effect. #> Precompiled model not found. Compiling the model... #> Running make /tmp/RtmpFf0i1u/model-3ca0793b2697 \"STAN_THREADS=TRUE\" \\ #>   \"STANCFLAGS += --include-paths=/tmp/RtmpFf0i1u/temp_libpath3ca03c17963f/sccomp/stan --name='glm_multi_beta_binomial_generate_data_model'\" #>  #> --- Translating Stan model to C++ code --- #> bin/stanc --include-paths=/tmp/RtmpFf0i1u/temp_libpath3ca03c17963f/sccomp/stan --name='glm_multi_beta_binomial_generate_data_model' --o=/tmp/RtmpFf0i1u/model-3ca0793b2697.hpp /tmp/RtmpFf0i1u/model-3ca0793b2697.stan #>  #> --- Compiling C++ code --- #> g++ -Wno-deprecated-declarations -std=c++17 -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes -Wno-class-memaccess     -DSTAN_THREADS -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.87.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS          -c -Wno-ignored-attributes   -x c++ -o /tmp/RtmpFf0i1u/model-3ca0793b2697.o /tmp/RtmpFf0i1u/model-3ca0793b2697.hpp #>  #> --- Linking model --- #> g++ -Wno-deprecated-declarations -std=c++17 -pthread -D_REENTRANT -Wno-sign-compare -Wno-ignored-attributes -Wno-class-memaccess     -DSTAN_THREADS -I stan/lib/stan_math/lib/tbb_2020.3/include    -O3 -I src -I stan/src -I stan/lib/rapidjson_1.1.0/ -I lib/CLI11-1.9.1/ -I stan/lib/stan_math/ -I stan/lib/stan_math/lib/eigen_3.4.0 -I stan/lib/stan_math/lib/boost_1.87.0 -I stan/lib/stan_math/lib/sundials_6.1.1/include -I stan/lib/stan_math/lib/sundials_6.1.1/src/sundials    -DBOOST_DISABLE_ASSERTS               -Wl,-L,\"/home/runner/.cmdstan/cmdstan-2.37.0/stan/lib/stan_math/lib/tbb\"   -Wl,-rpath,\"/home/runner/.cmdstan/cmdstan-2.37.0/stan/lib/stan_math/lib/tbb\"      /tmp/RtmpFf0i1u/model-3ca0793b2697.o src/cmdstan/main_threads.o       -ltbb   stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_nvecserial.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_cvodes.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_idas.a stan/lib/stan_math/lib/sundials_6.1.1/lib/libsundials_kinsol.a  stan/lib/stan_math/lib/tbb/libtbb.so.2 -o /tmp/RtmpFf0i1u/model-3ca0793b2697 #> rm /tmp/RtmpFf0i1u/model-3ca0793b2697.o /tmp/RtmpFf0i1u/model-3ca0793b2697.hpp #> Model compiled and saved to cache successfully. #> Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... #>  #> Chain 1 finished in 0.0 seconds. #> Joining with `by = join_by(cell_group, sample)` #> Joining with `by = join_by(cell_group, type)`  # }"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_calculate_residuals.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Residuals Between Observed and Predicted Proportions — sccomp_calculate_residuals","title":"Calculate Residuals Between Observed and Predicted Proportions — sccomp_calculate_residuals","text":"sccomp_calculate_residuals computes residuals observed cell group proportions predicted proportions fitted sccomp model. function useful assessing model fit identifying cell groups samples model may adequately capture observed data. residuals calculated difference observed proportions predicted mean proportions model.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_calculate_residuals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Residuals Between Observed and Predicted Proportions — sccomp_calculate_residuals","text":"","code":"sccomp_calculate_residuals(.data)"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_calculate_residuals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Residuals Between Observed and Predicted Proportions — sccomp_calculate_residuals","text":".data tibble class sccomp_tbl, result sccomp_estimate(). tibble contains fitted model associated data necessary calculating residuals.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_calculate_residuals.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Residuals Between Observed and Predicted Proportions — sccomp_calculate_residuals","text":"tibble (tbl) following columns: sample - character column representing sample identifiers. cell_group - character column representing cell group identifiers. residuals - numeric column representing residuals, calculated difference observed predicted proportions. exposure - numeric column representing total counts (sum counts across cell groups) sample.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_calculate_residuals.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate Residuals Between Observed and Predicted Proportions — sccomp_calculate_residuals","text":"function performs following steps: Extracts predicted mean proportions cell group sample using sccomp_predict(). Calculates observed proportions original count data. Computes residuals subtracting predicted proportions observed proportions. Returns tibble containing sample, cell group, residuals, exposure (total counts per sample).","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_calculate_residuals.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Calculate Residuals Between Observed and Predicted Proportions — sccomp_calculate_residuals","text":"S. Mangiola, .J. Roth-Schulze, M. Trussart, E. Zozaya-Valdés, M. Ma, Z. Gao, .F. Rubin, T.P. Speed, H. Shim, & .T. Papenfuss, sccomp: Robust differential composition variability analysis single-cell data, Proc. Natl. Acad. Sci. U.S.. 120 (33) e2203828120, https://doi.org/10.1073/pnas.2203828120 (2023).","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_calculate_residuals.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Residuals Between Observed and Predicted Proportions — sccomp_calculate_residuals","text":"","code":"# \\donttest{   if (instantiate::stan_cmdstan_exists() && .Platform$OS.type == \"unix\") { # Load example data data(\"counts_obj\")  # Fit the sccomp model estimates <- sccomp_estimate(   counts_obj,   formula_composition = ~ type,   formula_variability = ~1,   sample = \"sample\",   cell_group = \"cell_group\",   abundance = \"count\",   approximate_posterior_inference = \"all\",   cores = 1 )  # Calculate residuals residuals <- sccomp_calculate_residuals(estimates)  # View the residuals print(residuals) }# } #> Warning: The `approximate_posterior_inference` argument of `sccomp_estimate()` is #> deprecated as of sccomp 1.7.7. #> ℹ The argument approximate_posterior_inference is now deprecated. Please use #>   inference_method. By default, inference_method value is inferred from #>   approximate_posterior_inference. #> sccomp says: count column is an integer. The sum-constrained beta binomial model will be used #> sccomp says: estimation #> sccomp says: the composition design matrix has columns: (Intercept), typecancer #> sccomp says: the variability design matrix has columns: (Intercept) #> Loading model from cache... #> Init values were only set for a subset of parameters.  #> Missing init values for the following parameters: #> random_effect_raw, random_effect_raw_2, random_effect_sigma_mu, random_effect_sigma_sigma, random_effect_sigma_raw, sigma_correlation_factor, random_effect_sigma_raw_2, sigma_correlation_factor_2, zero_random_effect #>  #> To disable this message use options(cmdstanr_warn_inits = FALSE). #> ------------------------------------------------------------  #> EXPERIMENTAL ALGORITHM:  #>   This procedure has not been thoroughly tested and may be unstable  #>   or buggy. The interface is subject to change.  #> ------------------------------------------------------------  #> Gradient evaluation took 0.000378 seconds  #> 1000 transitions using 10 leapfrog steps per transition would take 3.78 seconds.  #> Adjust your expectations accordingly!  #> Begin eta adaptation.  #> Iteration:   1 / 250 [  0%]  (Adaptation)  #> Iteration:  50 / 250 [ 20%]  (Adaptation)  #> Iteration: 100 / 250 [ 40%]  (Adaptation)  #> Iteration: 150 / 250 [ 60%]  (Adaptation)  #> Iteration: 200 / 250 [ 80%]  (Adaptation)  #> Success! Found best value [eta = 1] earlier than expected.  #> Begin stochastic gradient ascent.  #>   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes   #>    100        -4472.862             1.000            1.000  #>    200        -3754.237             0.596            1.000  #>    300        -3713.096             0.401            0.191  #>    400        -3719.384             0.301            0.191  #>    500        -3709.501             0.241            0.011  #>    600        -3709.158             0.201            0.011  #>    700        -3707.014             0.173            0.003   MEDIAN ELBO CONVERGED  #> Drawing a sample of size 4000 from the approximate posterior...   #> COMPLETED.  #> Finished in  2.5 seconds. #> Warning: Unknown or uninitialised column: `c_R_k_hat`. #> Warning: no non-missing arguments to max; returning -Inf #> sccomp says: to do hypothesis testing run `sccomp_test()`, #>   the `test_composition_above_logit_fold_change` = 0.1 equates to a change of ~10%, and #>   0.7 equates to ~100% increase, if the baseline is ~0.1 proportion. #>   Use `sccomp_proportional_fold_change` to convert c_effect (linear) to proportion difference (non-linear). #> Loading model from cache... #> Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... #>  #> Chain 1 finished in 0.0 seconds. #> # A tibble: 720 × 4 #>    sample cell_group residuals exposure #>    <chr>  <chr>          <dbl>    <int> #>  1 10x_6K B1           0.0107      5030 #>  2 10x_6K B2          -0.0272      5030 #>  3 10x_6K B3          -0.00488     5030 #>  4 10x_6K BM           0.00204     5030 #>  5 10x_6K CD4 1        0.00210     5030 #>  6 10x_6K CD4 2       -0.0162      5030 #>  7 10x_6K CD4 3        0.0613      5030 #>  8 10x_6K CD4 4       -0.00105     5030 #>  9 10x_6K CD4 5       -0.00139     5030 #> 10 10x_6K CD8 1       -0.0283      5030 #> # ℹ 710 more rows"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_estimate.html","id":null,"dir":"Reference","previous_headings":"","what":"Main Function for SCCOMP Estimate — sccomp_estimate","title":"Main Function for SCCOMP Estimate — sccomp_estimate","text":"sccomp_estimate function performs linear modeling table cell counts proportions, includes cell-group identifier, sample identifier, abundance (counts proportions), factors (continuous discrete). user can define linear model using R formula, first factor factor interest. Alternatively, sccomp accepts single-cell data containers (e.g., Seurat, SingleCellExperiment, cell metadata, group-size) derives count data cell metadata.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_estimate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Main Function for SCCOMP Estimate — sccomp_estimate","text":"","code":"sccomp_estimate(   .data,   formula_composition = ~1,   formula_variability = ~1,   sample,   cell_group,   abundance = NULL,   cores = detectCores(),   bimodal_mean_variability_association = FALSE,   percent_false_positive = 5,   inference_method = \"pathfinder\",   prior_mean = list(intercept = c(0, 1), coefficients = c(0, 1)),   prior_overdispersion_mean_association = list(intercept = c(5, 2), slope = c(0, 0.6),     standard_deviation = c(10, 20)),   .sample_cell_group_pairs_to_exclude = NULL,   output_directory = \"sccomp_draws_files\",   verbose = TRUE,   enable_loo = FALSE,   noise_model = \"multi_beta_binomial\",   exclude_priors = FALSE,   use_data = TRUE,   mcmc_seed = sample_seed(),   max_sampling_iterations = 20000,   pass_fit = TRUE,   sig_figs = 9,   cache_stan_model = sccomp_stan_models_cache_dir,   ...,   .count = NULL,   approximate_posterior_inference = NULL,   variational_inference = NULL,   .sample = NULL,   .cell_group = NULL,   .abundance = NULL )"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_estimate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Main Function for SCCOMP Estimate — sccomp_estimate","text":".data tibble including cell_group name column, sample name column, abundance column (counts proportions), factor columns. formula_composition formula describing model differential abundance. formula_variability formula describing model differential variability. sample column name character string sample identifier. Replaces deprecated .sample. cell_group column name character string cell-group identifier. Replaces deprecated .cell_group. abundance column name character string cell-group abundance, can counts (> 0) proportions (0 1, summing 1 across cell_group). Replaces deprecated .abundance .count. cores Number cores use parallel calculations. bimodal_mean_variability_association Logical, whether model mean-variability bimodal. percent_false_positive real number 0 100 outlier identification. inference_method Character string specifying inference method use ('pathfinder', 'hmc', 'variational'). Replaces deprecated approximate_posterior_inference variational_inference. prior_mean list specifying prior knowledge mean distribution, including intercept coefficients. prior_overdispersion_mean_association list specifying prior knowledge mean/variability association. .sample_cell_group_pairs_to_exclude column name indicating sample/cell-group pairs exclude. output_directory character string specifying output directory Stan draws. verbose Logical, whether print progression details. enable_loo Logical, whether enable model comparison using LOO package. noise_model character string specifying noise model (e.g., 'multi_beta_binomial'). exclude_priors Logical, whether run prior-free model. use_data Logical, whether run model data-free. mcmc_seed integer seed MCMC reproducibility. max_sampling_iterations Integer limit maximum number iterations large datasets. pass_fit Logical, whether include Stan fit attribute output. sig_figs Number significant figures use Stan model output. Default 9. cache_stan_model character string specifying cache directory compiled Stan models. sccomp version automatically appended ensure version isolation. Default sccomp_stan_models_cache_dir points ~/.sccomp_models. ... Additional arguments passed cmdstanr::sample function. .count DEPRECATED. Use abundance instead. approximate_posterior_inference DEPRECATED. Use inference_method instead. variational_inference DEPRECATED. Use inference_method instead. .sample DEPRECATED. Use sample instead. .cell_group DEPRECATED. Use cell_group instead. .abundance DEPRECATED. Use abundance instead.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_estimate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Main Function for SCCOMP Estimate — sccomp_estimate","text":"tibble (tbl), following columns: cell_group - cell groups tested. parameter - parameter estimated design matrix described input formula_composition formula_variability. factor - covariate factor formula, applicable (e.g., present Intercept contrasts). c_lower - Lower (2.5%) quantile posterior distribution composition (c) parameter. c_effect - Mean posterior distribution composition (c) parameter. c_upper - Upper (97.5%) quantile posterior distribution composition (c) parameter. c_pH0 - Probability c_effect smaller bigger test_composition_above_logit_fold_change argument. c_FDR - False discovery rate c_effect smaller bigger test_composition_above_logit_fold_change argument. False discovery rate Bayesian models calculated differently frequentists models, detailed Mangiola et al, PNAS 2023. c_n_eff - Effective sample size, number independent draws sample. higher, better. c_R_k_hat - R statistic, measure chain equilibrium, within 0.05 1.0. v_lower - Lower (2.5%) quantile posterior distribution variability (v) parameter. v_effect - Mean posterior distribution variability (v) parameter. v_upper - Upper (97.5%) quantile posterior distribution variability (v) parameter. v_pH0 - Probability v_effect smaller bigger test_composition_above_logit_fold_change argument. v_FDR - False discovery rate v_effect smaller bigger test_composition_above_logit_fold_change argument. False discovery rate Bayesian models calculated differently frequentists models, detailed Mangiola et al, PNAS 2023. v_n_eff - Effective sample size variability (v) parameter. v_R_k_hat - R statistic variability (v) parameter, measure chain equilibrium. function also attaches several attributes result: count_data - original count data used analysis, stored attribute efficient access. model_input - model input data used fitting. formula_composition - formula used composition modeling. formula_variability - formula used variability modeling. fit - Stan fit object (pass_fit = TRUE).","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_estimate.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Main Function for SCCOMP Estimate — sccomp_estimate","text":"S. Mangiola, .J. Roth-Schulze, M. Trussart, E. Zozaya-Valdés, M. Ma, Z. Gao, .F. Rubin, T.P. Speed, H. Shim, & .T. Papenfuss, sccomp: Robust differential composition variability analysis single-cell data, Proc. Natl. Acad. Sci. U.S.. 120 (33) e2203828120, https://doi.org/10.1073/pnas.2203828120 (2023).","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_estimate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Main Function for SCCOMP Estimate — sccomp_estimate","text":"","code":"print(\"cmdstanr is needed to run this example.\") #> [1] \"cmdstanr is needed to run this example.\" # Note: Before running the example, ensure that the 'cmdstanr' package is installed: # install.packages(\"cmdstanr\", repos = c(\"https://stan-dev.r-universe.dev/\", getOption(\"repos\")))  # \\donttest{   if (instantiate::stan_cmdstan_exists()) {     data(\"counts_obj\")      estimate <- sccomp_estimate(       counts_obj,       ~ type,       ~1,       \"sample\",       \"cell_group\",       \"count\",       cores = 1     )         # Note!     # If counts are available, do not use proportion.    # Using proportion ignores the high uncertainty of low counts        estimate_proportion <- sccomp_estimate(       counts_obj,       ~ type,       ~1,       \"sample\",       \"cell_group\",       \"proportion\",       cores = 1     )        } #> sccomp says: count column is an integer. The sum-constrained beta binomial model will be used #> sccomp says: estimation #> sccomp says: the composition design matrix has columns: (Intercept), typecancer #> sccomp says: the variability design matrix has columns: (Intercept) #> Loading model from cache... #> Path [1] :Initial log joint density = -481654.381653  #> Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      2.167e-03   2.029e-01    6.600e-01  6.600e-01      3424 -3.697e+03 -3.716e+03                    #> Path [1] :Best Iter: [56] ELBO (-3697.434692) evaluations: (3424)  #> Path [2] :Initial log joint density = -481500.229411  #> Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      5.412e-03   2.123e-01    1.000e+00  1.000e+00      2971 -3.706e+03 -3.707e+03                    #> Path [2] :Best Iter: [39] ELBO (-3705.954588) evaluations: (2971)  #> Path [3] :Initial log joint density = -481822.102920  #> Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              64      -4.788e+05      1.304e-02   3.860e-01    1.000e+00  1.000e+00      3916 -3.697e+03 -3.708e+03                    #> Path [3] :Best Iter: [63] ELBO (-3697.272401) evaluations: (3916)  #> Path [4] :Initial log joint density = -481551.788506  #> Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              51      -4.788e+05      8.631e-03   2.809e-01    9.750e-01  9.750e-01      2716 -3.707e+03 -3.719e+03                    #> Path [4] :Best Iter: [42] ELBO (-3707.097311) evaluations: (2716)  #> Path [5] :Initial log joint density = -484419.961750  #> Path [5] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      7.471e-03   2.344e-01    9.691e-01  9.691e-01      3279 -3.700e+03 -3.711e+03                    #> Path [5] :Best Iter: [57] ELBO (-3700.030866) evaluations: (3279)  #> Path [6] :Initial log joint density = -481631.827885  #> Path [6] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      9.808e-03   2.497e-01    1.000e+00  1.000e+00      2866 -3.709e+03 -3.709e+03                    #> Path [6] :Best Iter: [45] ELBO (-3708.540375) evaluations: (2866)  #> Path [7] :Initial log joint density = -481710.030492  #> Path [7] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      2.104e-02   3.024e-01    1.000e+00  1.000e+00      3539 -3.697e+03 -3.701e+03                    #> Path [7] :Best Iter: [60] ELBO (-3697.158723) evaluations: (3539)  #> Path [8] :Initial log joint density = -481330.877215  #> Path [8] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      1.186e-02   3.337e-01    1.000e+00  1.000e+00      3147 -3.699e+03 -3.710e+03                    #> Path [8] :Best Iter: [55] ELBO (-3699.348605) evaluations: (3147)  #> Path [9] :Initial log joint density = -481611.041983  #> Path [9] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      1.365e-02   2.373e-01    1.000e+00  1.000e+00      3006 -3.707e+03 -3.716e+03                    #> Path [9] :Best Iter: [49] ELBO (-3707.409962) evaluations: (3006)  #> Path [10] :Initial log joint density = -481745.971644  #> Path [10] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              62      -4.788e+05      8.569e-03   1.859e-01    1.000e+00  1.000e+00      3566 -3.700e+03 -3.701e+03                    #> Path [10] :Best Iter: [58] ELBO (-3699.962136) evaluations: (3566)  #> Path [11] :Initial log joint density = -481872.465900  #> Path [11] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      7.808e-03   2.991e-01    1.000e+00  1.000e+00      3019 -3.708e+03 -3.722e+03                    #> Path [11] :Best Iter: [42] ELBO (-3707.865249) evaluations: (3019)  #> Path [12] :Initial log joint density = -481559.476654  #> Path [12] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      2.563e-03   2.112e-01    7.010e-01  7.010e-01      3364 -3.699e+03 -3.714e+03                    #> Path [12] :Best Iter: [56] ELBO (-3698.876768) evaluations: (3364)  #> Path [13] :Initial log joint density = -481696.894307  #> Path [13] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              63      -4.788e+05      1.038e-02   1.895e-01    1.000e+00  1.000e+00      3810 -3.700e+03 -3.707e+03                    #> Path [13] :Best Iter: [61] ELBO (-3700.025273) evaluations: (3810)  #> Path [14] :Initial log joint density = -483510.973696  #> Path [14] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      1.308e-02   2.432e-01    1.000e+00  1.000e+00      3301 -3.699e+03 -3.705e+03                    #> Path [14] :Best Iter: [55] ELBO (-3698.823192) evaluations: (3301)  #> Path [15] :Initial log joint density = -481957.307460  #> Path [15] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              67      -4.788e+05      6.586e-03   1.940e-01    5.008e-01  1.000e+00      4142 -3.702e+03 -3.711e+03                    #> Path [15] :Best Iter: [56] ELBO (-3701.545769) evaluations: (4142)  #> Path [16] :Initial log joint density = -482282.152351  #> Path [16] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      9.781e-03   2.929e-01    1.000e+00  1.000e+00      3503 -3.702e+03 -3.701e+03                    #> Path [16] :Best Iter: [60] ELBO (-3701.203964) evaluations: (3503)  #> Path [17] :Initial log joint density = -482230.918879  #> Path [17] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      1.252e-02   2.596e-01    1.000e+00  1.000e+00      3535 -3.701e+03 -3.701e+03                    #> Path [17] :Best Iter: [59] ELBO (-3700.816082) evaluations: (3535)  #> Path [18] :Initial log joint density = -482065.406703  #> Path [18] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      5.765e-03   1.403e-01    1.000e+00  1.000e+00      3192 -3.706e+03 -3.710e+03                    #> Path [18] :Best Iter: [47] ELBO (-3705.670744) evaluations: (3192)  #> Path [19] :Initial log joint density = -481648.673557  #> Path [19] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      7.943e-03   2.073e-01    8.565e-01  8.565e-01      3427 -3.702e+03 -3.716e+03                    #> Path [19] :Best Iter: [57] ELBO (-3702.467771) evaluations: (3427)  #> Path [20] :Initial log joint density = -481614.512691  #> Path [20] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      1.290e-02   3.085e-01    1.000e+00  1.000e+00      2994 -3.708e+03 -3.706e+03                    #> Path [20] :Best Iter: [54] ELBO (-3706.201107) evaluations: (2994)  #> Path [21] :Initial log joint density = -481743.073235  #> Path [21] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      8.344e-03   1.823e-01    9.147e-01  9.147e-01      3621 -3.698e+03 -3.710e+03                    #> Path [21] :Best Iter: [59] ELBO (-3698.046204) evaluations: (3621)  #> Path [22] :Initial log joint density = -481521.666538  #> Path [22] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      8.577e-03   2.271e-01    1.000e+00  1.000e+00      3312 -3.702e+03 -3.701e+03                    #> Path [22] :Best Iter: [56] ELBO (-3700.529150) evaluations: (3312)  #> Path [23] :Initial log joint density = -481608.246511  #> Path [23] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      7.073e-03   2.285e-01    1.000e+00  1.000e+00      3273 -3.701e+03 -3.702e+03                    #> Path [23] :Best Iter: [55] ELBO (-3701.494855) evaluations: (3273)  #> Path [24] :Initial log joint density = -481590.757812  #> Path [24] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      9.357e-03   3.162e-01    1.000e+00  1.000e+00      3109 -3.699e+03 -3.711e+03                    #> Path [24] :Best Iter: [55] ELBO (-3698.947510) evaluations: (3109)  #> Path [25] :Initial log joint density = -481883.127110  #> Path [25] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      9.923e-03   2.298e-01    1.000e+00  1.000e+00      3265 -3.702e+03 -3.701e+03                    #> Path [25] :Best Iter: [57] ELBO (-3701.212455) evaluations: (3265)  #> Path [26] :Initial log joint density = -481610.802137  #> Path [26] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      2.457e-03   1.994e-01    6.760e-01  6.760e-01      2923 -3.706e+03 -3.721e+03                    #> Path [26] :Best Iter: [39] ELBO (-3706.333994) evaluations: (2923)  #> Path [27] :Initial log joint density = -483043.100237  #> Path [27] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      3.976e-03   2.161e-01    7.877e-01  7.877e-01      3162 -3.708e+03 -3.708e+03                    #> Path [27] :Best Iter: [52] ELBO (-3707.686934) evaluations: (3162)  #> Path [28] :Initial log joint density = -481568.764842  #> Path [28] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      5.104e-03   1.708e-01    9.489e-01  9.489e-01      3270 -3.701e+03 -3.709e+03                    #> Path [28] :Best Iter: [56] ELBO (-3700.609982) evaluations: (3270)  #> Path [29] :Initial log joint density = -481709.139730  #> Path [29] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      2.489e-03   2.384e-01    6.879e-01  6.879e-01      3115 -3.710e+03 -3.716e+03                    #> Path [29] :Best Iter: [49] ELBO (-3710.466699) evaluations: (3115)  #> Path [30] :Initial log joint density = -483078.070446  #> Path [30] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      1.035e-02   2.263e-01    1.000e+00  1.000e+00      3049 -3.709e+03 -3.709e+03                    #> Path [30] :Best Iter: [51] ELBO (-3708.530262) evaluations: (3049)  #> Path [31] :Initial log joint density = -481626.358297  #> Path [31] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      1.094e-02   2.166e-01    1.000e+00  1.000e+00      3103 -3.701e+03 -3.699e+03                    #> Path [31] :Best Iter: [56] ELBO (-3699.436563) evaluations: (3103)  #> Path [32] :Initial log joint density = -481527.834220  #> Path [32] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      7.462e-03   2.762e-01    8.202e-01  8.202e-01      2876 -3.710e+03 -3.726e+03                    #> Path [32] :Best Iter: [51] ELBO (-3709.758603) evaluations: (2876)  #> Path [33] :Initial log joint density = -481526.836811  #> Path [33] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      4.923e-03   1.674e-01    8.020e-01  8.020e-01      3292 -3.701e+03 -3.712e+03                    #> Path [33] :Best Iter: [55] ELBO (-3700.516092) evaluations: (3292)  #> Path [34] :Initial log joint density = -481442.115160  #> Path [34] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      1.005e-02   2.795e-01    1.000e+00  1.000e+00      3083 -3.704e+03 -3.712e+03                    #> Path [34] :Best Iter: [52] ELBO (-3704.168963) evaluations: (3083)  #> Path [35] :Initial log joint density = -482817.992860  #> Path [35] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      8.217e-03   1.964e-01    1.000e+00  1.000e+00      3383 -3.699e+03 -3.706e+03                    #> Path [35] :Best Iter: [56] ELBO (-3699.012032) evaluations: (3383)  #> Path [36] :Initial log joint density = -482371.212869  #> Path [36] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      8.694e-03   1.702e-01    1.000e+00  1.000e+00      3463 -3.706e+03 -3.702e+03                    #> Path [36] :Best Iter: [59] ELBO (-3702.118871) evaluations: (3463)  #> Path [37] :Initial log joint density = -481669.243196  #> Path [37] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      8.186e-03   2.434e-01    8.575e-01  8.575e-01      3382 -3.702e+03 -3.708e+03                    #> Path [37] :Best Iter: [57] ELBO (-3702.403673) evaluations: (3382)  #> Path [38] :Initial log joint density = -481726.485038  #> Path [38] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      5.826e-03   1.837e-01    1.000e+00  1.000e+00      3478 -3.701e+03 -3.706e+03                    #> Path [38] :Best Iter: [58] ELBO (-3700.519387) evaluations: (3478)  #> Path [39] :Initial log joint density = -486797.702276  #> Path [39] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      1.542e-02   3.756e-01    1.000e+00  1.000e+00      3504 -3.700e+03 -3.707e+03                    #> Path [39] :Best Iter: [59] ELBO (-3700.368903) evaluations: (3504)  #> Path [40] :Initial log joint density = -482343.229078  #> Path [40] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      1.091e-02   2.573e-01    1.000e+00  1.000e+00      3428 -3.702e+03 -3.704e+03                    #> Path [40] :Best Iter: [57] ELBO (-3702.001015) evaluations: (3428)  #> Path [41] :Initial log joint density = -482326.036142  #> Path [41] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.060e-02   3.173e-01    4.180e-01  1.000e+00      3465 -3.700e+03 -3.708e+03                    #> Path [41] :Best Iter: [58] ELBO (-3700.247131) evaluations: (3465)  #> Path [42] :Initial log joint density = -484233.788559  #> Path [42] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.209e-02   3.638e-01    1.000e+00  1.000e+00      3519 -3.702e+03 -3.710e+03                    #> Path [42] :Best Iter: [58] ELBO (-3702.496905) evaluations: (3519)  #> Path [43] :Initial log joint density = -481499.079984  #> Path [43] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      7.917e-03   2.701e-01    1.000e+00  1.000e+00      2921 -3.709e+03 -3.722e+03                    #> Path [43] :Best Iter: [48] ELBO (-3708.901039) evaluations: (2921)  #> Path [44] :Initial log joint density = -481690.725613  #> Path [44] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              51      -4.788e+05      1.690e-02   2.872e-01    1.000e+00  1.000e+00      2791 -3.708e+03 -3.712e+03                    #> Path [44] :Best Iter: [38] ELBO (-3708.309108) evaluations: (2791)  #> Path [45] :Initial log joint density = -481978.836665  #> Path [45] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.012e-02   3.314e-01    1.000e+00  1.000e+00      3356 -3.700e+03 -3.709e+03                    #> Path [45] :Best Iter: [58] ELBO (-3699.877352) evaluations: (3356)  #> Path [46] :Initial log joint density = -482134.522441  #> Path [46] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      7.966e-03   1.688e-01    1.000e+00  1.000e+00      3243 -3.701e+03 -3.702e+03                    #> Path [46] :Best Iter: [55] ELBO (-3700.875823) evaluations: (3243)  #> Path [47] :Initial log joint density = -481964.238753  #> Path [47] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              63      -4.788e+05      9.695e-03   2.962e-01    9.379e-01  9.379e-01      3655 -3.701e+03 -3.709e+03                    #> Path [47] :Best Iter: [61] ELBO (-3700.571289) evaluations: (3655)  #> Path [48] :Initial log joint density = -482907.260269  #> Path [48] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      6.646e-03   2.683e-01    8.935e-01  8.935e-01      3277 -3.698e+03 -3.713e+03                    #> Path [48] :Best Iter: [55] ELBO (-3698.324182) evaluations: (3277)  #> Path [49] :Initial log joint density = -481811.295994  #> Path [49] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      1.082e-02   2.068e-01    1.000e+00  1.000e+00      3161 -3.702e+03 -3.700e+03                    #> Path [49] :Best Iter: [56] ELBO (-3699.722007) evaluations: (3161)  #> Path [50] :Initial log joint density = -482767.869635  #> Path [50] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      1.034e-02   1.957e-01    1.000e+00  1.000e+00      3025 -3.709e+03 -3.709e+03                    #> Path [50] :Best Iter: [49] ELBO (-3708.691571) evaluations: (3025)  #> Finished in  14.0 seconds. #> sccomp says: to do hypothesis testing run `sccomp_test()`, #>   the `test_composition_above_logit_fold_change` = 0.1 equates to a change of ~10%, and #>   0.7 equates to ~100% increase, if the baseline is ~0.1 proportion. #>   Use `sccomp_proportional_fold_change` to convert c_effect (linear) to proportion difference (non-linear). #> sccomp says: proportion column is a proportion. The sum-constrained beta model will be used. When possible using counts is preferred as the binomial noise component is often dominating for rare groups (e.g. rare cell types). #> sccomp says: estimation #> sccomp says: the composition design matrix has columns: (Intercept), typecancer #> sccomp says: the variability design matrix has columns: (Intercept) #> Loading model from cache... #> Warning: sccomp says: your proportion values include 0. Assuming that 0s derive from a precision threshold (e.g. deconvolution), 0s are converted to the smaller non 0 proportion value. #> Path [1] :Initial log joint density = -902.968750  #> Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.547e+03      5.469e-03   4.581e+03    4.295e-03  4.295e-03      8579  2.282e+03 -1.504e+04                    #> Path [1] :Best Iter: [41] ELBO (2281.755314) evaluations: (8579)  #> Path [2] :Initial log joint density = -1161.963117  #> Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.544e+03      1.790e-02   3.196e+03    1.307e-02  1.307e-02      8383  2.282e+03 -1.199e+04                    #> Path [2] :Best Iter: [33] ELBO (2281.917961) evaluations: (8383)  #> Path [3] :Initial log joint density = -482.168479  #> Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.545e+03      2.372e-02   4.608e+03    2.556e-02  2.556e-02      8742  2.282e+03 -8.034e+04                    #> Path [3] :Best Iter: [30] ELBO (2281.982669) evaluations: (8742)  #> Path [4] :Initial log joint density = -459.558926  #> Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.555e+03      1.444e-01   7.699e+03    4.006e-02  4.006e-02      8779  2.278e+03 -1.391e+04                    #> Path [4] :Best Iter: [30] ELBO (2278.229108) evaluations: (8779)  #> Path [5] :Initial log joint density = -383.381341  #> Path [5] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.549e+03      6.764e-03   3.918e+03    2.849e-02  2.849e-02      9165  2.282e+03 -6.903e+03                    #> Path [5] :Best Iter: [26] ELBO (2282.000385) evaluations: (9165)  #> Path [6] :Initial log joint density = -365.395131  #> Path [6] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.548e+03      1.030e-01   1.925e+03    3.104e-02  6.174e-02      8257  2.280e+03 -2.210e+04                    #> Path [6] :Best Iter: [27] ELBO (2280.349779) evaluations: (8257)  #> Path [7] :Initial log joint density = -428.442405  #> Path [7] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.567e+03      1.008e-01   4.908e+03    3.536e-02  3.536e-02      8646  2.280e+03 -8.924e+03                    #> Path [7] :Best Iter: [32] ELBO (2280.208431) evaluations: (8646)  #> Path [8] :Initial log joint density = -220.070657  #> Path [8] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.560e+03      4.852e-02   4.520e+03    1.177e-02  1.177e-02      8617  2.277e+03 -4.195e+10                    #> Path [8] :Best Iter: [33] ELBO (2276.719359) evaluations: (8617)  #> Path [9] :Initial log joint density = -557.215748  #> Path [9] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.550e+03      4.432e-02   2.538e+03    3.787e-02  3.787e-02      8132  2.282e+03 -4.631e+03                    #> Path [9] :Best Iter: [34] ELBO (2282.026798) evaluations: (8132)  #> Path [10] :Initial log joint density = -524.013626  #> Path [10] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.535e+03      3.022e-02   1.783e+03    3.389e-02  3.389e-02      8957  2.278e+03  5.884e+02                    #> Path [10] :Best Iter: [35] ELBO (2277.544277) evaluations: (8957)  #> Path [11] :Initial log joint density = -1079.727001  #> Path [11] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.542e+03      3.335e-02   3.996e+03    1.907e-02  1.907e-02      8646  2.281e+03 -5.303e+04                    #> Path [11] :Best Iter: [31] ELBO (2281.186277) evaluations: (8646)  #> Path [12] :Initial log joint density = -465.690189  #> Path [12] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.558e+03      4.113e-02   4.346e+03    1.451e-02  3.513e-02      8493  2.280e+03 -3.931e+04                    #> Path [12] :Best Iter: [30] ELBO (2280.309476) evaluations: (8493)  #> Path [13] :Initial log joint density = -178.211915  #> Path [13] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.568e+03      6.868e-02   1.368e+04    1.353e-02  2.792e-02      8674  2.282e+03 -4.164e+05                    #> Path [13] :Best Iter: [30] ELBO (2281.639912) evaluations: (8674)  #> Path [14] :Initial log joint density = -230.265684  #> Path [14] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.557e+03      8.442e-02   4.200e+03    4.441e-02  4.441e-02      8748  2.281e+03 -2.903e+04                    #> Path [14] :Best Iter: [34] ELBO (2280.937740) evaluations: (8748)  #> Path [15] :Initial log joint density = -793.051993  #> Path [15] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.552e+03      1.684e-02   3.400e+03    2.031e-02  2.031e-02      8790  2.280e+03  6.368e+02                    #> Path [15] :Best Iter: [25] ELBO (2280.073105) evaluations: (8790)  #> Path [16] :Initial log joint density = -578.436960  #> Path [16] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.564e+03      8.278e-02   5.328e+03    5.374e-02  5.374e-02      8377  2.280e+03 -6.433e+05                    #> Path [16] :Best Iter: [33] ELBO (2280.497199) evaluations: (8377)  #> Path [17] :Initial log joint density = -2028.358989  #> Path [17] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.541e+03      3.679e-02   2.322e+03    1.005e-02  3.663e-02      8500  2.284e+03 -3.824e+06                    #> Path [17] :Best Iter: [37] ELBO (2283.887134) evaluations: (8500)  #> Path [18] :Initial log joint density = -1432.743671  #> Path [18] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.535e+03      1.013e-01   2.024e+03    4.631e-02  8.259e-02      8283  2.281e+03 -7.973e+04                    #> Path [18] :Best Iter: [32] ELBO (2281.183175) evaluations: (8283)  #> Path [19] :Initial log joint density = -588.197326  #> Path [19] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.566e+03      8.220e-02   1.108e+04    1.056e-02  2.928e-02      8635  2.283e+03 -5.722e+06                    #> Path [19] :Best Iter: [31] ELBO (2283.309332) evaluations: (8635)  #> Path [20] :Initial log joint density = -623.767183  #> Path [20] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.535e+03      7.503e-02   2.004e+03    5.798e-02  5.798e-02      8777  2.280e+03 -3.290e+04                    #> Path [20] :Best Iter: [39] ELBO (2280.071008) evaluations: (8777)  #> Path [21] :Initial log joint density = -634.509077  #> Path [21] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.563e+03      1.285e-01   1.165e+04    3.788e-02  7.475e-02      8477  2.281e+03 -6.214e+05                    #> Path [21] :Best Iter: [31] ELBO (2281.210964) evaluations: (8477)  #> Path [22] :Initial log joint density = -2499.201417  #> Path [22] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.557e+03      7.821e-02   4.823e+03    3.161e-02  3.161e-02      8625  2.282e+03 -3.440e+04                    #> Path [22] :Best Iter: [33] ELBO (2281.623174) evaluations: (8625)  #> Path [23] :Initial log joint density = -411.836333  #> Path [23] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.554e+03      7.747e-02   4.734e+03    3.328e-02  6.266e-02      8636  2.277e+03 -1.151e+05                    #> Path [23] :Best Iter: [28] ELBO (2277.209557) evaluations: (8636)  #> Path [24] :Initial log joint density = -559.424689  #> Path [24] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.546e+03      3.691e-02   3.027e+03    2.760e-02  2.760e-02      8434  2.275e+03 -1.843e+04                    #> Path [24] :Best Iter: [33] ELBO (2275.382033) evaluations: (8434)  #> Path [25] :Initial log joint density = -522.532230  #> Path [25] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.533e+03      2.821e-02   1.835e+03    1.866e-02  1.866e-02      8243  2.279e+03 -1.575e+03                    #> Path [25] :Best Iter: [40] ELBO (2278.849103) evaluations: (8243)  #> Path [26] :Initial log joint density = -691.995282  #> Path [26] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.556e+03      2.518e-02   3.997e+03    1.741e-02  1.741e-02      8682  2.282e+03 -2.655e+04                    #> Path [26] :Best Iter: [35] ELBO (2281.514117) evaluations: (8682)  #> Path [27] :Initial log joint density = -512.403578  #> Path [27] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.538e+03      2.831e-02   3.648e+03    2.495e-02  2.495e-02      8365  2.283e+03 -5.230e+04                    #> Path [27] :Best Iter: [39] ELBO (2282.767566) evaluations: (8365)  #> Path [28] :Initial log joint density = -1575.241488  #> Path [28] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.528e+03      3.966e-02   2.725e+03    2.048e-02  2.048e-02      8323  2.282e+03 -1.524e+06                    #> Path [28] :Best Iter: [40] ELBO (2282.192954) evaluations: (8323)  #> Path [29] :Initial log joint density = -275.740487  #> Path [29] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.558e+03      7.615e-02   5.330e+03    6.129e-02  6.129e-02      9127  2.283e+03 -3.109e+05                    #> Path [29] :Best Iter: [31] ELBO (2282.530924) evaluations: (9127)  #> Path [30] :Initial log joint density = -715.116811  #> Path [30] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.544e+03      6.860e-02   2.617e+03    1.621e-02  3.373e-02      8722  2.279e+03 -1.400e+04                    #> Path [30] :Best Iter: [38] ELBO (2279.198273) evaluations: (8722)  #> Path [31] :Initial log joint density = -2684.787615  #> Path [31] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.554e+03      1.710e-02   8.064e+03    1.529e-02  1.529e-02      8611  2.282e+03 -4.490e+03                    #> Path [31] :Best Iter: [29] ELBO (2281.915604) evaluations: (8611)  #> Path [32] :Initial log joint density = -485.198740  #> Path [32] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.565e+03      7.640e-02   1.268e+04    6.079e-02  6.079e-02      8925  2.283e+03  6.951e+02                    #> Path [32] :Best Iter: [30] ELBO (2283.078447) evaluations: (8925)  #> Path [33] :Initial log joint density = -6078.335094  #> Path [33] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.541e+03      7.620e-02   3.937e+03    4.242e-02  4.242e-02      8665  2.279e+03 -3.366e+03                    #> Path [33] :Best Iter: [36] ELBO (2279.453213) evaluations: (8665)  #> Path [34] :Initial log joint density = -1173.869259  #> Path [34] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.540e+03      4.209e-02   2.384e+03    1.676e-02  1.676e-02      8615  2.284e+03 -9.163e+03                    #> Path [34] :Best Iter: [34] ELBO (2284.132407) evaluations: (8615)  #> Path [35] :Initial log joint density = -332.811121  #> Path [35] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.556e+03      4.870e-02   5.141e+03    2.172e-02  2.172e-02      8255  2.279e+03 -3.792e+05                    #> Path [35] :Best Iter: [30] ELBO (2278.778488) evaluations: (8255)  #> Path [36] :Initial log joint density = -747.060435  #> Path [36] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.559e+03      1.503e-02   3.095e+03    1.378e-02  1.378e-02      8201  2.278e+03 -2.279e+04                    #> Path [36] :Best Iter: [32] ELBO (2277.511493) evaluations: (8201)  #> Path [37] :Initial log joint density = -526.723191  #> Path [37] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.561e+03      6.232e-02   5.949e+03    4.551e-02  4.551e-02      8650  2.281e+03 -2.269e+03                    #> Path [37] :Best Iter: [30] ELBO (2280.558136) evaluations: (8650)  #> Path [38] :Initial log joint density = -404.384347  #> Path [38] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.568e+03      1.375e-01   6.303e+03    5.706e-02  9.788e-02      8664  2.282e+03 -7.229e+04                    #> Path [38] :Best Iter: [27] ELBO (2282.465134) evaluations: (8664)  #> Path [39] :Initial log joint density = -632.941179  #> Path [39] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.550e+03      4.273e-02   2.624e+03    1.527e-02  1.527e-02      9212  2.279e+03 -1.368e+04                    #> Path [39] :Best Iter: [33] ELBO (2279.162542) evaluations: (9212)  #> Path [40] :Initial log joint density = -775.346346  #> Path [40] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.530e+03      6.272e-02   1.528e+03    8.953e-02  8.953e-02      8525  2.282e+03  5.353e+01                    #> Path [40] :Best Iter: [36] ELBO (2282.472913) evaluations: (8525)  #> Path [41] :Initial log joint density = -712.964437  #> Path [41] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.557e+03      1.158e-01   4.045e+03    2.051e-02  4.673e-02      8777  2.279e+03 -1.554e+06                    #> Path [41] :Best Iter: [30] ELBO (2279.017463) evaluations: (8777)  #> Path [42] :Initial log joint density = -742.481724  #> Path [42] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.535e+03      4.342e-02   1.681e+03    2.675e-02  2.675e-02      8150  2.285e+03 -1.228e+04                    #> Path [42] :Best Iter: [38] ELBO (2284.697530) evaluations: (8150)  #> Path [43] :Initial log joint density = -896.167512  #> Path [43] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.540e+03      5.332e-02   3.331e+03    1.454e-02  1.454e-02      8271  2.279e+03 -7.228e+06                    #> Path [43] :Best Iter: [40] ELBO (2278.959754) evaluations: (8271)  #> Path [44] :Initial log joint density = -685.456581  #> Path [44] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.553e+03      1.849e-02   3.474e+03    2.683e-02  2.683e-02      8431  2.279e+03 -1.661e+04                    #> Path [44] :Best Iter: [33] ELBO (2278.727162) evaluations: (8431)  #> Path [45] :Initial log joint density = -643.163599  #> Path [45] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.559e+03      7.774e-02   4.767e+03    5.292e-02  5.292e-02      8529  2.282e+03 -4.488e+05                    #> Path [45] :Best Iter: [36] ELBO (2281.509429) evaluations: (8529)  #> Path [46] :Initial log joint density = -1335.371318  #> Path [46] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.537e+03      8.866e-02   2.322e+03    3.951e-02  3.951e-02      8568  2.283e+03 -3.178e+05                    #> Path [46] :Best Iter: [38] ELBO (2282.753006) evaluations: (8568)  #> Path [47] :Initial log joint density = -1070.599605  #> Path [47] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.545e+03      7.592e-02   5.141e+03    2.477e-02  2.477e-02      8665  2.281e+03 -1.938e+05                    #> Path [47] :Best Iter: [32] ELBO (2281.286466) evaluations: (8665)  #> Path [48] :Initial log joint density = -616.101402  #> Path [48] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.554e+03      3.762e-02   1.335e+04    1.550e-02  1.550e-02      8515  2.281e+03 -2.545e+04                    #> Path [48] :Best Iter: [36] ELBO (2281.348816) evaluations: (8515)  #> Path [49] :Initial log joint density = -515.544733  #> Path [49] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.559e+03      4.951e-02   4.184e+03    6.724e-02  6.724e-02      8553  2.282e+03 -4.611e+03                    #> Path [49] :Best Iter: [23] ELBO (2281.706488) evaluations: (8553)  #> Path [50] :Initial log joint density = -461.375064  #> Path [50] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100       2.567e+03      5.172e-02   7.435e+03    2.628e-02  2.628e-02      8422  2.280e+03 -1.284e+06                    #> Path [50] :Best Iter: [33] ELBO (2279.898143) evaluations: (8422)  #> Finished in  16.0 seconds. #> sccomp says: to do hypothesis testing run `sccomp_test()`, #>   the `test_composition_above_logit_fold_change` = 0.1 equates to a change of ~10%, and #>   0.7 equates to ~100% increase, if the baseline is ~0.1 proportion. #>   Use `sccomp_proportional_fold_change` to convert c_effect (linear) to proportion difference (non-linear). # }"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_predict.html","id":null,"dir":"Reference","previous_headings":"","what":"sccomp_predict — sccomp_predict","title":"sccomp_predict — sccomp_predict","text":"function replicates counts real-world dataset.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_predict.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"sccomp_predict — sccomp_predict","text":"","code":"sccomp_predict(   fit,   formula_composition = NULL,   new_data = NULL,   number_of_draws = 500,   mcmc_seed = sample_seed(),   summary_instead_of_draws = TRUE,   robust = FALSE )"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_predict.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"sccomp_predict — sccomp_predict","text":"fit result sccomp_estimate. formula_composition formula. formula describing model differential abundance, example ~treatment. formula can sub-formula estimated model; case factor factored . new_data sample-wise data frame including column represent factors formula. want predict proportions 10 samples, 10 rows. T number_of_draws integer. may copies data want draw model joint posterior distribution. mcmc_seed integer. Used Markov-chain Monte Carlo reproducibility. default random number sampled 1 999999. can controlled set.seed() summary_instead_of_draws Return summary values (.e. mean quantiles) predicted proportions, return single draws. Single draws can helful better analyse uncertainty prediction. robust logical. TRUE, use robust statistics (median median absolute deviation) instead classical statistics (mean standard deviation) summary calculations.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_predict.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"sccomp_predict — sccomp_predict","text":"tibble (tbl) following columns: cell_group - character column representing cell group tested. sample - factor column representing sample name predictions made. proportion_mean - numeric column representing predicted mean (median robust=TRUE) proportions model. proportion_lower - numeric column representing lower bound (2.5%) 95% credible interval predicted proportions. proportion_upper - numeric column representing upper bound (97.5%) 95% credible interval predicted proportions.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_predict.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"sccomp_predict — sccomp_predict","text":"S. Mangiola, .J. Roth-Schulze, M. Trussart, E. Zozaya-Valdés, M. Ma, Z. Gao, .F. Rubin, T.P. Speed, H. Shim, & .T. Papenfuss, sccomp: Robust differential composition variability analysis single-cell data, Proc. Natl. Acad. Sci. U.S.. 120 (33) e2203828120, https://doi.org/10.1073/pnas.2203828120 (2023).","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_predict.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"sccomp_predict — sccomp_predict","text":"","code":"print(\"cmdstanr is needed to run this example.\") #> [1] \"cmdstanr is needed to run this example.\" # Note: Before running the example, ensure that the 'cmdstanr' package is installed: # install.packages(\"cmdstanr\", repos = c(\"https://stan-dev.r-universe.dev/\", getOption(\"repos\")))  # \\donttest{   if (instantiate::stan_cmdstan_exists() && .Platform$OS.type == \"unix\") {     data(\"counts_obj\")      sccomp_estimate(       counts_obj,       ~ type, ~1, \"sample\", \"cell_group\", \"count\",       cores = 1     ) |>     sccomp_predict()   } #> sccomp says: count column is an integer. The sum-constrained beta binomial model will be used #> sccomp says: estimation #> sccomp says: the composition design matrix has columns: (Intercept), typecancer #> sccomp says: the variability design matrix has columns: (Intercept) #> Loading model from cache... #> Path [1] :Initial log joint density = -481572.345045  #> Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      6.965e-03   2.179e-01    1.000e+00  1.000e+00      2911 -3.706e+03 -3.713e+03                    #> Path [1] :Best Iter: [42] ELBO (-3705.770457) evaluations: (2911)  #> Path [2] :Initial log joint density = -482163.812312  #> Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      5.227e-03   1.792e-01    1.000e+00  1.000e+00      3327 -3.703e+03 -3.706e+03                    #> Path [2] :Best Iter: [55] ELBO (-3702.900783) evaluations: (3327)  #> Path [3] :Initial log joint density = -481584.869724  #> Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      7.359e-03   2.094e-01    8.768e-01  8.768e-01      3393 -3.703e+03 -3.712e+03                    #> Path [3] :Best Iter: [55] ELBO (-3703.130462) evaluations: (3393)  #> Path [4] :Initial log joint density = -481744.069203  #> Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      9.695e-03   2.538e-01    1.000e+00  1.000e+00      3080 -3.706e+03 -3.699e+03                    #> Path [4] :Best Iter: [55] ELBO (-3699.163097) evaluations: (3080)  #> Path [5] :Initial log joint density = -481579.928171  #> Path [5] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      7.247e-03   2.239e-01    1.000e+00  1.000e+00      3079 -3.709e+03 -3.706e+03                    #> Path [5] :Best Iter: [55] ELBO (-3705.537905) evaluations: (3079)  #> Path [6] :Initial log joint density = -481820.864967  #> Path [6] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      2.757e-03   2.351e-01    7.193e-01  7.193e-01      3443 -3.698e+03 -3.716e+03                    #> Path [6] :Best Iter: [58] ELBO (-3698.258585) evaluations: (3443)  #> Path [7] :Initial log joint density = -486660.743002  #> Path [7] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      1.375e-02   4.224e-01    1.000e+00  1.000e+00      3149 -3.701e+03 -3.709e+03                    #> Path [7] :Best Iter: [55] ELBO (-3700.674039) evaluations: (3149)  #> Path [8] :Initial log joint density = -481613.729385  #> Path [8] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      9.278e-03   2.976e-01    1.000e+00  1.000e+00      3207 -3.703e+03 -3.710e+03                    #> Path [8] :Best Iter: [55] ELBO (-3703.103574) evaluations: (3207)  #> Path [9] :Initial log joint density = -481379.325218  #> Path [9] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      8.529e-03   2.251e-01    1.000e+00  1.000e+00      2971 -3.706e+03 -3.700e+03                    #> Path [9] :Best Iter: [55] ELBO (-3699.689382) evaluations: (2971)  #> Path [10] :Initial log joint density = -483265.715914  #> Path [10] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      7.937e-03   2.177e-01    4.708e-01  1.000e+00      3222 -3.699e+03 -3.711e+03                    #> Path [10] :Best Iter: [55] ELBO (-3699.239659) evaluations: (3222)  #> Path [11] :Initial log joint density = -481703.986761  #> Path [11] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      8.309e-03   2.440e-01    1.000e+00  1.000e+00      3397 -3.701e+03 -3.704e+03                    #> Path [11] :Best Iter: [57] ELBO (-3700.790994) evaluations: (3397)  #> Path [12] :Initial log joint density = -481419.473390  #> Path [12] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              51      -4.788e+05      5.173e-03   2.747e-01    8.305e-01  8.305e-01      2725 -3.708e+03 -3.721e+03                    #> Path [12] :Best Iter: [46] ELBO (-3708.139005) evaluations: (2725)  #> Path [13] :Initial log joint density = -481446.332676  #> Path [13] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      5.848e-03   2.585e-01    1.000e+00  1.000e+00      2965 -3.707e+03 -3.711e+03                    #> Path [13] :Best Iter: [49] ELBO (-3707.436596) evaluations: (2965)  #> Path [14] :Initial log joint density = -483423.085044  #> Path [14] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      9.786e-03   1.995e-01    1.000e+00  1.000e+00      3332 -3.699e+03 -3.702e+03                    #> Path [14] :Best Iter: [56] ELBO (-3699.003075) evaluations: (3332)  #> Path [15] :Initial log joint density = -481862.504843  #> Path [15] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      4.459e-03   2.746e-01    6.815e-01  6.815e-01      3439 -3.701e+03 -3.714e+03                    #> Path [15] :Best Iter: [57] ELBO (-3700.517591) evaluations: (3439)  #> Path [16] :Initial log joint density = -481708.765653  #> Path [16] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      4.386e-03   2.066e-01    1.000e+00  1.000e+00      2971 -3.710e+03 -3.710e+03                    #> Path [16] :Best Iter: [51] ELBO (-3709.507804) evaluations: (2971)  #> Path [17] :Initial log joint density = -481880.431975  #> Path [17] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      1.492e-02   2.793e-01    1.000e+00  1.000e+00      3290 -3.700e+03 -3.702e+03                    #> Path [17] :Best Iter: [55] ELBO (-3699.962185) evaluations: (3290)  #> Path [18] :Initial log joint density = -481707.095036  #> Path [18] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      6.819e-03   1.722e-01    9.394e-01  9.394e-01      3021 -3.711e+03 -3.725e+03                    #> Path [18] :Best Iter: [43] ELBO (-3710.694627) evaluations: (3021)  #> Path [19] :Initial log joint density = -481823.237548  #> Path [19] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              63      -4.788e+05      9.307e-03   1.858e-01    1.000e+00  1.000e+00      3747 -3.699e+03 -3.699e+03                    #> Path [19] :Best Iter: [60] ELBO (-3698.714421) evaluations: (3747)  #> Path [20] :Initial log joint density = -481747.961449  #> Path [20] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              62      -4.788e+05      1.225e-02   1.763e-01    1.000e+00  1.000e+00      3744 -3.698e+03 -3.698e+03                    #> Path [20] :Best Iter: [59] ELBO (-3697.837811) evaluations: (3744)  #> Path [21] :Initial log joint density = -481727.197861  #> Path [21] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      3.394e-03   2.078e-01    7.674e-01  7.674e-01      2863 -3.709e+03 -3.724e+03                    #> Path [21] :Best Iter: [52] ELBO (-3708.846214) evaluations: (2863)  #> Path [22] :Initial log joint density = -481613.060041  #> Path [22] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      1.112e-02   2.624e-01    1.000e+00  1.000e+00      3375 -3.701e+03 -3.704e+03                    #> Path [22] :Best Iter: [57] ELBO (-3700.872766) evaluations: (3375)  #> Path [23] :Initial log joint density = -482008.349734  #> Path [23] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              64      -4.788e+05      1.251e-02   3.497e-01    1.000e+00  1.000e+00      3844 -3.699e+03 -3.711e+03                    #> Path [23] :Best Iter: [63] ELBO (-3698.613880) evaluations: (3844)  #> Path [24] :Initial log joint density = -482035.623761  #> Path [24] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      5.449e-03   2.160e-01    7.006e-01  7.006e-01      3249 -3.702e+03 -3.720e+03                    #> Path [24] :Best Iter: [55] ELBO (-3702.023401) evaluations: (3249)  #> Path [25] :Initial log joint density = -481681.150638  #> Path [25] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      1.300e-02   4.696e-01    1.000e+00  1.000e+00      2866 -3.706e+03 -3.725e+03                    #> Path [25] :Best Iter: [51] ELBO (-3706.233380) evaluations: (2866)  #> Path [26] :Initial log joint density = -482495.331163  #> Path [26] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      6.409e-03   2.089e-01    1.000e+00  1.000e+00      3662 -3.701e+03 -3.708e+03                    #> Path [26] :Best Iter: [57] ELBO (-3700.871267) evaluations: (3662)  #> Path [27] :Initial log joint density = -481997.545751  #> Path [27] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      8.556e-03   2.096e-01    8.969e-01  8.969e-01      3478 -3.696e+03 -3.710e+03                    #> Path [27] :Best Iter: [59] ELBO (-3695.983125) evaluations: (3478)  #> Path [28] :Initial log joint density = -481511.496566  #> Path [28] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      1.347e-02   1.836e-01    1.000e+00  1.000e+00      3203 -3.700e+03 -3.703e+03                    #> Path [28] :Best Iter: [56] ELBO (-3699.592340) evaluations: (3203)  #> Path [29] :Initial log joint density = -484682.698319  #> Path [29] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              62      -4.788e+05      3.111e-03   2.472e-01    6.568e-01  6.568e-01      3678 -3.703e+03 -3.714e+03                    #> Path [29] :Best Iter: [61] ELBO (-3703.344670) evaluations: (3678)  #> Path [30] :Initial log joint density = -481822.271280  #> Path [30] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      2.941e-03   1.551e-01    7.803e-01  7.803e-01      3076 -3.709e+03 -3.725e+03                    #> Path [30] :Best Iter: [45] ELBO (-3708.766086) evaluations: (3076)  #> Path [31] :Initial log joint density = -481615.799590  #> Path [31] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      1.635e-02   2.864e-01    1.000e+00  1.000e+00      3328 -3.698e+03 -3.702e+03                    #> Path [31] :Best Iter: [56] ELBO (-3697.516012) evaluations: (3328)  #> Path [32] :Initial log joint density = -481551.276677  #> Path [32] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      4.575e-03   1.690e-01    1.000e+00  1.000e+00      3082 -3.707e+03 -3.709e+03                    #> Path [32] :Best Iter: [52] ELBO (-3706.872637) evaluations: (3082)  #> Path [33] :Initial log joint density = -481745.865107  #> Path [33] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      1.007e-02   2.185e-01    1.000e+00  1.000e+00      3273 -3.706e+03 -3.701e+03                    #> Path [33] :Best Iter: [56] ELBO (-3700.698378) evaluations: (3273)  #> Path [34] :Initial log joint density = -482402.517522  #> Path [34] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      5.676e-03   1.881e-01    1.000e+00  1.000e+00      3417 -3.699e+03 -3.708e+03                    #> Path [34] :Best Iter: [55] ELBO (-3698.835785) evaluations: (3417)  #> Path [35] :Initial log joint density = -481406.249447  #> Path [35] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      1.173e-02   1.823e-01    1.000e+00  1.000e+00      3295 -3.701e+03 -3.699e+03                    #> Path [35] :Best Iter: [57] ELBO (-3699.266704) evaluations: (3295)  #> Path [36] :Initial log joint density = -481680.013285  #> Path [36] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      1.120e-02   1.973e-01    1.000e+00  1.000e+00      3192 -3.705e+03 -3.699e+03                    #> Path [36] :Best Iter: [57] ELBO (-3699.482462) evaluations: (3192)  #> Path [37] :Initial log joint density = -481922.925608  #> Path [37] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      7.553e-03   2.397e-01    1.000e+00  1.000e+00      3047 -3.709e+03 -3.701e+03                    #> Path [37] :Best Iter: [55] ELBO (-3701.486226) evaluations: (3047)  #> Path [38] :Initial log joint density = -481928.748559  #> Path [38] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      5.492e-03   2.525e-01    8.607e-01  8.607e-01      3478 -3.702e+03 -3.711e+03                    #> Path [38] :Best Iter: [59] ELBO (-3702.215112) evaluations: (3478)  #> Path [39] :Initial log joint density = -484068.486920  #> Path [39] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.144e-02   2.160e-01    1.000e+00  1.000e+00      3506 -3.703e+03 -3.711e+03                    #> Path [39] :Best Iter: [58] ELBO (-3703.287172) evaluations: (3506)  #> Path [40] :Initial log joint density = -481584.754644  #> Path [40] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      6.054e-03   1.823e-01    1.000e+00  1.000e+00      3347 -3.707e+03 -3.705e+03                    #> Path [40] :Best Iter: [57] ELBO (-3704.836455) evaluations: (3347)  #> Path [41] :Initial log joint density = -487494.357628  #> Path [41] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      7.450e-03   2.454e-01    1.000e+00  1.000e+00      3451 -3.706e+03 -3.710e+03                    #> Path [41] :Best Iter: [56] ELBO (-3705.647378) evaluations: (3451)  #> Path [42] :Initial log joint density = -481886.876588  #> Path [42] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      9.005e-03   2.476e-01    1.000e+00  1.000e+00      3479 -3.700e+03 -3.700e+03                    #> Path [42] :Best Iter: [60] ELBO (-3699.532545) evaluations: (3479)  #> Path [43] :Initial log joint density = -481884.123088  #> Path [43] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      1.127e-02   2.778e-01    9.313e-01  9.313e-01      3035 -3.710e+03 -3.722e+03                    #> Path [43] :Best Iter: [45] ELBO (-3710.131764) evaluations: (3035)  #> Path [44] :Initial log joint density = -481532.821379  #> Path [44] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      2.299e-02   3.690e-01    1.000e+00  1.000e+00      3508 -3.697e+03 -3.701e+03                    #> Path [44] :Best Iter: [59] ELBO (-3697.250301) evaluations: (3508)  #> Path [45] :Initial log joint density = -481533.493056  #> Path [45] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      6.082e-03   1.654e-01    1.000e+00  1.000e+00      3005 -3.711e+03 -3.711e+03                    #> Path [45] :Best Iter: [51] ELBO (-3711.287981) evaluations: (3005)  #> Path [46] :Initial log joint density = -481592.864295  #> Path [46] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              49      -4.788e+05      7.482e-03   2.559e-01    1.000e+00  1.000e+00      2581 -3.709e+03 -3.720e+03                    #> Path [46] :Best Iter: [48] ELBO (-3709.130132) evaluations: (2581)  #> Path [47] :Initial log joint density = -481333.357196  #> Path [47] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      1.182e-02   2.434e-01    1.000e+00  1.000e+00      3102 -3.704e+03 -3.706e+03                    #> Path [47] :Best Iter: [55] ELBO (-3703.622163) evaluations: (3102)  #> Path [48] :Initial log joint density = -481622.406052  #> Path [48] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      4.310e-03   2.465e-01    6.974e-01  6.974e-01      3579 -3.700e+03 -3.711e+03                    #> Path [48] :Best Iter: [59] ELBO (-3699.964106) evaluations: (3579)  #> Path [49] :Initial log joint density = -481593.618794  #> Path [49] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      4.957e-03   2.009e-01    1.000e+00  1.000e+00      2994 -3.709e+03 -3.713e+03                    #> Path [49] :Best Iter: [45] ELBO (-3708.871498) evaluations: (2994)  #> Path [50] :Initial log joint density = -481928.421695  #> Path [50] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      1.417e-02   4.070e-01    1.000e+00  1.000e+00      3026 -3.709e+03 -3.706e+03                    #> Path [50] :Best Iter: [55] ELBO (-3706.044293) evaluations: (3026)  #> Finished in  14.1 seconds. #> sccomp says: to do hypothesis testing run `sccomp_test()`, #>   the `test_composition_above_logit_fold_change` = 0.1 equates to a change of ~10%, and #>   0.7 equates to ~100% increase, if the baseline is ~0.1 proportion. #>   Use `sccomp_proportional_fold_change` to convert c_effect (linear) to proportion difference (non-linear). #> Loading model from cache... #> Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... #>  #> Chain 1 finished in 0.0 seconds. #> # A tibble: 720 × 6 #>    sample type   cell_group proportion_mean proportion_lower proportion_upper #>    <fct>  <fct>  <chr>                <dbl>            <dbl>            <dbl> #>  1 10x_6K benign B1                 0.0587           0.0461           0.0720  #>  2 10x_6K benign B2                 0.0376           0.0291           0.0469  #>  3 10x_6K benign B3                 0.0127           0.00962          0.0160  #>  4 10x_6K benign BM                 0.00674          0.00512          0.00859 #>  5 10x_6K benign CD4 1              0.0254           0.0215           0.0297  #>  6 10x_6K benign CD4 2              0.0509           0.0426           0.0608  #>  7 10x_6K benign CD4 3              0.0825           0.0631           0.103   #>  8 10x_6K benign CD4 4              0.00171          0.00111          0.00242 #>  9 10x_6K benign CD4 5              0.0304           0.0237           0.0373  #> 10 10x_6K benign CD8 1              0.111            0.0949           0.129   #> # ℹ 710 more rows # }"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_proportional_fold_change.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Proportional Fold Change from sccomp Estimated Effects — sccomp_proportional_fold_change","title":"Calculate Proportional Fold Change from sccomp Estimated Effects — sccomp_proportional_fold_change","text":"function calculates proportional fold change two conditions using estimated effects sccomp model. fold changes derived model's posterior predictions rather raw counts, providing robust estimate accounts model's uncertainty covariate effects. Note! statistic descriptive used define significance - use sccomp_test() . fold changes proportions easier interpret changes logit space, linear (proportional change different meaning rare vs abundant cell types). contrast, logit scale used internally sccomp provides linear effects appropriate statistical inference.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_proportional_fold_change.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Proportional Fold Change from sccomp Estimated Effects — sccomp_proportional_fold_change","text":"","code":"sccomp_proportional_fold_change(.data, formula_composition, from, to)"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_proportional_fold_change.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Proportional Fold Change from sccomp Estimated Effects — sccomp_proportional_fold_change","text":".data sccomp estimate object (class 'sccomp_tbl') obtained running sccomp_estimate(). object contains fitted model estimated effects. formula_composition formula specifying model effects use calculating fold changes. match subset formula used original sccomp_estimate() call. Character string specifying reference/control condition (e.g., \"benign\"). Character string specifying comparison condition (e.g., \"cancer\").","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_proportional_fold_change.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Proportional Fold Change from sccomp Estimated Effects — sccomp_proportional_fold_change","text":"tibble following columns: cell_group - cell group identifier proportion_fold_change - estimated fold change proportions conditions. Positive values indicate increases, negative values indicate decreases. average_uncertainty - average uncertainty fold change estimate, derived credible intervals statement - text description fold change, including direction estimated proportions","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_proportional_fold_change.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Proportional Fold Change from sccomp Estimated Effects — sccomp_proportional_fold_change","text":"","code":"print(\"cmdstanr is needed to run this example.\") #> [1] \"cmdstanr is needed to run this example.\" # Note: Before running the example, ensure that the 'cmdstanr' package is installed: # install.packages(\"cmdstanr\", repos = c(\"https://stan-dev.r-universe.dev/\", getOption(\"repos\")))   # \\donttest{ if (instantiate::stan_cmdstan_exists()) {   # Load example data   data(\"counts_obj\")    # First estimate the composition effects   estimate <- sccomp_estimate(       counts_obj,       ~ type,       ~1,       \"sample\",       \"cell_group\",       \"count\",       cores = 1   )     # Calculate proportional fold changes from the estimated effects   estimate |>    sccomp_proportional_fold_change(     formula_composition = ~  type,      from = \"benign\",      to = \"cancer\"   )  } #> sccomp says: count column is an integer. The sum-constrained beta binomial model will be used #> sccomp says: estimation #> sccomp says: the composition design matrix has columns: (Intercept), typecancer #> sccomp says: the variability design matrix has columns: (Intercept) #> Loading model from cache... #> Path [1] :Initial log joint density = -481914.254441  #> Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      1.344e-02   2.298e-01    1.000e+00  1.000e+00      3482 -3.699e+03 -3.699e+03                    #> Path [1] :Best Iter: [59] ELBO (-3698.630534) evaluations: (3482)  #> Path [2] :Initial log joint density = -481818.586658  #> Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              63      -4.788e+05      1.260e-02   3.344e-01    1.000e+00  1.000e+00      3757 -3.700e+03 -3.704e+03                    #> Path [2] :Best Iter: [62] ELBO (-3700.255395) evaluations: (3757)  #> Path [3] :Initial log joint density = -481765.536808  #> Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      7.149e-03   2.278e-01    1.000e+00  1.000e+00      2871 -3.707e+03 -3.716e+03                    #> Path [3] :Best Iter: [50] ELBO (-3706.618768) evaluations: (2871)  #> Path [4] :Initial log joint density = -481876.510291  #> Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              62      -4.788e+05      7.221e-03   2.516e-01    7.698e-01  7.698e-01      3655 -3.701e+03 -3.713e+03                    #> Path [4] :Best Iter: [56] ELBO (-3701.045034) evaluations: (3655)  #> Path [5] :Initial log joint density = -481627.121563  #> Path [5] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      5.092e-03   2.148e-01    1.000e+00  1.000e+00      3253 -3.707e+03 -3.707e+03                    #> Path [5] :Best Iter: [56] ELBO (-3706.865309) evaluations: (3253)  #> Path [6] :Initial log joint density = -481706.097935  #> Path [6] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.296e-02   3.193e-01    1.000e+00  1.000e+00      3424 -3.700e+03 -3.710e+03                    #> Path [6] :Best Iter: [58] ELBO (-3700.091095) evaluations: (3424)  #> Path [7] :Initial log joint density = -481637.581738  #> Path [7] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      4.606e-03   2.053e-01    9.947e-01  9.947e-01      3033 -3.706e+03 -3.706e+03                    #> Path [7] :Best Iter: [55] ELBO (-3705.897658) evaluations: (3033)  #> Path [8] :Initial log joint density = -481710.239087  #> Path [8] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      1.233e-02   3.274e-01    1.000e+00  1.000e+00      3300 -3.700e+03 -3.706e+03                    #> Path [8] :Best Iter: [56] ELBO (-3699.600965) evaluations: (3300)  #> Path [9] :Initial log joint density = -482129.725456  #> Path [9] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      3.592e-03   2.459e-01    7.563e-01  7.563e-01      3498 -3.697e+03 -3.716e+03                    #> Path [9] :Best Iter: [57] ELBO (-3697.322375) evaluations: (3498)  #> Path [10] :Initial log joint density = -481486.271671  #> Path [10] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      1.421e-02   2.878e-01    8.221e-01  8.221e-01      2917 -3.705e+03 -3.719e+03                    #> Path [10] :Best Iter: [43] ELBO (-3705.113627) evaluations: (2917)  #> Path [11] :Initial log joint density = -481642.924797  #> Path [11] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      4.838e-03   2.438e-01    1.000e+00  1.000e+00      2829 -3.705e+03 -3.718e+03                    #> Path [11] :Best Iter: [44] ELBO (-3704.779052) evaluations: (2829)  #> Path [12] :Initial log joint density = -481384.333874  #> Path [12] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      4.927e-03   2.350e-01    7.933e-01  7.933e-01      2971 -3.707e+03 -3.709e+03                    #> Path [12] :Best Iter: [42] ELBO (-3707.102648) evaluations: (2971)  #> Path [13] :Initial log joint density = -481612.584775  #> Path [13] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      6.533e-03   2.284e-01    1.000e+00  1.000e+00      3126 -3.709e+03 -3.705e+03                    #> Path [13] :Best Iter: [55] ELBO (-3704.726354) evaluations: (3126)  #> Path [14] :Initial log joint density = -481478.396531  #> Path [14] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      8.919e-03   1.968e-01    1.000e+00  1.000e+00      3086 -3.708e+03 -3.708e+03                    #> Path [14] :Best Iter: [55] ELBO (-3707.674444) evaluations: (3086)  #> Path [15] :Initial log joint density = -481466.598342  #> Path [15] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      1.125e-02   1.953e-01    1.000e+00  1.000e+00      2985 -3.708e+03 -3.706e+03                    #> Path [15] :Best Iter: [53] ELBO (-3706.092157) evaluations: (2985)  #> Path [16] :Initial log joint density = -482113.566318  #> Path [16] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.020e-02   2.547e-01    1.000e+00  1.000e+00      3414 -3.700e+03 -3.708e+03                    #> Path [16] :Best Iter: [55] ELBO (-3700.092143) evaluations: (3414)  #> Path [17] :Initial log joint density = -482596.193615  #> Path [17] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              64      -4.788e+05      1.224e-02   3.849e-01    1.000e+00  1.000e+00      3808 -3.701e+03 -3.704e+03                    #> Path [17] :Best Iter: [63] ELBO (-3701.232497) evaluations: (3808)  #> Path [18] :Initial log joint density = -481590.640570  #> Path [18] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              62      -4.788e+05      1.901e-02   3.175e-01    1.000e+00  1.000e+00      3624 -3.703e+03 -3.709e+03                    #> Path [18] :Best Iter: [57] ELBO (-3703.015069) evaluations: (3624)  #> Path [19] :Initial log joint density = -481700.531952  #> Path [19] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      1.454e-02   2.026e-01    1.000e+00  1.000e+00      3444 -3.698e+03 -3.698e+03                    #> Path [19] :Best Iter: [58] ELBO (-3697.739017) evaluations: (3444)  #> Path [20] :Initial log joint density = -481723.215826  #> Path [20] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      5.410e-03   1.960e-01    8.769e-01  8.769e-01      3330 -3.702e+03 -3.709e+03                    #> Path [20] :Best Iter: [57] ELBO (-3701.621845) evaluations: (3330)  #> Path [21] :Initial log joint density = -481343.770810  #> Path [21] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      7.267e-03   1.748e-01    1.000e+00  1.000e+00      2989 -3.706e+03 -3.712e+03                    #> Path [21] :Best Iter: [45] ELBO (-3706.230721) evaluations: (2989)  #> Path [22] :Initial log joint density = -481442.615271  #> Path [22] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      5.775e-03   2.301e-01    1.000e+00  1.000e+00      3148 -3.704e+03 -3.704e+03                    #> Path [22] :Best Iter: [57] ELBO (-3703.518289) evaluations: (3148)  #> Path [23] :Initial log joint density = -481451.035027  #> Path [23] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              51      -4.788e+05      1.177e-02   4.659e-01    1.000e+00  1.000e+00      2758 -3.703e+03 -3.716e+03                    #> Path [23] :Best Iter: [49] ELBO (-3703.455689) evaluations: (2758)  #> Path [24] :Initial log joint density = -481500.394152  #> Path [24] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      3.958e-03   2.010e-01    2.809e-01  1.000e+00      3043 -3.708e+03 -3.722e+03                    #> Path [24] :Best Iter: [42] ELBO (-3708.245358) evaluations: (3043)  #> Path [25] :Initial log joint density = -481281.261877  #> Path [25] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      5.369e-03   2.311e-01    1.000e+00  1.000e+00      2863 -3.707e+03 -3.714e+03                    #> Path [25] :Best Iter: [49] ELBO (-3707.312498) evaluations: (2863)  #> Path [26] :Initial log joint density = -481543.411051  #> Path [26] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      1.570e-02   3.821e-01    9.827e-01  9.827e-01      3026 -3.709e+03 -3.725e+03                    #> Path [26] :Best Iter: [52] ELBO (-3709.385014) evaluations: (3026)  #> Path [27] :Initial log joint density = -483718.641252  #> Path [27] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      1.125e-02   3.207e-01    1.000e+00  1.000e+00      3122 -3.702e+03 -3.706e+03                    #> Path [27] :Best Iter: [55] ELBO (-3701.568425) evaluations: (3122)  #> Path [28] :Initial log joint density = -481814.356931  #> Path [28] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      7.203e-03   2.412e-01    1.000e+00  1.000e+00      3100 -3.705e+03 -3.707e+03                    #> Path [28] :Best Iter: [52] ELBO (-3704.926026) evaluations: (3100)  #> Path [29] :Initial log joint density = -481623.938103  #> Path [29] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      7.789e-03   2.186e-01    1.000e+00  1.000e+00      3092 -3.709e+03 -3.704e+03                    #> Path [29] :Best Iter: [55] ELBO (-3703.645047) evaluations: (3092)  #> Path [30] :Initial log joint density = -483701.346680  #> Path [30] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      7.184e-03   1.939e-01    1.000e+00  1.000e+00      3112 -3.707e+03 -3.702e+03                    #> Path [30] :Best Iter: [55] ELBO (-3701.611034) evaluations: (3112)  #> Path [31] :Initial log joint density = -481617.480201  #> Path [31] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      5.622e-03   2.388e-01    1.000e+00  1.000e+00      3235 -3.706e+03 -3.702e+03                    #> Path [31] :Best Iter: [57] ELBO (-3702.439474) evaluations: (3235)  #> Path [32] :Initial log joint density = -481172.912101  #> Path [32] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      8.946e-03   2.309e-01    1.000e+00  1.000e+00      2911 -3.707e+03 -3.709e+03                    #> Path [32] :Best Iter: [49] ELBO (-3707.479718) evaluations: (2911)  #> Path [33] :Initial log joint density = -481566.371381  #> Path [33] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      3.745e-03   1.669e-01    8.217e-01  8.217e-01      2966 -3.708e+03 -3.721e+03                    #> Path [33] :Best Iter: [41] ELBO (-3707.916646) evaluations: (2966)  #> Path [34] :Initial log joint density = -481553.819334  #> Path [34] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      8.936e-03   2.420e-01    9.085e-01  9.085e-01      2863 -3.707e+03 -3.718e+03                    #> Path [34] :Best Iter: [46] ELBO (-3707.413107) evaluations: (2863)  #> Path [35] :Initial log joint density = -481770.814883  #> Path [35] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      9.410e-03   2.219e-01    8.703e-01  8.703e-01      2863 -3.709e+03 -3.721e+03                    #> Path [35] :Best Iter: [37] ELBO (-3708.586423) evaluations: (2863)  #> Path [36] :Initial log joint density = -482082.557371  #> Path [36] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.281e-02   3.331e-01    1.000e+00  1.000e+00      3409 -3.701e+03 -3.705e+03                    #> Path [36] :Best Iter: [55] ELBO (-3701.427288) evaluations: (3409)  #> Path [37] :Initial log joint density = -481838.593237  #> Path [37] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      1.148e-02   3.537e-01    1.000e+00  1.000e+00      3074 -3.706e+03 -3.716e+03                    #> Path [37] :Best Iter: [49] ELBO (-3706.063398) evaluations: (3074)  #> Path [38] :Initial log joint density = -481490.145935  #> Path [38] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      3.793e-03   2.896e-01    6.487e-01  6.487e-01      2961 -3.707e+03 -3.712e+03                    #> Path [38] :Best Iter: [51] ELBO (-3706.623309) evaluations: (2961)  #> Path [39] :Initial log joint density = -481821.751824  #> Path [39] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      3.172e-03   3.097e-01    6.432e-01  6.432e-01      3405 -3.700e+03 -3.711e+03                    #> Path [39] :Best Iter: [57] ELBO (-3700.216004) evaluations: (3405)  #> Path [40] :Initial log joint density = -481692.994182  #> Path [40] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      4.107e-03   1.525e-01    1.000e+00  1.000e+00      2957 -3.709e+03 -3.719e+03                    #> Path [40] :Best Iter: [41] ELBO (-3708.777497) evaluations: (2957)  #> Path [41] :Initial log joint density = -481929.216371  #> Path [41] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      8.835e-03   1.593e-01    1.000e+00  1.000e+00      3541 -3.700e+03 -3.703e+03                    #> Path [41] :Best Iter: [58] ELBO (-3700.321096) evaluations: (3541)  #> Path [42] :Initial log joint density = -481299.443730  #> Path [42] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      9.371e-03   2.402e-01    1.000e+00  1.000e+00      3261 -3.699e+03 -3.702e+03                    #> Path [42] :Best Iter: [57] ELBO (-3699.077056) evaluations: (3261)  #> Path [43] :Initial log joint density = -481764.461205  #> Path [43] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      3.977e-03   2.180e-01    8.589e-01  8.589e-01      2879 -3.705e+03 -3.718e+03                    #> Path [43] :Best Iter: [50] ELBO (-3705.088919) evaluations: (2879)  #> Path [44] :Initial log joint density = -482119.354569  #> Path [44] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      2.299e-03   2.250e-01    6.226e-01  6.226e-01      3415 -3.699e+03 -3.710e+03                    #> Path [44] :Best Iter: [57] ELBO (-3698.509230) evaluations: (3415)  #> Path [45] :Initial log joint density = -481710.707689  #> Path [45] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              51      -4.788e+05      1.536e-02   3.680e-01    1.000e+00  1.000e+00      2802 -3.709e+03 -3.715e+03                    #> Path [45] :Best Iter: [46] ELBO (-3709.048476) evaluations: (2802)  #> Path [46] :Initial log joint density = -481592.748758  #> Path [46] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      4.756e-03   2.438e-01    7.818e-01  7.818e-01      3338 -3.702e+03 -3.711e+03                    #> Path [46] :Best Iter: [57] ELBO (-3701.896142) evaluations: (3338)  #> Path [47] :Initial log joint density = -481589.875077  #> Path [47] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      6.214e-03   2.134e-01    1.000e+00  1.000e+00      2993 -3.708e+03 -3.713e+03                    #> Path [47] :Best Iter: [43] ELBO (-3707.609880) evaluations: (2993)  #> Path [48] :Initial log joint density = -481573.131542  #> Path [48] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      1.184e-02   2.650e-01    1.000e+00  1.000e+00      3213 -3.701e+03 -3.701e+03                    #> Path [48] :Best Iter: [56] ELBO (-3701.204024) evaluations: (3213)  #> Path [49] :Initial log joint density = -481910.635912  #> Path [49] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      1.193e-02   3.140e-01    1.000e+00  1.000e+00      3192 -3.706e+03 -3.714e+03                    #> Path [49] :Best Iter: [55] ELBO (-3705.598498) evaluations: (3192)  #> Path [50] :Initial log joint density = -481824.294116  #> Path [50] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      4.722e-03   1.632e-01    1.000e+00  1.000e+00      3188 -3.708e+03 -3.705e+03                    #> Path [50] :Best Iter: [57] ELBO (-3705.453666) evaluations: (3188)  #> Finished in  13.3 seconds. #> sccomp says: to do hypothesis testing run `sccomp_test()`, #>   the `test_composition_above_logit_fold_change` = 0.1 equates to a change of ~10%, and #>   0.7 equates to ~100% increase, if the baseline is ~0.1 proportion. #>   Use `sccomp_proportional_fold_change` to convert c_effect (linear) to proportion difference (non-linear). #> Loading model from cache... #> Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... #>  #> Chain 1 finished in 0.0 seconds. #> # A tibble: 36 × 4 #>    cell_group proportion_fold_change average_uncertainty statement               #>    <chr>                       <dbl>               <dbl> <glue>                  #>  1 B1                          -1.93             0.199   1.9-fold decrease (fro… #>  2 B2                          -2.04             0.243   2-fold decrease (from … #>  3 B3                          -1.38             0.126   1.4-fold decrease (fro… #>  4 BM                          -1.39             0.178   1.4-fold decrease (fro… #>  5 CD4 1                        1.16             0.00381 1.2-fold increase (fro… #>  6 CD4 2                        1.44             0.0627  1.4-fold increase (fro… #>  7 CD4 3                       -2.34             0.349   2.3-fold decrease (fro… #>  8 CD4 4                       -1.06             0.0930  1.1-fold decrease (fro… #>  9 CD4 5                        1.02             0.122   1-fold increase (from … #> 10 CD8 1                        1.10             0.0330  1.1-fold increase (fro… #> # ℹ 26 more rows # }"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_remove_outliers.html","id":null,"dir":"Reference","previous_headings":"","what":"sccomp_remove_outliers main — sccomp_remove_outliers","title":"sccomp_remove_outliers main — sccomp_remove_outliers","text":"sccomp_remove_outliers function takes input table cell counts columns cell-group identifier, sample identifier, integer count, factors (continuous discrete). user can define linear model using input R formula, first factor factor interest. Alternatively, sccomp accepts single-cell data containers (e.g., Seurat, SingleCellExperiment, cell metadata, group-size) derives count data cell metadata.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_remove_outliers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"sccomp_remove_outliers main — sccomp_remove_outliers","text":"","code":"sccomp_remove_outliers(   .estimate,   percent_false_positive = 5,   cores = detectCores(),   inference_method = attr(.estimate, \"inference_method\"),   output_directory = \"sccomp_draws_files\",   verbose = TRUE,   mcmc_seed = sample_seed(),   max_sampling_iterations = 20000,   enable_loo = FALSE,   sig_figs = 9,   cache_stan_model = sccomp_stan_models_cache_dir,   approximate_posterior_inference = NULL,   variational_inference = NULL,   ... )"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_remove_outliers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"sccomp_remove_outliers main — sccomp_remove_outliers","text":".estimate tibble including cell_group name column, sample name column, read counts column (optional depending input class), factor columns. percent_false_positive real number 0 100 (inclusive), used identify outliers specific false positive rate. cores Integer, number cores used parallel calculations. inference_method Character string specifying inference method use ('pathfinder', 'hmc', 'variational'). output_directory character string specifying output directory Stan draws. verbose Logical, whether print progression details. mcmc_seed Integer, used Markov-chain Monte Carlo reproducibility. default, random number sampled 1 999999. max_sampling_iterations Integer, limits maximum number iterations case large dataset used, limit computation time. enable_loo Logical, whether enable model comparison using R package LOO. useful comparing fits models, similar ANOVA. sig_figs Number significant figures use Stan model output. Default 9. cache_stan_model character string specifying cache directory compiled Stan models. sccomp version automatically appended ensure version isolation. Default sccomp_stan_models_cache_dir points ~/.sccomp_models. approximate_posterior_inference DEPRECATED, use variational_inference argument. variational_inference DEPRECATED Logical, whether use variational Bayes posterior inference. faster convenient. Setting argument FALSE runs full Bayesian (Hamiltonian Monte Carlo) inference, slower gold standard. ... Additional arguments passed cmdstanr::sample function.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_remove_outliers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"sccomp_remove_outliers main — sccomp_remove_outliers","text":"tibble (tbl), following columns: cell_group - cell groups tested. parameter - parameter estimated design matrix described input formula_composition formula_variability. factor - covariate factor formula, applicable (e.g., present Intercept contrasts). c_lower - Lower (2.5%) quantile posterior distribution composition (c) parameter. c_effect - Mean posterior distribution composition (c) parameter. c_upper - Upper (97.5%) quantile posterior distribution composition (c) parameter. c_pH0 - Probability c_effect smaller bigger test_composition_above_logit_fold_change argument. c_FDR - False discovery rate c_effect smaller bigger test_composition_above_logit_fold_change argument. False discovery rate Bayesian models calculated differently frequentists models, detailed Mangiola et al, PNAS 2023. c_n_eff - Effective sample size, number independent draws sample. higher, better. c_R_k_hat - R statistic, measure chain equilibrium, within 0.05 1.0. v_lower - Lower (2.5%) quantile posterior distribution variability (v) parameter. v_effect - Mean posterior distribution variability (v) parameter. v_upper - Upper (97.5%) quantile posterior distribution variability (v) parameter. v_pH0 - Probability v_effect smaller bigger test_composition_above_logit_fold_change argument. v_FDR - False discovery rate v_effect smaller bigger test_composition_above_logit_fold_change argument. False discovery rate Bayesian models calculated differently frequentists models, detailed Mangiola et al, PNAS 2023. v_n_eff - Effective sample size variability (v) parameter. v_R_k_hat - R statistic variability (v) parameter, measure chain equilibrium. function also attaches several attributes result: count_data - original count data used analysis, stored attribute efficient access. model_input - model input data used fitting. formula_composition - formula used composition modeling. formula_variability - formula used variability modeling. fit - Stan fit object (pass_fit = TRUE).","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_remove_outliers.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"sccomp_remove_outliers main — sccomp_remove_outliers","text":"S. Mangiola, .J. Roth-Schulze, M. Trussart, E. Zozaya-Valdés, M. Ma, Z. Gao, .F. Rubin, T.P. Speed, H. Shim, & .T. Papenfuss, sccomp: Robust differential composition variability analysis single-cell data, Proc. Natl. Acad. Sci. U.S.. 120 (33) e2203828120, https://doi.org/10.1073/pnas.2203828120 (2023).","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_remove_outliers.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"sccomp_remove_outliers main — sccomp_remove_outliers","text":"","code":"print(\"cmdstanr is needed to run this example.\") #> [1] \"cmdstanr is needed to run this example.\" # Note: Before running the example, ensure that the 'cmdstanr' package is installed: # install.packages(\"cmdstanr\", repos = c(\"https://stan-dev.r-universe.dev/\", getOption(\"repos\")))  # \\donttest{   if (instantiate::stan_cmdstan_exists()) {     data(\"counts_obj\")          estimate = sccomp_estimate(       counts_obj,       ~ type,       ~1,       \"sample\",       \"cell_group\",       \"count\",       cores = 1     ) |>     sccomp_remove_outliers(cores = 1)   } #> sccomp says: count column is an integer. The sum-constrained beta binomial model will be used #> sccomp says: estimation #> sccomp says: the composition design matrix has columns: (Intercept), typecancer #> sccomp says: the variability design matrix has columns: (Intercept) #> Loading model from cache... #> Path [1] :Initial log joint density = -481896.467352  #> Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      2.512e-03   2.101e-01    6.694e-01  6.694e-01      3450 -3.697e+03 -3.715e+03                    #> Path [1] :Best Iter: [57] ELBO (-3696.807202) evaluations: (3450)  #> Path [2] :Initial log joint density = -484083.970253  #> Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      6.071e-03   2.271e-01    8.427e-01  8.427e-01      3238 -3.704e+03 -3.711e+03                    #> Path [2] :Best Iter: [56] ELBO (-3703.553334) evaluations: (3238)  #> Path [3] :Initial log joint density = -481222.846308  #> Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      1.581e-02   2.352e-01    1.000e+00  1.000e+00      2964 -3.708e+03 -3.709e+03                    #> Path [3] :Best Iter: [43] ELBO (-3708.289445) evaluations: (2964)  #> Path [4] :Initial log joint density = -481773.234958  #> Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      1.375e-02   2.651e-01    9.089e-01  9.089e-01      3000 -3.709e+03 -3.724e+03                    #> Path [4] :Best Iter: [53] ELBO (-3709.305253) evaluations: (3000)  #> Path [5] :Initial log joint density = -482892.999399  #> Path [5] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      6.617e-03   2.319e-01    1.000e+00  1.000e+00      3236 -3.706e+03 -3.703e+03                    #> Path [5] :Best Iter: [57] ELBO (-3702.996901) evaluations: (3236)  #> Path [6] :Initial log joint density = -483558.228932  #> Path [6] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      4.555e-03   2.101e-01    8.697e-01  8.697e-01      3051 -3.706e+03 -3.721e+03                    #> Path [6] :Best Iter: [52] ELBO (-3706.340078) evaluations: (3051)  #> Path [7] :Initial log joint density = -481303.869532  #> Path [7] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      5.165e-03   1.924e-01    1.000e+00  1.000e+00      3267 -3.706e+03 -3.710e+03                    #> Path [7] :Best Iter: [55] ELBO (-3705.578834) evaluations: (3267)  #> Path [8] :Initial log joint density = -481686.263276  #> Path [8] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      9.789e-03   2.467e-01    1.000e+00  1.000e+00      3568 -3.701e+03 -3.705e+03                    #> Path [8] :Best Iter: [60] ELBO (-3701.034949) evaluations: (3568)  #> Path [9] :Initial log joint density = -482383.940764  #> Path [9] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      7.125e-03   2.594e-01    4.480e-01  1.000e+00      3382 -3.698e+03 -3.711e+03                    #> Path [9] :Best Iter: [57] ELBO (-3698.114163) evaluations: (3382)  #> Path [10] :Initial log joint density = -481635.627523  #> Path [10] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      7.280e-03   2.332e-01    1.000e+00  1.000e+00      3026 -3.708e+03 -3.702e+03                    #> Path [10] :Best Iter: [55] ELBO (-3702.392418) evaluations: (3026)  #> Path [11] :Initial log joint density = -481908.651841  #> Path [11] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              62      -4.788e+05      3.559e-03   2.659e-01    6.441e-01  6.441e-01      3692 -3.699e+03 -3.711e+03                    #> Path [11] :Best Iter: [60] ELBO (-3698.670819) evaluations: (3692)  #> Path [12] :Initial log joint density = -481778.442824  #> Path [12] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      7.360e-03   2.485e-01    1.000e+00  1.000e+00      3176 -3.705e+03 -3.705e+03                    #> Path [12] :Best Iter: [55] ELBO (-3704.517522) evaluations: (3176)  #> Path [13] :Initial log joint density = -481786.031954  #> Path [13] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      9.793e-03   2.057e-01    1.000e+00  1.000e+00      3212 -3.702e+03 -3.703e+03                    #> Path [13] :Best Iter: [55] ELBO (-3702.209203) evaluations: (3212)  #> Path [14] :Initial log joint density = -481524.166240  #> Path [14] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      6.523e-03   2.533e-01    1.000e+00  1.000e+00      2827 -3.709e+03 -3.715e+03                    #> Path [14] :Best Iter: [48] ELBO (-3708.587090) evaluations: (2827)  #> Path [15] :Initial log joint density = -484566.555895  #> Path [15] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      5.244e-03   2.183e-01    1.000e+00  1.000e+00      3179 -3.701e+03 -3.700e+03                    #> Path [15] :Best Iter: [57] ELBO (-3700.362695) evaluations: (3179)  #> Path [16] :Initial log joint density = -481699.345883  #> Path [16] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      5.834e-03   2.240e-01    6.887e-01  6.887e-01      2881 -3.708e+03 -3.720e+03                    #> Path [16] :Best Iter: [51] ELBO (-3707.595965) evaluations: (2881)  #> Path [17] :Initial log joint density = -481923.630681  #> Path [17] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      2.858e-03   2.180e-01    7.100e-01  7.100e-01      3126 -3.709e+03 -3.717e+03                    #> Path [17] :Best Iter: [48] ELBO (-3709.464405) evaluations: (3126)  #> Path [18] :Initial log joint density = -481637.811270  #> Path [18] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      1.806e-02   2.750e-01    1.000e+00  1.000e+00      3329 -3.701e+03 -3.700e+03                    #> Path [18] :Best Iter: [58] ELBO (-3699.721646) evaluations: (3329)  #> Path [19] :Initial log joint density = -481573.644062  #> Path [19] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      1.350e-02   4.022e-01    1.000e+00  1.000e+00      3147 -3.712e+03 -3.705e+03                    #> Path [19] :Best Iter: [55] ELBO (-3705.105296) evaluations: (3147)  #> Path [20] :Initial log joint density = -481272.771647  #> Path [20] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      4.241e-03   1.373e-01    1.000e+00  1.000e+00      3305 -3.699e+03 -3.712e+03                    #> Path [20] :Best Iter: [55] ELBO (-3699.089999) evaluations: (3305)  #> Path [21] :Initial log joint density = -481920.990493  #> Path [21] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      1.437e-02   2.811e-01    1.000e+00  1.000e+00      3461 -3.701e+03 -3.700e+03                    #> Path [21] :Best Iter: [60] ELBO (-3700.482597) evaluations: (3461)  #> Path [22] :Initial log joint density = -481317.850746  #> Path [22] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      1.062e-02   2.637e-01    1.000e+00  1.000e+00      3157 -3.703e+03 -3.703e+03                    #> Path [22] :Best Iter: [55] ELBO (-3702.786997) evaluations: (3157)  #> Path [23] :Initial log joint density = -481920.785305  #> Path [23] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      8.656e-03   2.784e-01    1.000e+00  1.000e+00      3637 -3.701e+03 -3.704e+03                    #> Path [23] :Best Iter: [55] ELBO (-3701.470379) evaluations: (3637)  #> Path [24] :Initial log joint density = -481664.566903  #> Path [24] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      9.376e-03   2.411e-01    1.000e+00  1.000e+00      3079 -3.709e+03 -3.711e+03                    #> Path [24] :Best Iter: [49] ELBO (-3709.097389) evaluations: (3079)  #> Path [25] :Initial log joint density = -481715.228608  #> Path [25] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      1.181e-02   2.195e-01    1.000e+00  1.000e+00      3396 -3.701e+03 -3.700e+03                    #> Path [25] :Best Iter: [60] ELBO (-3700.467419) evaluations: (3396)  #> Path [26] :Initial log joint density = -481617.243441  #> Path [26] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      8.661e-03   1.846e-01    9.041e-01  9.041e-01      3561 -3.699e+03 -3.704e+03                    #> Path [26] :Best Iter: [58] ELBO (-3698.751167) evaluations: (3561)  #> Path [27] :Initial log joint density = -481780.040886  #> Path [27] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      7.780e-03   3.650e-01    3.670e-01  1.000e+00      3080 -3.708e+03 -3.715e+03                    #> Path [27] :Best Iter: [49] ELBO (-3708.210777) evaluations: (3080)  #> Path [28] :Initial log joint density = -481753.412444  #> Path [28] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      7.416e-03   2.171e-01    1.000e+00  1.000e+00      3503 -3.697e+03 -3.704e+03                    #> Path [28] :Best Iter: [57] ELBO (-3697.241979) evaluations: (3503)  #> Path [29] :Initial log joint density = -485154.555876  #> Path [29] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.396e-02   3.088e-01    1.000e+00  1.000e+00      3480 -3.696e+03 -3.706e+03                    #> Path [29] :Best Iter: [58] ELBO (-3695.713075) evaluations: (3480)  #> Path [30] :Initial log joint density = -481634.754658  #> Path [30] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      5.883e-03   2.410e-01    1.000e+00  1.000e+00      3116 -3.707e+03 -3.703e+03                    #> Path [30] :Best Iter: [55] ELBO (-3703.316866) evaluations: (3116)  #> Path [31] :Initial log joint density = -481534.485288  #> Path [31] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      1.125e-02   3.355e-01    1.000e+00  1.000e+00      3169 -3.700e+03 -3.708e+03                    #> Path [31] :Best Iter: [55] ELBO (-3699.736811) evaluations: (3169)  #> Path [32] :Initial log joint density = -485618.790138  #> Path [32] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      7.000e-03   2.063e-01    1.000e+00  1.000e+00      3510 -3.702e+03 -3.704e+03                    #> Path [32] :Best Iter: [56] ELBO (-3701.928421) evaluations: (3510)  #> Path [33] :Initial log joint density = -481557.121654  #> Path [33] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      4.051e-03   2.690e-01    6.804e-01  6.804e-01      2914 -3.707e+03 -3.723e+03                    #> Path [33] :Best Iter: [49] ELBO (-3706.863762) evaluations: (2914)  #> Path [34] :Initial log joint density = -485051.908004  #> Path [34] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      1.129e-02   3.728e-01    1.000e+00  1.000e+00      3392 -3.702e+03 -3.706e+03                    #> Path [34] :Best Iter: [56] ELBO (-3701.716844) evaluations: (3392)  #> Path [35] :Initial log joint density = -481666.395173  #> Path [35] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              64      -4.788e+05      1.287e-02   1.850e-01    8.774e-01  8.774e-01      3980 -3.699e+03 -3.705e+03                    #> Path [35] :Best Iter: [61] ELBO (-3699.279073) evaluations: (3980)  #> Path [36] :Initial log joint density = -481370.012494  #> Path [36] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.918e-02   2.577e-01    1.000e+00  1.000e+00      3489 -3.701e+03 -3.699e+03                    #> Path [36] :Best Iter: [59] ELBO (-3698.869380) evaluations: (3489)  #> Path [37] :Initial log joint density = -481472.497263  #> Path [37] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      1.426e-02   2.420e-01    1.000e+00  1.000e+00      3158 -3.698e+03 -3.702e+03                    #> Path [37] :Best Iter: [55] ELBO (-3697.732840) evaluations: (3158)  #> Path [38] :Initial log joint density = -481531.521734  #> Path [38] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.509e-02   3.466e-01    9.593e-01  9.593e-01      3503 -3.703e+03 -3.712e+03                    #> Path [38] :Best Iter: [58] ELBO (-3702.999987) evaluations: (3503)  #> Path [39] :Initial log joint density = -481593.608909  #> Path [39] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      4.726e-03   1.832e-01    8.477e-01  8.477e-01      3080 -3.707e+03 -3.712e+03                    #> Path [39] :Best Iter: [54] ELBO (-3706.922273) evaluations: (3080)  #> Path [40] :Initial log joint density = -481466.586838  #> Path [40] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      6.336e-03   2.282e-01    1.000e+00  1.000e+00      2957 -3.707e+03 -3.719e+03                    #> Path [40] :Best Iter: [44] ELBO (-3706.614827) evaluations: (2957)  #> Path [41] :Initial log joint density = -481447.711773  #> Path [41] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      1.397e-02   2.186e-01    1.000e+00  1.000e+00      2866 -3.710e+03 -3.714e+03                    #> Path [41] :Best Iter: [37] ELBO (-3709.965464) evaluations: (2866)  #> Path [42] :Initial log joint density = -481879.509224  #> Path [42] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              64      -4.788e+05      2.278e-03   1.989e-01    6.965e-01  6.965e-01      3745 -3.699e+03 -3.715e+03                    #> Path [42] :Best Iter: [61] ELBO (-3698.616332) evaluations: (3745)  #> Path [43] :Initial log joint density = -481622.394295  #> Path [43] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      4.565e-03   1.590e-01    8.394e-01  8.394e-01      2961 -3.708e+03 -3.720e+03                    #> Path [43] :Best Iter: [40] ELBO (-3708.435375) evaluations: (2961)  #> Path [44] :Initial log joint density = -481488.688805  #> Path [44] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              50      -4.788e+05      9.828e-03   2.527e-01    9.648e-01  9.648e-01      2669 -3.710e+03 -3.718e+03                    #> Path [44] :Best Iter: [49] ELBO (-3709.822214) evaluations: (2669)  #> Path [45] :Initial log joint density = -483315.963384  #> Path [45] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      1.024e-02   2.202e-01    1.000e+00  1.000e+00      3607 -3.699e+03 -3.701e+03                    #> Path [45] :Best Iter: [57] ELBO (-3699.050640) evaluations: (3607)  #> Path [46] :Initial log joint density = -481877.485840  #> Path [46] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      6.522e-03   2.358e-01    1.000e+00  1.000e+00      2961 -3.708e+03 -3.724e+03                    #> Path [46] :Best Iter: [50] ELBO (-3707.996840) evaluations: (2961)  #> Path [47] :Initial log joint density = -481472.383508  #> Path [47] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      1.238e-02   1.873e-01    1.000e+00  1.000e+00      3270 -3.700e+03 -3.703e+03                    #> Path [47] :Best Iter: [56] ELBO (-3699.971115) evaluations: (3270)  #> Path [48] :Initial log joint density = -481788.198136  #> Path [48] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      6.152e-03   2.292e-01    1.000e+00  1.000e+00      2955 -3.707e+03 -3.713e+03                    #> Path [48] :Best Iter: [46] ELBO (-3706.822298) evaluations: (2955)  #> Path [49] :Initial log joint density = -481938.438955  #> Path [49] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      8.132e-03   3.560e-01    9.130e-01  9.130e-01      3397 -3.702e+03 -3.712e+03                    #> Path [49] :Best Iter: [56] ELBO (-3701.745714) evaluations: (3397)  #> Path [50] :Initial log joint density = -481480.323530  #> Path [50] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      1.104e-02   2.309e-01    1.000e+00  1.000e+00      3074 -3.706e+03 -3.705e+03                    #> Path [50] :Best Iter: [55] ELBO (-3705.063488) evaluations: (3074)  #> Finished in  13.5 seconds. #> sccomp says: to do hypothesis testing run `sccomp_test()`, #>   the `test_composition_above_logit_fold_change` = 0.1 equates to a change of ~10%, and #>   0.7 equates to ~100% increase, if the baseline is ~0.1 proportion. #>   Use `sccomp_proportional_fold_change` to convert c_effect (linear) to proportion difference (non-linear). #> Loading model from cache... #> Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... #>  #> Chain 1 finished in 0.0 seconds. #> sccomp says: outlier identification - step 1/2 #> Loading model from cache... #> Path [1] :Initial log joint density = -433080.771678  #> Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      4.634e-02   1.005e+03    2.491e-02  2.491e-02      8191 -3.324e+03 -6.933e+04                    #> Path [1] :Best Iter: [55] ELBO (-3323.856544) evaluations: (8191)  #> Path [2] :Initial log joint density = -431949.217341  #> Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      5.040e-02   2.508e+03    2.158e-02  4.729e-02      8128 -3.327e+03 -4.726e+06                    #> Path [2] :Best Iter: [41] ELBO (-3327.161313) evaluations: (8128)  #> Path [3] :Initial log joint density = -432019.189686  #> Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      1.315e-01   3.097e+03    1.949e-02  1.949e-02      8599 -3.325e+03 -1.630e+05                    #> Path [3] :Best Iter: [41] ELBO (-3324.716260) evaluations: (8599)  #> Path [4] :Initial log joint density = -431569.121141  #> Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.290e+05      7.140e-02   1.083e+03    7.080e-02  7.080e-02      7966 -3.324e+03 -1.449e+04                    #> Path [4] :Best Iter: [52] ELBO (-3324.086912) evaluations: (7966)  #> Path [5] :Initial log joint density = -432222.364311  #> Path [5] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      3.282e-02   1.672e+03    2.115e-02  2.115e-02      8291 -3.325e+03 -7.465e+03                    #> Path [5] :Best Iter: [49] ELBO (-3325.021823) evaluations: (8291)  #> Path [6] :Initial log joint density = -431890.118415  #> Path [6] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      3.878e-02   2.137e+03    3.086e-02  3.086e-02      8258 -3.323e+03 -2.249e+04                    #> Path [6] :Best Iter: [40] ELBO (-3323.407594) evaluations: (8258)  #> Path [7] :Initial log joint density = -431981.248349  #> Path [7] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      3.610e-02   5.059e+03    1.371e-02  1.371e-02      8143 -3.327e+03 -1.698e+08                    #> Path [7] :Best Iter: [43] ELBO (-3326.696557) evaluations: (8143)  #> Path [8] :Initial log joint density = -431626.062948  #> Path [8] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      6.964e-02   2.193e+03    1.686e-02  1.686e-02      8386 -3.325e+03 -8.135e+05                    #> Path [8] :Best Iter: [47] ELBO (-3325.194569) evaluations: (8386)  #> Path [9] :Initial log joint density = -431579.584206  #> Path [9] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      3.369e-02   3.128e+03    1.744e-02  1.744e-02      8464 -3.325e+03 -1.025e+05                    #> Path [9] :Best Iter: [43] ELBO (-3325.470401) evaluations: (8464)  #> Path [10] :Initial log joint density = -432027.299682  #> Path [10] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.290e+05      3.763e-02   1.935e+03    3.841e-02  3.841e-02      7940 -3.316e+03 -6.983e+03                    #> Path [10] :Best Iter: [57] ELBO (-3316.080566) evaluations: (7940)  #> Path [11] :Initial log joint density = -431774.053774  #> Path [11] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      1.023e-01   5.848e+03    2.987e-02  2.987e-02      8308 -3.324e+03 -2.909e+06                    #> Path [11] :Best Iter: [51] ELBO (-3323.559964) evaluations: (8308)  #> Path [12] :Initial log joint density = -431665.278313  #> Path [12] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      4.440e-02   2.014e+03    3.339e-02  3.339e-02      8217 -3.328e+03 -1.632e+04                    #> Path [12] :Best Iter: [48] ELBO (-3328.035515) evaluations: (8217)  #> Path [13] :Initial log joint density = -431943.842758  #> Path [13] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.290e+05      3.181e-02   9.060e+02    3.207e-02  8.216e-02      7976 -3.321e+03 -5.119e+03                    #> Path [13] :Best Iter: [56] ELBO (-3320.715768) evaluations: (7976)  #> Path [14] :Initial log joint density = -432424.081777  #> Path [14] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.290e+05      8.557e-02   2.483e+03    4.174e-02  4.174e-02      8085 -3.319e+03 -1.025e+04                    #> Path [14] :Best Iter: [58] ELBO (-3318.912969) evaluations: (8085)  #> Path [15] :Initial log joint density = -431916.831548  #> Path [15] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      9.646e-02   2.569e+03    2.652e-02  2.652e-02      8309 -3.322e+03 -9.905e+07                    #> Path [15] :Best Iter: [45] ELBO (-3321.558289) evaluations: (8309)  #> Path [16] :Initial log joint density = -431613.967463  #> Path [16] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.290e+05      7.636e-02   1.520e+03    5.066e-02  5.066e-02      8181 -3.320e+03 -3.889e+04                    #> Path [16] :Best Iter: [49] ELBO (-3320.409466) evaluations: (8181)  #> Path [17] :Initial log joint density = -435333.022189  #> Path [17] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      6.323e-02   1.012e+03    3.920e-02  3.920e-02      8036 -3.325e+03 -1.417e+04                    #> Path [17] :Best Iter: [53] ELBO (-3325.137235) evaluations: (8036)  #> Path [18] :Initial log joint density = -433438.412158  #> Path [18] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      1.074e-01   1.115e+03    2.409e-02  4.762e-02      8153 -3.326e+03 -9.080e+05                    #> Path [18] :Best Iter: [48] ELBO (-3326.020790) evaluations: (8153)  #> Path [19] :Initial log joint density = -432165.426871  #> Path [19] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      5.548e-02   4.195e+03    2.888e-02  2.888e-02      8338 -3.326e+03 -4.106e+04                    #> Path [19] :Best Iter: [47] ELBO (-3326.170924) evaluations: (8338)  #> Path [20] :Initial log joint density = -431915.254627  #> Path [20] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      6.125e-02   5.710e+03    2.569e-02  2.569e-02      8415 -3.330e+03 -3.149e+06                    #> Path [20] :Best Iter: [44] ELBO (-3330.336218) evaluations: (8415)  #> Path [21] :Initial log joint density = -431780.911061  #> Path [21] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      5.007e-02   1.676e+03    4.320e-02  4.320e-02      8417 -3.330e+03 -5.555e+04                    #> Path [21] :Best Iter: [44] ELBO (-3330.372516) evaluations: (8417)  #> Path [22] :Initial log joint density = -434054.169591  #> Path [22] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      1.356e-02   2.239e+03    1.205e-02  1.205e-02      8474 -3.323e+03 -2.516e+04                    #> Path [22] :Best Iter: [49] ELBO (-3323.462665) evaluations: (8474)  #> Path [23] :Initial log joint density = -431891.213400  #> Path [23] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.290e+05      5.913e-02   1.504e+03    2.470e-02  6.374e-02      7817 -3.319e+03 -1.006e+05                    #> Path [23] :Best Iter: [57] ELBO (-3318.648636) evaluations: (7817)  #> Path [24] :Initial log joint density = -434794.393636  #> Path [24] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.290e+05      4.104e-02   8.288e+02    4.014e-02  4.014e-02      8218 -3.319e+03 -1.002e+05                    #> Path [24] :Best Iter: [57] ELBO (-3319.263082) evaluations: (8218)  #> Path [25] :Initial log joint density = -431890.154889  #> Path [25] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      2.400e-02   2.212e+03    1.871e-02  1.871e-02      8142 -3.327e+03 -1.003e+04                    #> Path [25] :Best Iter: [48] ELBO (-3327.210831) evaluations: (8142)  #> Path [26] :Initial log joint density = -433019.061482  #> Path [26] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      3.014e-02   1.223e+03    2.025e-02  2.025e-02      8143 -3.321e+03 -7.395e+04                    #> Path [26] :Best Iter: [56] ELBO (-3320.576506) evaluations: (8143)  #> Path [27] :Initial log joint density = -431506.538666  #> Path [27] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      4.023e-02   3.331e+03    2.239e-02  2.239e-02      8474 -3.326e+03 -1.743e+04                    #> Path [27] :Best Iter: [43] ELBO (-3325.880243) evaluations: (8474)  #> Path [28] :Initial log joint density = -432096.857394  #> Path [28] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      8.816e-02   1.821e+03    5.257e-02  5.257e-02      8138 -3.320e+03 -2.152e+04                    #> Path [28] :Best Iter: [57] ELBO (-3319.766831) evaluations: (8138)  #> Path [29] :Initial log joint density = -433644.226219  #> Path [29] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      6.936e-02   2.237e+03    2.941e-02  6.226e-02      8162 -3.322e+03 -6.358e+04                    #> Path [29] :Best Iter: [55] ELBO (-3321.902901) evaluations: (8162)  #> Path [30] :Initial log joint density = -431605.693849  #> Path [30] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      7.048e-02   9.244e+03    1.223e-02  1.223e-02      8391 -3.329e+03 -4.184e+06                    #> Path [30] :Best Iter: [41] ELBO (-3329.094064) evaluations: (8391)  #> Path [31] :Initial log joint density = -432749.961475  #> Path [31] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      5.335e-02   2.169e+03    3.714e-02  3.714e-02      8323 -3.326e+03 -5.081e+04                    #> Path [31] :Best Iter: [49] ELBO (-3326.377036) evaluations: (8323)  #> Path [32] :Initial log joint density = -431672.913398  #> Path [32] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      5.208e-02   2.805e+03    2.809e-02  2.809e-02      8322 -3.329e+03 -4.868e+06                    #> Path [32] :Best Iter: [48] ELBO (-3328.683704) evaluations: (8322)  #> Path [33] :Initial log joint density = -431859.733699  #> Path [33] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.290e+05      6.967e-02   1.421e+03    3.466e-02  3.466e-02      8395 -3.327e+03 -1.469e+04                    #> Path [33] :Best Iter: [56] ELBO (-3327.327368) evaluations: (8395)  #> Path [34] :Initial log joint density = -431935.416593  #> Path [34] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      5.787e-02   6.087e+03    2.306e-02  2.306e-02      8095 -3.329e+03 -1.447e+06                    #> Path [34] :Best Iter: [41] ELBO (-3328.766023) evaluations: (8095)  #> Path [35] :Initial log joint density = -431884.877672  #> Path [35] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      4.265e-02   1.961e+03    1.472e-02  1.472e-02      7967 -3.322e+03 -1.160e+08                    #> Path [35] :Best Iter: [56] ELBO (-3321.509849) evaluations: (7967)  #> Path [36] :Initial log joint density = -432375.807700  #> Path [36] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.290e+05      2.325e-02   1.443e+03    2.656e-02  2.656e-02      8181 -3.318e+03 -4.224e+03                    #> Path [36] :Best Iter: [57] ELBO (-3317.720129) evaluations: (8181)  #> Path [37] :Initial log joint density = -431770.564516  #> Path [37] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      1.903e-02   2.102e+03    1.419e-02  1.419e-02      8213 -3.326e+03 -1.356e+05                    #> Path [37] :Best Iter: [44] ELBO (-3326.111522) evaluations: (8213)  #> Path [38] :Initial log joint density = -432013.691962  #> Path [38] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      7.016e-02   2.368e+03    1.806e-02  1.806e-02      8308 -3.327e+03 -1.276e+06                    #> Path [38] :Best Iter: [51] ELBO (-3326.520923) evaluations: (8308)  #> Path [39] :Initial log joint density = -431970.270966  #> Path [39] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      2.262e-02   3.019e+03    1.899e-02  1.899e-02      8280 -3.328e+03 -4.563e+04                    #> Path [39] :Best Iter: [47] ELBO (-3327.564592) evaluations: (8280)  #> Path [40] :Initial log joint density = -433811.602858  #> Path [40] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      3.816e-02   1.438e+03    4.514e-02  4.514e-02      8174 -3.318e+03 -1.947e+04                    #> Path [40] :Best Iter: [55] ELBO (-3317.538379) evaluations: (8174)  #> Path [41] :Initial log joint density = -432461.655685  #> Path [41] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.290e+05      4.283e-02   1.481e+03    1.923e-02  1.923e-02      8168 -3.323e+03 -3.223e+04                    #> Path [41] :Best Iter: [53] ELBO (-3323.165222) evaluations: (8168)  #> Path [42] :Initial log joint density = -433669.015119  #> Path [42] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      5.662e-02   1.680e+03    2.845e-02  2.845e-02      8193 -3.323e+03 -1.639e+05                    #> Path [42] :Best Iter: [56] ELBO (-3322.586945) evaluations: (8193)  #> Path [43] :Initial log joint density = -432968.922252  #> Path [43] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      7.415e-02   3.805e+03    2.685e-02  2.685e-02      8390 -3.325e+03 -3.081e+05                    #> Path [43] :Best Iter: [46] ELBO (-3325.162424) evaluations: (8390)  #> Path [44] :Initial log joint density = -433412.858946  #> Path [44] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      5.931e-02   8.397e+02    3.209e-02  3.209e-02      8271 -3.324e+03 -6.685e+05                    #> Path [44] :Best Iter: [55] ELBO (-3324.317125) evaluations: (8271)  #> Path [45] :Initial log joint density = -431728.712645  #> Path [45] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      4.506e-02   6.576e+03    1.349e-02  1.349e-02      8165 -3.325e+03 -5.641e+07                    #> Path [45] :Best Iter: [44] ELBO (-3325.043214) evaluations: (8165)  #> Path [46] :Initial log joint density = -431857.823816  #> Path [46] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      3.763e-02   3.087e+03    2.643e-02  2.643e-02      8247 -3.329e+03 -1.495e+04                    #> Path [46] :Best Iter: [53] ELBO (-3329.066212) evaluations: (8247)  #> Path [47] :Initial log joint density = -434361.617286  #> Path [47] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      9.612e-02   2.562e+03    1.819e-02  4.067e-02      8049 -3.321e+03 -1.070e+07                    #> Path [47] :Best Iter: [57] ELBO (-3320.709397) evaluations: (8049)  #> Path [48] :Initial log joint density = -431866.269737  #> Path [48] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      6.167e-02   3.462e+03    1.943e-02  1.943e-02      8210 -3.326e+03 -2.014e+06                    #> Path [48] :Best Iter: [42] ELBO (-3325.995014) evaluations: (8210)  #> Path [49] :Initial log joint density = -436070.697148  #> Path [49] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.290e+05      3.161e-02   8.890e+02    3.416e-02  3.416e-02      8260 -3.321e+03 -7.345e+03                    #> Path [49] :Best Iter: [55] ELBO (-3320.816235) evaluations: (8260)  #> Path [50] :Initial log joint density = -431968.407034  #> Path [50] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      2.737e-02   2.390e+03    2.203e-02  2.203e-02      8436 -3.326e+03 -5.640e+04                    #> Path [50] :Best Iter: [47] ELBO (-3326.208287) evaluations: (8436)  #> Finished in  30.3 seconds. #> Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... #>  #> Chain 1 finished in 0.0 seconds. #> sccomp says: outlier-free model fitting - step 2/2 #> sccomp says: the composition design matrix has columns: (Intercept), typecancer #> sccomp says: the variability design matrix has columns: (Intercept) #> Loading model from cache... #> Path [1] :Initial log joint density = -433080.771678  #> Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      4.634e-02   1.005e+03    2.491e-02  2.491e-02      8191 -3.324e+03 -6.933e+04                    #> Path [1] :Best Iter: [55] ELBO (-3323.856544) evaluations: (8191)  #> Path [2] :Initial log joint density = -431949.217341  #> Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      5.040e-02   2.508e+03    2.158e-02  4.729e-02      8128 -3.327e+03 -4.726e+06                    #> Path [2] :Best Iter: [41] ELBO (-3327.161313) evaluations: (8128)  #> Path [3] :Initial log joint density = -432019.189686  #> Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      1.315e-01   3.097e+03    1.949e-02  1.949e-02      8599 -3.325e+03 -1.630e+05                    #> Path [3] :Best Iter: [41] ELBO (-3324.716260) evaluations: (8599)  #> Path [4] :Initial log joint density = -431569.121141  #> Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.290e+05      7.140e-02   1.083e+03    7.080e-02  7.080e-02      7966 -3.324e+03 -1.449e+04                    #> Path [4] :Best Iter: [52] ELBO (-3324.086912) evaluations: (7966)  #> Path [5] :Initial log joint density = -432222.364311  #> Path [5] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      3.282e-02   1.672e+03    2.115e-02  2.115e-02      8291 -3.325e+03 -7.465e+03                    #> Path [5] :Best Iter: [49] ELBO (-3325.021823) evaluations: (8291)  #> Path [6] :Initial log joint density = -431890.118415  #> Path [6] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      3.878e-02   2.137e+03    3.086e-02  3.086e-02      8258 -3.323e+03 -2.249e+04                    #> Path [6] :Best Iter: [40] ELBO (-3323.407594) evaluations: (8258)  #> Path [7] :Initial log joint density = -431981.248349  #> Path [7] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      3.610e-02   5.059e+03    1.371e-02  1.371e-02      8143 -3.327e+03 -1.698e+08                    #> Path [7] :Best Iter: [43] ELBO (-3326.696557) evaluations: (8143)  #> Path [8] :Initial log joint density = -431626.062948  #> Path [8] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      6.964e-02   2.193e+03    1.686e-02  1.686e-02      8386 -3.325e+03 -8.135e+05                    #> Path [8] :Best Iter: [47] ELBO (-3325.194569) evaluations: (8386)  #> Path [9] :Initial log joint density = -431579.584206  #> Path [9] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      3.369e-02   3.128e+03    1.744e-02  1.744e-02      8464 -3.325e+03 -1.025e+05                    #> Path [9] :Best Iter: [43] ELBO (-3325.470401) evaluations: (8464)  #> Path [10] :Initial log joint density = -432027.299682  #> Path [10] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.290e+05      3.763e-02   1.935e+03    3.841e-02  3.841e-02      7940 -3.316e+03 -6.983e+03                    #> Path [10] :Best Iter: [57] ELBO (-3316.080566) evaluations: (7940)  #> Path [11] :Initial log joint density = -431774.053774  #> Path [11] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      1.023e-01   5.848e+03    2.987e-02  2.987e-02      8308 -3.324e+03 -2.909e+06                    #> Path [11] :Best Iter: [51] ELBO (-3323.559964) evaluations: (8308)  #> Path [12] :Initial log joint density = -431665.278313  #> Path [12] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      4.440e-02   2.014e+03    3.339e-02  3.339e-02      8217 -3.328e+03 -1.632e+04                    #> Path [12] :Best Iter: [48] ELBO (-3328.035515) evaluations: (8217)  #> Path [13] :Initial log joint density = -431943.842758  #> Path [13] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.290e+05      3.181e-02   9.060e+02    3.207e-02  8.216e-02      7976 -3.321e+03 -5.119e+03                    #> Path [13] :Best Iter: [56] ELBO (-3320.715768) evaluations: (7976)  #> Path [14] :Initial log joint density = -432424.081777  #> Path [14] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.290e+05      8.557e-02   2.483e+03    4.174e-02  4.174e-02      8085 -3.319e+03 -1.025e+04                    #> Path [14] :Best Iter: [58] ELBO (-3318.912969) evaluations: (8085)  #> Path [15] :Initial log joint density = -431916.831548  #> Path [15] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      9.646e-02   2.569e+03    2.652e-02  2.652e-02      8309 -3.322e+03 -9.905e+07                    #> Path [15] :Best Iter: [45] ELBO (-3321.558289) evaluations: (8309)  #> Path [16] :Initial log joint density = -431613.967463  #> Path [16] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.290e+05      7.636e-02   1.520e+03    5.066e-02  5.066e-02      8181 -3.320e+03 -3.889e+04                    #> Path [16] :Best Iter: [49] ELBO (-3320.409466) evaluations: (8181)  #> Path [17] :Initial log joint density = -435333.022189  #> Path [17] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      6.323e-02   1.012e+03    3.920e-02  3.920e-02      8036 -3.325e+03 -1.417e+04                    #> Path [17] :Best Iter: [53] ELBO (-3325.137235) evaluations: (8036)  #> Path [18] :Initial log joint density = -433438.412158  #> Path [18] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      1.074e-01   1.115e+03    2.409e-02  4.762e-02      8153 -3.326e+03 -9.080e+05                    #> Path [18] :Best Iter: [48] ELBO (-3326.020790) evaluations: (8153)  #> Path [19] :Initial log joint density = -432165.426871  #> Path [19] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      5.548e-02   4.195e+03    2.888e-02  2.888e-02      8338 -3.326e+03 -4.106e+04                    #> Path [19] :Best Iter: [47] ELBO (-3326.170924) evaluations: (8338)  #> Path [20] :Initial log joint density = -431915.254627  #> Path [20] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      6.125e-02   5.710e+03    2.569e-02  2.569e-02      8415 -3.330e+03 -3.149e+06                    #> Path [20] :Best Iter: [44] ELBO (-3330.336218) evaluations: (8415)  #> Path [21] :Initial log joint density = -431780.911061  #> Path [21] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      5.007e-02   1.676e+03    4.320e-02  4.320e-02      8417 -3.330e+03 -5.555e+04                    #> Path [21] :Best Iter: [44] ELBO (-3330.372516) evaluations: (8417)  #> Path [22] :Initial log joint density = -434054.169591  #> Path [22] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      1.356e-02   2.239e+03    1.205e-02  1.205e-02      8474 -3.323e+03 -2.516e+04                    #> Path [22] :Best Iter: [49] ELBO (-3323.462665) evaluations: (8474)  #> Path [23] :Initial log joint density = -431891.213400  #> Path [23] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.290e+05      5.913e-02   1.504e+03    2.470e-02  6.374e-02      7817 -3.319e+03 -1.006e+05                    #> Path [23] :Best Iter: [57] ELBO (-3318.648636) evaluations: (7817)  #> Path [24] :Initial log joint density = -434794.393636  #> Path [24] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.290e+05      4.104e-02   8.288e+02    4.014e-02  4.014e-02      8218 -3.319e+03 -1.002e+05                    #> Path [24] :Best Iter: [57] ELBO (-3319.263082) evaluations: (8218)  #> Path [25] :Initial log joint density = -431890.154889  #> Path [25] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      2.400e-02   2.212e+03    1.871e-02  1.871e-02      8142 -3.327e+03 -1.003e+04                    #> Path [25] :Best Iter: [48] ELBO (-3327.210831) evaluations: (8142)  #> Path [26] :Initial log joint density = -433019.061482  #> Path [26] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      3.014e-02   1.223e+03    2.025e-02  2.025e-02      8143 -3.321e+03 -7.395e+04                    #> Path [26] :Best Iter: [56] ELBO (-3320.576506) evaluations: (8143)  #> Path [27] :Initial log joint density = -431506.538666  #> Path [27] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      4.023e-02   3.331e+03    2.239e-02  2.239e-02      8474 -3.326e+03 -1.743e+04                    #> Path [27] :Best Iter: [43] ELBO (-3325.880243) evaluations: (8474)  #> Path [28] :Initial log joint density = -432096.857394  #> Path [28] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      8.816e-02   1.821e+03    5.257e-02  5.257e-02      8138 -3.320e+03 -2.152e+04                    #> Path [28] :Best Iter: [57] ELBO (-3319.766831) evaluations: (8138)  #> Path [29] :Initial log joint density = -433644.226219  #> Path [29] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      6.936e-02   2.237e+03    2.941e-02  6.226e-02      8162 -3.322e+03 -6.358e+04                    #> Path [29] :Best Iter: [55] ELBO (-3321.902901) evaluations: (8162)  #> Path [30] :Initial log joint density = -431605.693849  #> Path [30] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      7.048e-02   9.244e+03    1.223e-02  1.223e-02      8391 -3.329e+03 -4.184e+06                    #> Path [30] :Best Iter: [41] ELBO (-3329.094064) evaluations: (8391)  #> Path [31] :Initial log joint density = -432749.961475  #> Path [31] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      5.335e-02   2.169e+03    3.714e-02  3.714e-02      8323 -3.326e+03 -5.081e+04                    #> Path [31] :Best Iter: [49] ELBO (-3326.377036) evaluations: (8323)  #> Path [32] :Initial log joint density = -431672.913398  #> Path [32] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      5.208e-02   2.805e+03    2.809e-02  2.809e-02      8322 -3.329e+03 -4.868e+06                    #> Path [32] :Best Iter: [48] ELBO (-3328.683704) evaluations: (8322)  #> Path [33] :Initial log joint density = -431859.733699  #> Path [33] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.290e+05      6.967e-02   1.421e+03    3.466e-02  3.466e-02      8395 -3.327e+03 -1.469e+04                    #> Path [33] :Best Iter: [56] ELBO (-3327.327368) evaluations: (8395)  #> Path [34] :Initial log joint density = -431935.416593  #> Path [34] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      5.787e-02   6.087e+03    2.306e-02  2.306e-02      8095 -3.329e+03 -1.447e+06                    #> Path [34] :Best Iter: [41] ELBO (-3328.766023) evaluations: (8095)  #> Path [35] :Initial log joint density = -431884.877672  #> Path [35] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      4.265e-02   1.961e+03    1.472e-02  1.472e-02      7967 -3.322e+03 -1.160e+08                    #> Path [35] :Best Iter: [56] ELBO (-3321.509849) evaluations: (7967)  #> Path [36] :Initial log joint density = -432375.807700  #> Path [36] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.290e+05      2.325e-02   1.443e+03    2.656e-02  2.656e-02      8181 -3.318e+03 -4.224e+03                    #> Path [36] :Best Iter: [57] ELBO (-3317.720129) evaluations: (8181)  #> Path [37] :Initial log joint density = -431770.564516  #> Path [37] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      1.903e-02   2.102e+03    1.419e-02  1.419e-02      8213 -3.326e+03 -1.356e+05                    #> Path [37] :Best Iter: [44] ELBO (-3326.111522) evaluations: (8213)  #> Path [38] :Initial log joint density = -432013.691962  #> Path [38] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      7.016e-02   2.368e+03    1.806e-02  1.806e-02      8308 -3.327e+03 -1.276e+06                    #> Path [38] :Best Iter: [51] ELBO (-3326.520923) evaluations: (8308)  #> Path [39] :Initial log joint density = -431970.270966  #> Path [39] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      2.262e-02   3.019e+03    1.899e-02  1.899e-02      8280 -3.328e+03 -4.563e+04                    #> Path [39] :Best Iter: [47] ELBO (-3327.564592) evaluations: (8280)  #> Path [40] :Initial log joint density = -433811.602858  #> Path [40] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      3.816e-02   1.438e+03    4.514e-02  4.514e-02      8174 -3.318e+03 -1.947e+04                    #> Path [40] :Best Iter: [55] ELBO (-3317.538379) evaluations: (8174)  #> Path [41] :Initial log joint density = -432461.655685  #> Path [41] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.290e+05      4.283e-02   1.481e+03    1.923e-02  1.923e-02      8168 -3.323e+03 -3.223e+04                    #> Path [41] :Best Iter: [53] ELBO (-3323.165222) evaluations: (8168)  #> Path [42] :Initial log joint density = -433669.015119  #> Path [42] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      5.662e-02   1.680e+03    2.845e-02  2.845e-02      8193 -3.323e+03 -1.639e+05                    #> Path [42] :Best Iter: [56] ELBO (-3322.586945) evaluations: (8193)  #> Path [43] :Initial log joint density = -432968.922252  #> Path [43] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      7.415e-02   3.805e+03    2.685e-02  2.685e-02      8390 -3.325e+03 -3.081e+05                    #> Path [43] :Best Iter: [46] ELBO (-3325.162424) evaluations: (8390)  #> Path [44] :Initial log joint density = -433412.858946  #> Path [44] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      5.931e-02   8.397e+02    3.209e-02  3.209e-02      8271 -3.324e+03 -6.685e+05                    #> Path [44] :Best Iter: [55] ELBO (-3324.317125) evaluations: (8271)  #> Path [45] :Initial log joint density = -431728.712645  #> Path [45] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      4.506e-02   6.576e+03    1.349e-02  1.349e-02      8165 -3.325e+03 -5.641e+07                    #> Path [45] :Best Iter: [44] ELBO (-3325.043214) evaluations: (8165)  #> Path [46] :Initial log joint density = -431857.823816  #> Path [46] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      3.763e-02   3.087e+03    2.643e-02  2.643e-02      8247 -3.329e+03 -1.495e+04                    #> Path [46] :Best Iter: [53] ELBO (-3329.066212) evaluations: (8247)  #> Path [47] :Initial log joint density = -434361.617286  #> Path [47] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      9.612e-02   2.562e+03    1.819e-02  4.067e-02      8049 -3.321e+03 -1.070e+07                    #> Path [47] :Best Iter: [57] ELBO (-3320.709397) evaluations: (8049)  #> Path [48] :Initial log joint density = -431866.269737  #> Path [48] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      6.167e-02   3.462e+03    1.943e-02  1.943e-02      8210 -3.326e+03 -2.014e+06                    #> Path [48] :Best Iter: [42] ELBO (-3325.995014) evaluations: (8210)  #> Path [49] :Initial log joint density = -436070.697148  #> Path [49] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.290e+05      3.161e-02   8.890e+02    3.416e-02  3.416e-02      8260 -3.321e+03 -7.345e+03                    #> Path [49] :Best Iter: [55] ELBO (-3320.816235) evaluations: (8260)  #> Path [50] :Initial log joint density = -431968.407034  #> Path [50] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>             100      -4.289e+05      2.737e-02   2.390e+03    2.203e-02  2.203e-02      8436 -3.326e+03 -5.640e+04                    #> Path [50] :Best Iter: [47] ELBO (-3326.208287) evaluations: (8436)  #> Finished in  27.4 seconds. # }"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_remove_unwanted_effects.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove unwanted effects from a sccomp_tbl object — sccomp_remove_unwanted_effects","title":"Remove unwanted effects from a sccomp_tbl object — sccomp_remove_unwanted_effects","text":"method removes unwanted effects dataset using model estimates. example, fit data formula ~ factor_1 + factor_2 use formula ~ factor_1 remove unwanted variation, factor_2 effect factored .","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_remove_unwanted_effects.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove unwanted effects from a sccomp_tbl object — sccomp_remove_unwanted_effects","text":"","code":"sccomp_remove_unwanted_effects(   .data,   formula_composition_keep = NULL,   formula_composition = NULL,   cores = detectCores() )"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_remove_unwanted_effects.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove unwanted effects from a sccomp_tbl object — sccomp_remove_unwanted_effects","text":".data sccomp_tbl object. result sccomp_estimate. formula_composition_keep formula. formula describing model differential abundance, example ~type. case, effect type factor preserved, factors factored . formula_composition DEPRECATED. Use formula_composition_keep instead. cores Integer, number cores used parallel calculations.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_remove_unwanted_effects.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove unwanted effects from a sccomp_tbl object — sccomp_remove_unwanted_effects","text":"tibble (tbl) following columns: sample - character column representing sample name data adjusted. cell_group - character column representing cell group tested. adjusted_proportion - numeric column representing adjusted proportion removing unwanted variation. adjusted_counts - numeric column representing adjusted counts removing unwanted variation. logit_residuals - numeric column representing logit residuals calculated adjustment.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_remove_unwanted_effects.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Remove unwanted effects from a sccomp_tbl object — sccomp_remove_unwanted_effects","text":"S. Mangiola, .J. Roth-Schulze, M. Trussart, E. Zozaya-Valdés, M. Ma, Z. Gao, .F. Rubin, T.P. Speed, H. Shim, & .T. Papenfuss, sccomp: Robust differential composition variability analysis single-cell data, Proc. Natl. Acad. Sci. U.S.. 120 (33) e2203828120, https://doi.org/10.1073/pnas.2203828120 (2023).","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_remove_unwanted_effects.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Remove unwanted effects from a sccomp_tbl object — sccomp_remove_unwanted_effects","text":"","code":"print(\"cmdstanr is needed to run this example.\") #> [1] \"cmdstanr is needed to run this example.\" # Note: Before running the example, ensure that the 'cmdstanr' package is installed: # install.packages(\"cmdstanr\", repos = c(\"https://stan-dev.r-universe.dev/\", getOption(\"repos\")))  # \\donttest{   if (instantiate::stan_cmdstan_exists()) {     data(\"counts_obj\")      estimates = sccomp_estimate(       counts_obj,       ~ type, ~1, \"sample\", \"cell_group\", \"count\",       cores = 1     ) |>     sccomp_remove_unwanted_effects()   } #> sccomp says: count column is an integer. The sum-constrained beta binomial model will be used #> sccomp says: estimation #> sccomp says: the composition design matrix has columns: (Intercept), typecancer #> sccomp says: the variability design matrix has columns: (Intercept) #> Loading model from cache... #> Path [1] :Initial log joint density = -482669.393161  #> Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      1.332e-02   3.228e-01    9.490e-01  9.490e-01      3073 -3.707e+03 -3.713e+03                    #> Path [1] :Best Iter: [49] ELBO (-3707.344667) evaluations: (3073)  #> Path [2] :Initial log joint density = -481552.415132  #> Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      9.617e-03   2.165e-01    1.000e+00  1.000e+00      2863 -3.708e+03 -3.708e+03                    #> Path [2] :Best Iter: [52] ELBO (-3707.908708) evaluations: (2863)  #> Path [3] :Initial log joint density = -481678.075023  #> Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.351e-02   2.778e-01    1.000e+00  1.000e+00      3495 -3.699e+03 -3.700e+03                    #> Path [3] :Best Iter: [58] ELBO (-3698.988322) evaluations: (3495)  #> Path [4] :Initial log joint density = -481355.071676  #> Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      4.238e-03   1.574e-01    1.000e+00  1.000e+00      3372 -3.700e+03 -3.708e+03                    #> Path [4] :Best Iter: [55] ELBO (-3700.250550) evaluations: (3372)  #> Path [5] :Initial log joint density = -481827.993582  #> Path [5] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      1.284e-02   3.398e-01    1.000e+00  1.000e+00      2996 -3.707e+03 -3.724e+03                    #> Path [5] :Best Iter: [47] ELBO (-3707.000669) evaluations: (2996)  #> Path [6] :Initial log joint density = -483001.333934  #> Path [6] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      7.061e-03   3.730e-01    4.910e-01  1.000e+00      3344 -3.700e+03 -3.710e+03                    #> Path [6] :Best Iter: [55] ELBO (-3700.129494) evaluations: (3344)  #> Path [7] :Initial log joint density = -481490.782579  #> Path [7] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      1.886e-02   3.430e-01    9.937e-01  9.937e-01      3162 -3.697e+03 -3.707e+03                    #> Path [7] :Best Iter: [55] ELBO (-3696.942511) evaluations: (3162)  #> Path [8] :Initial log joint density = -481489.040280  #> Path [8] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      3.866e-03   2.879e-01    7.269e-01  7.269e-01      3037 -3.709e+03 -3.726e+03                    #> Path [8] :Best Iter: [44] ELBO (-3708.885109) evaluations: (3037)  #> Path [9] :Initial log joint density = -481455.140199  #> Path [9] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      6.635e-03   2.340e-01    1.000e+00  1.000e+00      2842 -3.707e+03 -3.709e+03                    #> Path [9] :Best Iter: [46] ELBO (-3706.653499) evaluations: (2842)  #> Path [10] :Initial log joint density = -484199.918640  #> Path [10] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      4.843e-03   1.774e-01    7.740e-01  7.740e-01      3575 -3.698e+03 -3.710e+03                    #> Path [10] :Best Iter: [58] ELBO (-3698.329796) evaluations: (3575)  #> Path [11] :Initial log joint density = -481645.794233  #> Path [11] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      7.494e-03   1.882e-01    1.000e+00  1.000e+00      3524 -3.700e+03 -3.701e+03                    #> Path [11] :Best Iter: [56] ELBO (-3699.963620) evaluations: (3524)  #> Path [12] :Initial log joint density = -481630.109781  #> Path [12] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      1.673e-02   3.356e-01    1.000e+00  1.000e+00      3079 -3.709e+03 -3.703e+03                    #> Path [12] :Best Iter: [55] ELBO (-3703.140683) evaluations: (3079)  #> Path [13] :Initial log joint density = -481999.636630  #> Path [13] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      4.788e-03   1.785e-01    7.785e-01  7.785e-01      3305 -3.700e+03 -3.715e+03                    #> Path [13] :Best Iter: [57] ELBO (-3699.750638) evaluations: (3305)  #> Path [14] :Initial log joint density = -481641.087199  #> Path [14] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      5.069e-03   2.105e-01    9.580e-01  9.580e-01      2998 -3.707e+03 -3.716e+03                    #> Path [14] :Best Iter: [50] ELBO (-3706.718999) evaluations: (2998)  #> Path [15] :Initial log joint density = -482254.841793  #> Path [15] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      9.889e-03   2.593e-01    1.000e+00  1.000e+00      3394 -3.700e+03 -3.702e+03                    #> Path [15] :Best Iter: [56] ELBO (-3700.468993) evaluations: (3394)  #> Path [16] :Initial log joint density = -481497.055254  #> Path [16] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      8.915e-03   2.677e-01    1.000e+00  1.000e+00      3131 -3.707e+03 -3.714e+03                    #> Path [16] :Best Iter: [45] ELBO (-3707.182107) evaluations: (3131)  #> Path [17] :Initial log joint density = -481901.044395  #> Path [17] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      1.008e-02   1.821e-01    1.000e+00  1.000e+00      3270 -3.701e+03 -3.703e+03                    #> Path [17] :Best Iter: [55] ELBO (-3701.139222) evaluations: (3270)  #> Path [18] :Initial log joint density = -482132.504563  #> Path [18] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      6.015e-03   2.285e-01    1.000e+00  1.000e+00      3174 -3.706e+03 -3.706e+03                    #> Path [18] :Best Iter: [55] ELBO (-3705.692441) evaluations: (3174)  #> Path [19] :Initial log joint density = -481391.685368  #> Path [19] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      9.313e-03   3.126e-01    8.639e-01  8.639e-01      2993 -3.707e+03 -3.722e+03                    #> Path [19] :Best Iter: [47] ELBO (-3707.456615) evaluations: (2993)  #> Path [20] :Initial log joint density = -481617.243305  #> Path [20] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      1.103e-02   2.279e-01    1.000e+00  1.000e+00      3199 -3.700e+03 -3.700e+03                    #> Path [20] :Best Iter: [57] ELBO (-3699.538112) evaluations: (3199)  #> Path [21] :Initial log joint density = -481677.920701  #> Path [21] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              51      -4.788e+05      5.652e-03   1.999e-01    1.000e+00  1.000e+00      2794 -3.707e+03 -3.723e+03                    #> Path [21] :Best Iter: [47] ELBO (-3707.334656) evaluations: (2794)  #> Path [22] :Initial log joint density = -481761.028332  #> Path [22] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      1.201e-02   1.525e-01    1.000e+00  1.000e+00      3088 -3.708e+03 -3.717e+03                    #> Path [22] :Best Iter: [38] ELBO (-3707.665095) evaluations: (3088)  #> Path [23] :Initial log joint density = -483119.232802  #> Path [23] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.598e-02   3.278e-01    1.000e+00  1.000e+00      3525 -3.699e+03 -3.702e+03                    #> Path [23] :Best Iter: [58] ELBO (-3698.504941) evaluations: (3525)  #> Path [24] :Initial log joint density = -481621.586441  #> Path [24] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.837e-02   2.306e-01    1.000e+00  1.000e+00      3515 -3.701e+03 -3.702e+03                    #> Path [24] :Best Iter: [58] ELBO (-3701.019452) evaluations: (3515)  #> Path [25] :Initial log joint density = -481723.673284  #> Path [25] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      7.899e-03   2.305e-01    1.000e+00  1.000e+00      3207 -3.705e+03 -3.710e+03                    #> Path [25] :Best Iter: [48] ELBO (-3705.181854) evaluations: (3207)  #> Path [26] :Initial log joint density = -481772.093997  #> Path [26] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      1.479e-02   3.118e-01    1.000e+00  1.000e+00      3478 -3.698e+03 -3.701e+03                    #> Path [26] :Best Iter: [60] ELBO (-3697.607715) evaluations: (3478)  #> Path [27] :Initial log joint density = -481602.072464  #> Path [27] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      7.267e-03   2.606e-01    1.000e+00  1.000e+00      3101 -3.708e+03 -3.704e+03                    #> Path [27] :Best Iter: [55] ELBO (-3703.578275) evaluations: (3101)  #> Path [28] :Initial log joint density = -482197.893221  #> Path [28] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.369e-02   2.923e-01    1.000e+00  1.000e+00      3446 -3.699e+03 -3.707e+03                    #> Path [28] :Best Iter: [58] ELBO (-3699.095461) evaluations: (3446)  #> Path [29] :Initial log joint density = -482203.853817  #> Path [29] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      3.667e-03   3.025e-01    5.550e-01  5.550e-01      3628 -3.699e+03 -3.715e+03                    #> Path [29] :Best Iter: [59] ELBO (-3698.659369) evaluations: (3628)  #> Path [30] :Initial log joint density = -481558.003458  #> Path [30] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      6.692e-03   2.368e-01    1.000e+00  1.000e+00      2926 -3.706e+03 -3.713e+03                    #> Path [30] :Best Iter: [50] ELBO (-3705.714760) evaluations: (2926)  #> Path [31] :Initial log joint density = -481787.635446  #> Path [31] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      1.031e-02   2.475e-01    8.639e-01  8.639e-01      3517 -3.703e+03 -3.716e+03                    #> Path [31] :Best Iter: [60] ELBO (-3703.374577) evaluations: (3517)  #> Path [32] :Initial log joint density = -481761.537049  #> Path [32] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      1.394e-02   2.838e-01    8.963e-01  8.963e-01      3158 -3.704e+03 -3.713e+03                    #> Path [32] :Best Iter: [55] ELBO (-3704.029984) evaluations: (3158)  #> Path [33] :Initial log joint density = -481554.694675  #> Path [33] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      7.932e-03   2.132e-01    1.000e+00  1.000e+00      3136 -3.705e+03 -3.702e+03                    #> Path [33] :Best Iter: [57] ELBO (-3701.993579) evaluations: (3136)  #> Path [34] :Initial log joint density = -481963.799370  #> Path [34] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      8.377e-03   2.332e-01    1.000e+00  1.000e+00      2984 -3.706e+03 -3.713e+03                    #> Path [34] :Best Iter: [50] ELBO (-3705.867559) evaluations: (2984)  #> Path [35] :Initial log joint density = -482960.293528  #> Path [35] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.154e-02   2.818e-01    1.000e+00  1.000e+00      3526 -3.697e+03 -3.702e+03                    #> Path [35] :Best Iter: [58] ELBO (-3697.086207) evaluations: (3526)  #> Path [36] :Initial log joint density = -481656.756750  #> Path [36] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      3.788e-03   3.025e-01    6.878e-01  6.878e-01      3009 -3.707e+03 -3.712e+03                    #> Path [36] :Best Iter: [53] ELBO (-3707.039803) evaluations: (3009)  #> Path [37] :Initial log joint density = -481939.012720  #> Path [37] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      7.886e-03   2.658e-01    3.790e-01  1.000e+00      3194 -3.700e+03 -3.710e+03                    #> Path [37] :Best Iter: [55] ELBO (-3700.056662) evaluations: (3194)  #> Path [38] :Initial log joint density = -481822.324303  #> Path [38] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      8.754e-03   2.633e-01    1.000e+00  1.000e+00      2863 -3.708e+03 -3.713e+03                    #> Path [38] :Best Iter: [39] ELBO (-3708.178629) evaluations: (2863)  #> Path [39] :Initial log joint density = -481739.106475  #> Path [39] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              51      -4.788e+05      1.189e-02   2.290e-01    1.000e+00  1.000e+00      2843 -3.708e+03 -3.714e+03                    #> Path [39] :Best Iter: [38] ELBO (-3707.636182) evaluations: (2843)  #> Path [40] :Initial log joint density = -482800.539786  #> Path [40] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      4.300e-03   1.928e-01    1.000e+00  1.000e+00      3274 -3.709e+03 -3.711e+03                    #> Path [40] :Best Iter: [46] ELBO (-3709.411645) evaluations: (3274)  #> Path [41] :Initial log joint density = -483385.661844  #> Path [41] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      9.836e-03   2.210e-01    1.000e+00  1.000e+00      3000 -3.707e+03 -3.715e+03                    #> Path [41] :Best Iter: [50] ELBO (-3707.167832) evaluations: (3000)  #> Path [42] :Initial log joint density = -483825.465883  #> Path [42] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      7.685e-03   2.274e-01    1.000e+00  1.000e+00      3339 -3.704e+03 -3.701e+03                    #> Path [42] :Best Iter: [57] ELBO (-3700.840420) evaluations: (3339)  #> Path [43] :Initial log joint density = -481728.987534  #> Path [43] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      1.318e-02   3.417e-01    1.000e+00  1.000e+00      3192 -3.699e+03 -3.710e+03                    #> Path [43] :Best Iter: [55] ELBO (-3699.200214) evaluations: (3192)  #> Path [44] :Initial log joint density = -481467.210701  #> Path [44] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      1.414e-02   2.725e-01    1.000e+00  1.000e+00      3388 -3.702e+03 -3.700e+03                    #> Path [44] :Best Iter: [57] ELBO (-3699.660046) evaluations: (3388)  #> Path [45] :Initial log joint density = -481645.531630  #> Path [45] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              63      -4.788e+05      5.013e-03   2.613e-01    5.816e-01  5.816e-01      3699 -3.702e+03 -3.708e+03                    #> Path [45] :Best Iter: [61] ELBO (-3701.514624) evaluations: (3699)  #> Path [46] :Initial log joint density = -482283.050293  #> Path [46] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      5.269e-03   2.756e-01    7.214e-01  7.214e-01      3242 -3.703e+03 -3.710e+03                    #> Path [46] :Best Iter: [55] ELBO (-3702.814929) evaluations: (3242)  #> Path [47] :Initial log joint density = -481681.147632  #> Path [47] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      8.959e-03   2.583e-01    8.825e-01  8.825e-01      2841 -3.710e+03 -3.722e+03                    #> Path [47] :Best Iter: [43] ELBO (-3709.520545) evaluations: (2841)  #> Path [48] :Initial log joint density = -481507.753719  #> Path [48] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      7.682e-03   2.902e-01    1.000e+00  1.000e+00      2783 -3.711e+03 -3.716e+03                    #> Path [48] :Best Iter: [48] ELBO (-3710.964563) evaluations: (2783)  #> Path [49] :Initial log joint density = -481603.454721  #> Path [49] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      5.728e-03   2.482e-01    1.000e+00  1.000e+00      3098 -3.707e+03 -3.710e+03                    #> Path [49] :Best Iter: [52] ELBO (-3707.484961) evaluations: (3098)  #> Path [50] :Initial log joint density = -484470.912936  #> Path [50] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      6.285e-03   2.172e-01    1.000e+00  1.000e+00      3230 -3.708e+03 -3.707e+03                    #> Path [50] :Best Iter: [57] ELBO (-3707.318398) evaluations: (3230)  #> Finished in  13.4 seconds. #> sccomp says: to do hypothesis testing run `sccomp_test()`, #>   the `test_composition_above_logit_fold_change` = 0.1 equates to a change of ~10%, and #>   0.7 equates to ~100% increase, if the baseline is ~0.1 proportion. #>   Use `sccomp_proportional_fold_change` to convert c_effect (linear) to proportion difference (non-linear). #> sccomp says: calculating residuals #> Loading model from cache... #> Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... #>  #> Chain 1 finished in 0.0 seconds. #> sccomp says: regressing out unwanted factors #> Loading model from cache... #> Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... #>  #> Chain 1 finished in 0.0 seconds. # }"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_remove_unwanted_variation.html","id":null,"dir":"Reference","previous_headings":"","what":"DEPRECATED: Remove Unwanted Variation from sccomp Estimates — sccomp_remove_unwanted_variation","title":"DEPRECATED: Remove Unwanted Variation from sccomp Estimates — sccomp_remove_unwanted_variation","text":"function DEPRECATED. Please use sccomp_remove_unwanted_effects instead. function uses model remove unwanted variation dataset using estimates model. example, fit data formula ~ factor_1 + factor_2 use formula ~ factor_1 remove unwanted variation, factor_2 effect factored .","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_remove_unwanted_variation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DEPRECATED: Remove Unwanted Variation from sccomp Estimates — sccomp_remove_unwanted_variation","text":"","code":"sccomp_remove_unwanted_variation(   .data,   formula_composition_keep = NULL,   formula_composition = NULL,   formula_variability = NULL,   cores = detectCores() )"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_remove_unwanted_variation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"DEPRECATED: Remove Unwanted Variation from sccomp Estimates — sccomp_remove_unwanted_variation","text":".data tibble. result sccomp_estimate. formula_composition_keep formula. formula describing model differential abundance, example ~type. case, effect type factor preserved, factors factored . formula_composition DEPRECATED. Use formula_composition_keep instead. formula_variability DEPRECATED. Use formula_variability_keep instead. cores Integer, number cores used parallel calculations.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_remove_unwanted_variation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"DEPRECATED: Remove Unwanted Variation from sccomp Estimates — sccomp_remove_unwanted_variation","text":"tibble (tbl) following columns: sample - character column representing sample name data adjusted. cell_group - character column representing cell group tested. adjusted_proportion - numeric column representing adjusted proportion removing unwanted variation. adjusted_counts - numeric column representing adjusted counts removing unwanted variation. logit_residuals - numeric column representing logit residuals calculated adjustment.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_remove_unwanted_variation.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"DEPRECATED: Remove Unwanted Variation from sccomp Estimates — sccomp_remove_unwanted_variation","text":"S. Mangiola, .J. Roth-Schulze, M. Trussart, E. Zozaya-Valdés, M. Ma, Z. Gao, .F. Rubin, T.P. Speed, H. Shim, & .T. Papenfuss, sccomp: Robust differential composition variability analysis single-cell data, Proc. Natl. Acad. Sci. U.S.. 120 (33) e2203828120, https://doi.org/10.1073/pnas.2203828120 (2023).","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_remove_unwanted_variation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"DEPRECATED: Remove Unwanted Variation from sccomp Estimates — sccomp_remove_unwanted_variation","text":"","code":"print(\"cmdstanr is needed to run this example.\") #> [1] \"cmdstanr is needed to run this example.\" # Note: Before running the example, ensure that the 'cmdstanr' package is installed: # install.packages(\"cmdstanr\", repos = c(\"https://stan-dev.r-universe.dev/\", getOption(\"repos\")))  # \\donttest{   if (instantiate::stan_cmdstan_exists()) {     data(\"counts_obj\")      estimates = sccomp_estimate(       counts_obj,       ~ type, ~1, \"sample\", \"cell_group\", \"count\",       cores = 1     ) |>     sccomp_remove_unwanted_variation()   } #> Warning: `sccomp_remove_unwanted_variation()` was deprecated in sccomp 1.99.20. #> ℹ sccomp says: sccomp_remove_unwanted_variation is deprecated. Please use #>   sccomp_remove_unwanted_effects() instead. #> sccomp says: count column is an integer. The sum-constrained beta binomial model will be used #> sccomp says: estimation #> sccomp says: the composition design matrix has columns: (Intercept), typecancer #> sccomp says: the variability design matrix has columns: (Intercept) #> Loading model from cache... #> Path [1] :Initial log joint density = -481906.161217  #> Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      8.562e-03   2.484e-01    1.000e+00  1.000e+00      3294 -3.707e+03 -3.703e+03                    #> Path [1] :Best Iter: [57] ELBO (-3702.602492) evaluations: (3294)  #> Path [2] :Initial log joint density = -484098.341258  #> Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      6.778e-03   2.713e-01    8.686e-01  8.686e-01      2940 -3.708e+03 -3.718e+03                    #> Path [2] :Best Iter: [44] ELBO (-3708.092441) evaluations: (2940)  #> Path [3] :Initial log joint density = -482276.976929  #> Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      5.453e-03   1.509e-01    1.000e+00  1.000e+00      3627 -3.701e+03 -3.710e+03                    #> Path [3] :Best Iter: [58] ELBO (-3701.206528) evaluations: (3627)  #> Path [4] :Initial log joint density = -481454.682013  #> Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      8.851e-03   2.083e-01    1.000e+00  1.000e+00      2776 -3.708e+03 -3.710e+03                    #> Path [4] :Best Iter: [50] ELBO (-3708.296816) evaluations: (2776)  #> Path [5] :Initial log joint density = -481243.288960  #> Path [5] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              51      -4.788e+05      5.534e-03   1.992e-01    1.000e+00  1.000e+00      2798 -3.707e+03 -3.715e+03                    #> Path [5] :Best Iter: [47] ELBO (-3707.417779) evaluations: (2798)  #> Path [6] :Initial log joint density = -486651.479622  #> Path [6] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      5.255e-03   2.415e-01    1.000e+00  1.000e+00      3364 -3.702e+03 -3.702e+03                    #> Path [6] :Best Iter: [55] ELBO (-3702.250691) evaluations: (3364)  #> Path [7] :Initial log joint density = -481626.469133  #> Path [7] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      7.114e-03   1.857e-01    9.258e-01  9.258e-01      3533 -3.698e+03 -3.709e+03                    #> Path [7] :Best Iter: [59] ELBO (-3697.642291) evaluations: (3533)  #> Path [8] :Initial log joint density = -481873.033489  #> Path [8] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      6.098e-03   2.112e-01    1.000e+00  1.000e+00      3068 -3.709e+03 -3.703e+03                    #> Path [8] :Best Iter: [55] ELBO (-3703.021570) evaluations: (3068)  #> Path [9] :Initial log joint density = -481714.868405  #> Path [9] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      7.257e-03   2.101e-01    1.000e+00  1.000e+00      3251 -3.707e+03 -3.713e+03                    #> Path [9] :Best Iter: [53] ELBO (-3706.920381) evaluations: (3251)  #> Path [10] :Initial log joint density = -481834.244627  #> Path [10] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      8.244e-03   2.458e-01    1.000e+00  1.000e+00      3053 -3.709e+03 -3.708e+03                    #> Path [10] :Best Iter: [56] ELBO (-3707.610559) evaluations: (3053)  #> Path [11] :Initial log joint density = -481881.983585  #> Path [11] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      8.431e-03   2.743e-01    1.000e+00  1.000e+00      3215 -3.706e+03 -3.712e+03                    #> Path [11] :Best Iter: [53] ELBO (-3706.324859) evaluations: (3215)  #> Path [12] :Initial log joint density = -481528.501027  #> Path [12] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      1.006e-02   2.023e-01    1.000e+00  1.000e+00      3238 -3.702e+03 -3.703e+03                    #> Path [12] :Best Iter: [56] ELBO (-3702.058273) evaluations: (3238)  #> Path [13] :Initial log joint density = -481650.421273  #> Path [13] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      5.183e-03   1.570e-01    7.086e-01  7.086e-01      3584 -3.700e+03 -3.715e+03                    #> Path [13] :Best Iter: [59] ELBO (-3699.517733) evaluations: (3584)  #> Path [14] :Initial log joint density = -481600.832143  #> Path [14] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      6.775e-03   2.206e-01    1.000e+00  1.000e+00      3440 -3.701e+03 -3.703e+03                    #> Path [14] :Best Iter: [58] ELBO (-3700.700434) evaluations: (3440)  #> Path [15] :Initial log joint density = -482074.882928  #> Path [15] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              65      -4.788e+05      8.848e-03   2.698e-01    4.538e-01  1.000e+00      3901 -3.699e+03 -3.709e+03                    #> Path [15] :Best Iter: [64] ELBO (-3699.202306) evaluations: (3901)  #> Path [16] :Initial log joint density = -481627.182239  #> Path [16] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              63      -4.788e+05      6.911e-03   2.022e-01    1.000e+00  1.000e+00      3769 -3.699e+03 -3.705e+03                    #> Path [16] :Best Iter: [56] ELBO (-3698.764343) evaluations: (3769)  #> Path [17] :Initial log joint density = -485594.612149  #> Path [17] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      1.096e-02   2.724e-01    9.589e-01  9.589e-01      3656 -3.701e+03 -3.710e+03                    #> Path [17] :Best Iter: [60] ELBO (-3700.683571) evaluations: (3656)  #> Path [18] :Initial log joint density = -481612.348749  #> Path [18] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              63      -4.788e+05      1.437e-02   2.514e-01    1.000e+00  1.000e+00      3825 -3.696e+03 -3.705e+03                    #> Path [18] :Best Iter: [61] ELBO (-3695.666436) evaluations: (3825)  #> Path [19] :Initial log joint density = -481575.489154  #> Path [19] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      8.790e-03   1.924e-01    1.000e+00  1.000e+00      3013 -3.706e+03 -3.711e+03                    #> Path [19] :Best Iter: [52] ELBO (-3705.751978) evaluations: (3013)  #> Path [20] :Initial log joint density = -481735.824434  #> Path [20] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      1.120e-02   3.114e-01    1.000e+00  1.000e+00      2844 -3.711e+03 -3.712e+03                    #> Path [20] :Best Iter: [39] ELBO (-3710.750126) evaluations: (2844)  #> Path [21] :Initial log joint density = -483270.734682  #> Path [21] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      6.694e-03   2.365e-01    1.000e+00  1.000e+00      3374 -3.703e+03 -3.705e+03                    #> Path [21] :Best Iter: [56] ELBO (-3703.451520) evaluations: (3374)  #> Path [22] :Initial log joint density = -485169.552171  #> Path [22] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      3.146e-03   3.034e-01    5.913e-01  5.913e-01      3477 -3.703e+03 -3.718e+03                    #> Path [22] :Best Iter: [55] ELBO (-3703.089370) evaluations: (3477)  #> Path [23] :Initial log joint density = -481723.851120  #> Path [23] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.504e-02   2.457e-01    8.213e-01  8.213e-01      3422 -3.701e+03 -3.704e+03                    #> Path [23] :Best Iter: [58] ELBO (-3701.141613) evaluations: (3422)  #> Path [24] :Initial log joint density = -482368.596519  #> Path [24] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      8.199e-03   1.851e-01    1.000e+00  1.000e+00      3344 -3.706e+03 -3.704e+03                    #> Path [24] :Best Iter: [57] ELBO (-3703.788527) evaluations: (3344)  #> Path [25] :Initial log joint density = -483501.409755  #> Path [25] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      8.932e-03   2.538e-01    9.943e-01  9.943e-01      3373 -3.697e+03 -3.706e+03                    #> Path [25] :Best Iter: [56] ELBO (-3696.557105) evaluations: (3373)  #> Path [26] :Initial log joint density = -481654.926918  #> Path [26] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      1.171e-02   2.235e-01    1.000e+00  1.000e+00      3391 -3.701e+03 -3.704e+03                    #> Path [26] :Best Iter: [59] ELBO (-3700.885647) evaluations: (3391)  #> Path [27] :Initial log joint density = -483015.505479  #> Path [27] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      8.689e-03   2.727e-01    1.000e+00  1.000e+00      2910 -3.709e+03 -3.721e+03                    #> Path [27] :Best Iter: [47] ELBO (-3709.226986) evaluations: (2910)  #> Path [28] :Initial log joint density = -481717.659059  #> Path [28] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      1.087e-02   3.249e-01    8.796e-01  8.796e-01      2869 -3.707e+03 -3.721e+03                    #> Path [28] :Best Iter: [50] ELBO (-3706.640062) evaluations: (2869)  #> Path [29] :Initial log joint density = -482474.937570  #> Path [29] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      2.701e-03   2.364e-01    6.160e-01  6.160e-01      3478 -3.703e+03 -3.710e+03                    #> Path [29] :Best Iter: [56] ELBO (-3702.601270) evaluations: (3478)  #> Path [30] :Initial log joint density = -484801.993153  #> Path [30] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      7.259e-03   2.707e-01    7.233e-01  7.233e-01      3187 -3.700e+03 -3.714e+03                    #> Path [30] :Best Iter: [55] ELBO (-3700.238412) evaluations: (3187)  #> Path [31] :Initial log joint density = -481932.006402  #> Path [31] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      1.600e-02   2.528e-01    1.000e+00  1.000e+00      3122 -3.705e+03 -3.712e+03                    #> Path [31] :Best Iter: [47] ELBO (-3704.507582) evaluations: (3122)  #> Path [32] :Initial log joint density = -483725.520998  #> Path [32] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      9.539e-03   3.448e-01    3.649e-01  1.000e+00      3333 -3.700e+03 -3.710e+03                    #> Path [32] :Best Iter: [57] ELBO (-3700.047236) evaluations: (3333)  #> Path [33] :Initial log joint density = -481949.457732  #> Path [33] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      5.210e-03   3.383e-01    5.668e-01  5.668e-01      3450 -3.702e+03 -3.710e+03                    #> Path [33] :Best Iter: [58] ELBO (-3701.594214) evaluations: (3450)  #> Path [34] :Initial log joint density = -482072.537571  #> Path [34] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              64      -4.788e+05      5.517e-03   1.381e-01    1.000e+00  1.000e+00      3970 -3.702e+03 -3.709e+03                    #> Path [34] :Best Iter: [56] ELBO (-3701.931801) evaluations: (3970)  #> Path [35] :Initial log joint density = -481945.853146  #> Path [35] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      8.160e-03   2.308e-01    9.493e-01  9.493e-01      3519 -3.701e+03 -3.707e+03                    #> Path [35] :Best Iter: [59] ELBO (-3700.728299) evaluations: (3519)  #> Path [36] :Initial log joint density = -481703.255672  #> Path [36] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      7.485e-03   1.680e-01    1.000e+00  1.000e+00      3102 -3.707e+03 -3.717e+03                    #> Path [36] :Best Iter: [45] ELBO (-3706.579302) evaluations: (3102)  #> Path [37] :Initial log joint density = -482806.970879  #> Path [37] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      8.435e-03   3.826e-01    5.103e-01  1.000e+00      3211 -3.707e+03 -3.708e+03                    #> Path [37] :Best Iter: [45] ELBO (-3707.151635) evaluations: (3211)  #> Path [38] :Initial log joint density = -482020.748849  #> Path [38] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      7.403e-03   2.646e-01    1.000e+00  1.000e+00      3322 -3.701e+03 -3.708e+03                    #> Path [38] :Best Iter: [55] ELBO (-3701.462230) evaluations: (3322)  #> Path [39] :Initial log joint density = -481584.191255  #> Path [39] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      1.195e-02   3.600e-01    1.000e+00  1.000e+00      3109 -3.700e+03 -3.707e+03                    #> Path [39] :Best Iter: [55] ELBO (-3699.935281) evaluations: (3109)  #> Path [40] :Initial log joint density = -481986.122779  #> Path [40] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      8.667e-03   2.958e-01    1.000e+00  1.000e+00      3371 -3.700e+03 -3.708e+03                    #> Path [40] :Best Iter: [57] ELBO (-3699.811210) evaluations: (3371)  #> Path [41] :Initial log joint density = -481667.392480  #> Path [41] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      8.503e-03   2.471e-01    1.000e+00  1.000e+00      2890 -3.709e+03 -3.717e+03                    #> Path [41] :Best Iter: [41] ELBO (-3709.207836) evaluations: (2890)  #> Path [42] :Initial log joint density = -481712.727730  #> Path [42] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      9.028e-03   2.922e-01    1.000e+00  1.000e+00      3352 -3.697e+03 -3.709e+03                    #> Path [42] :Best Iter: [58] ELBO (-3697.246763) evaluations: (3352)  #> Path [43] :Initial log joint density = -481476.995909  #> Path [43] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      1.238e-02   2.913e-01    1.000e+00  1.000e+00      3148 -3.705e+03 -3.704e+03                    #> Path [43] :Best Iter: [57] ELBO (-3704.277374) evaluations: (3148)  #> Path [44] :Initial log joint density = -481846.253158  #> Path [44] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      8.136e-03   2.213e-01    7.975e-01  7.975e-01      3439 -3.700e+03 -3.709e+03                    #> Path [44] :Best Iter: [57] ELBO (-3699.911809) evaluations: (3439)  #> Path [45] :Initial log joint density = -484331.085093  #> Path [45] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      2.495e-03   3.019e-01    6.102e-01  6.102e-01      3453 -3.701e+03 -3.716e+03                    #> Path [45] :Best Iter: [56] ELBO (-3701.002240) evaluations: (3453)  #> Path [46] :Initial log joint density = -481475.604204  #> Path [46] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              51      -4.788e+05      1.280e-02   2.882e-01    1.000e+00  1.000e+00      2748 -3.708e+03 -3.718e+03                    #> Path [46] :Best Iter: [40] ELBO (-3707.825072) evaluations: (2748)  #> Path [47] :Initial log joint density = -481290.039507  #> Path [47] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      5.688e-03   1.885e-01    1.000e+00  1.000e+00      2909 -3.710e+03 -3.721e+03                    #> Path [47] :Best Iter: [39] ELBO (-3709.964485) evaluations: (2909)  #> Path [48] :Initial log joint density = -481453.840799  #> Path [48] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      5.847e-03   2.046e-01    1.000e+00  1.000e+00      3570 -3.701e+03 -3.704e+03                    #> Path [48] :Best Iter: [56] ELBO (-3701.425825) evaluations: (3570)  #> Path [49] :Initial log joint density = -481688.501072  #> Path [49] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      7.642e-03   2.070e-01    1.000e+00  1.000e+00      3212 -3.704e+03 -3.699e+03                    #> Path [49] :Best Iter: [56] ELBO (-3698.753639) evaluations: (3212)  #> Path [50] :Initial log joint density = -481880.497602  #> Path [50] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      1.253e-02   4.072e-01    1.000e+00  1.000e+00      3248 -3.701e+03 -3.710e+03                    #> Path [50] :Best Iter: [56] ELBO (-3700.642528) evaluations: (3248)  #> Finished in  13.7 seconds. #> sccomp says: to do hypothesis testing run `sccomp_test()`, #>   the `test_composition_above_logit_fold_change` = 0.1 equates to a change of ~10%, and #>   0.7 equates to ~100% increase, if the baseline is ~0.1 proportion. #>   Use `sccomp_proportional_fold_change` to convert c_effect (linear) to proportion difference (non-linear). #> sccomp says: calculating residuals #> Loading model from cache... #> Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... #>  #> Chain 1 finished in 0.0 seconds. #> sccomp says: regressing out unwanted factors #> Loading model from cache... #> Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... #>  #> Chain 1 finished in 0.0 seconds. # }"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_replicate.html","id":null,"dir":"Reference","previous_headings":"","what":"sccomp_replicate — sccomp_replicate","title":"sccomp_replicate — sccomp_replicate","text":"function replicates counts real-world dataset.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_replicate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"sccomp_replicate — sccomp_replicate","text":"","code":"sccomp_replicate(   fit,   formula_composition = NULL,   formula_variability = NULL,   number_of_draws = 1,   mcmc_seed = sample_seed(),   cache_stan_model = sccomp_stan_models_cache_dir )"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_replicate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"sccomp_replicate — sccomp_replicate","text":"fit result sccomp_estimate. formula_composition formula. formula describing model differential abundance, example ~treatment. formula can sub-formula estimated model; case factor factored . formula_variability formula. formula describing model differential variability, example ~treatment. cases, differentially variability interest, formula include factor interest large anount data needed define variability depending factors. formula can sub-formula estimated model; case factor factored . number_of_draws integer. may copies data want draw model joint posterior distribution. mcmc_seed integer. Used Markov-chain Monte Carlo reproducibility. default random number sampled 1 999999. can controlled set.seed() cache_stan_model character string specifying cache directory compiled Stan models. sccomp version automatically appended ensure version isolation. Default sccomp_stan_models_cache_dir points ~/.sccomp_models.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_replicate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"sccomp_replicate — sccomp_replicate","text":"tibble tbl cell_group-wise statistics tibble (tbl), following columns: cell_group - character column representing cell group tested. sample - factor column representing sample name data generated. generated_proportions - numeric column representing proportions generated model. generated_counts - integer column representing counts generated model. replicate - integer column representing replicate number, row corresponds different replicate data.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_replicate.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"sccomp_replicate — sccomp_replicate","text":"S. Mangiola, .J. Roth-Schulze, M. Trussart, E. Zozaya-Valdés, M. Ma, Z. Gao, .F. Rubin, T.P. Speed, H. Shim, & .T. Papenfuss, sccomp: Robust differential composition variability analysis single-cell data, Proc. Natl. Acad. Sci. U.S.. 120 (33) e2203828120, https://doi.org/10.1073/pnas.2203828120 (2023).","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_replicate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"sccomp_replicate — sccomp_replicate","text":"","code":"print(\"cmdstanr is needed to run this example.\") #> [1] \"cmdstanr is needed to run this example.\" # Note: Before running the example, ensure that the 'cmdstanr' package is installed: # install.packages(\"cmdstanr\", repos = c(\"https://stan-dev.r-universe.dev/\", getOption(\"repos\")))  # \\donttest{   if (instantiate::stan_cmdstan_exists() && .Platform$OS.type == \"unix\") {     data(\"counts_obj\")      sccomp_estimate(       counts_obj,       ~ type, ~1, \"sample\", \"cell_group\", \"count\",       cores = 1     ) |>     sccomp_replicate()   } #> sccomp says: count column is an integer. The sum-constrained beta binomial model will be used #> sccomp says: estimation #> sccomp says: the composition design matrix has columns: (Intercept), typecancer #> sccomp says: the variability design matrix has columns: (Intercept) #> Loading model from cache... #> Path [1] :Initial log joint density = -481857.352512  #> Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      1.072e-02   2.772e-01    5.264e-01  1.000e+00      3071 -3.708e+03 -3.708e+03                    #> Path [1] :Best Iter: [55] ELBO (-3707.571304) evaluations: (3071)  #> Path [2] :Initial log joint density = -481263.536047  #> Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      5.827e-03   2.019e-01    9.344e-01  9.344e-01      2832 -3.706e+03 -3.721e+03                    #> Path [2] :Best Iter: [51] ELBO (-3706.222412) evaluations: (2832)  #> Path [3] :Initial log joint density = -481682.009281  #> Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      1.229e-02   2.397e-01    1.000e+00  1.000e+00      2995 -3.706e+03 -3.709e+03                    #> Path [3] :Best Iter: [53] ELBO (-3705.821053) evaluations: (2995)  #> Path [4] :Initial log joint density = -482140.254034  #> Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              62      -4.788e+05      7.059e-03   2.271e-01    1.000e+00  1.000e+00      3674 -3.699e+03 -3.703e+03                    #> Path [4] :Best Iter: [58] ELBO (-3699.287060) evaluations: (3674)  #> Path [5] :Initial log joint density = -481199.527570  #> Path [5] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      8.464e-03   2.567e-01    1.000e+00  1.000e+00      3262 -3.706e+03 -3.701e+03                    #> Path [5] :Best Iter: [56] ELBO (-3701.142608) evaluations: (3262)  #> Path [6] :Initial log joint density = -481725.049984  #> Path [6] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      1.072e-02   2.604e-01    1.000e+00  1.000e+00      3535 -3.704e+03 -3.702e+03                    #> Path [6] :Best Iter: [60] ELBO (-3702.251819) evaluations: (3535)  #> Path [7] :Initial log joint density = -482410.654722  #> Path [7] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      1.476e-02   2.443e-01    1.000e+00  1.000e+00      3028 -3.708e+03 -3.702e+03                    #> Path [7] :Best Iter: [55] ELBO (-3701.535344) evaluations: (3028)  #> Path [8] :Initial log joint density = -481492.383749  #> Path [8] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              51      -4.788e+05      5.169e-03   1.952e-01    8.410e-01  8.410e-01      2797 -3.705e+03 -3.730e+03                    #> Path [8] :Best Iter: [49] ELBO (-3705.492961) evaluations: (2797)  #> Path [9] :Initial log joint density = -481764.651131  #> Path [9] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      5.950e-03   2.214e-01    8.903e-01  8.903e-01      3195 -3.708e+03 -3.709e+03                    #> Path [9] :Best Iter: [55] ELBO (-3707.559354) evaluations: (3195)  #> Path [10] :Initial log joint density = -481473.116263  #> Path [10] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      6.949e-03   2.365e-01    9.878e-01  9.878e-01      3106 -3.708e+03 -3.708e+03                    #> Path [10] :Best Iter: [55] ELBO (-3708.196652) evaluations: (3106)  #> Path [11] :Initial log joint density = -481891.986901  #> Path [11] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      4.274e-03   3.115e-01    6.483e-01  6.483e-01      3434 -3.700e+03 -3.712e+03                    #> Path [11] :Best Iter: [55] ELBO (-3700.273471) evaluations: (3434)  #> Path [12] :Initial log joint density = -485313.233904  #> Path [12] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.410e-02   2.247e-01    1.000e+00  1.000e+00      3533 -3.701e+03 -3.703e+03                    #> Path [12] :Best Iter: [58] ELBO (-3701.117858) evaluations: (3533)  #> Path [13] :Initial log joint density = -481941.573464  #> Path [13] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              62      -4.788e+05      8.342e-03   2.283e-01    1.000e+00  1.000e+00      3620 -3.701e+03 -3.699e+03                    #> Path [13] :Best Iter: [62] ELBO (-3698.763517) evaluations: (3620)  #> Path [14] :Initial log joint density = -483622.857925  #> Path [14] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      6.939e-03   2.252e-01    1.000e+00  1.000e+00      2957 -3.707e+03 -3.718e+03                    #> Path [14] :Best Iter: [48] ELBO (-3706.710122) evaluations: (2957)  #> Path [15] :Initial log joint density = -481675.727968  #> Path [15] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      7.896e-03   3.260e-01    1.000e+00  1.000e+00      3122 -3.710e+03 -3.706e+03                    #> Path [15] :Best Iter: [55] ELBO (-3706.202511) evaluations: (3122)  #> Path [16] :Initial log joint density = -482002.369050  #> Path [16] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      4.629e-03   1.253e-01    8.056e-01  8.056e-01      3591 -3.702e+03 -3.713e+03                    #> Path [16] :Best Iter: [59] ELBO (-3702.227555) evaluations: (3591)  #> Path [17] :Initial log joint density = -481920.783513  #> Path [17] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      7.711e-03   2.751e-01    7.667e-01  7.667e-01      3265 -3.702e+03 -3.712e+03                    #> Path [17] :Best Iter: [55] ELBO (-3702.310919) evaluations: (3265)  #> Path [18] :Initial log joint density = -482555.134240  #> Path [18] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.475e-02   2.071e-01    1.000e+00  1.000e+00      3423 -3.703e+03 -3.702e+03                    #> Path [18] :Best Iter: [59] ELBO (-3702.209607) evaluations: (3423)  #> Path [19] :Initial log joint density = -483990.222971  #> Path [19] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      1.523e-02   2.670e-01    1.000e+00  1.000e+00      2986 -3.709e+03 -3.713e+03                    #> Path [19] :Best Iter: [45] ELBO (-3708.950406) evaluations: (2986)  #> Path [20] :Initial log joint density = -482014.813191  #> Path [20] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              64      -4.788e+05      1.657e-02   3.120e-01    5.113e-01  1.000e+00      4007 -3.697e+03 -3.704e+03                    #> Path [20] :Best Iter: [63] ELBO (-3697.371682) evaluations: (4007)  #> Path [21] :Initial log joint density = -481670.996419  #> Path [21] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      1.855e-02   2.302e-01    1.000e+00  1.000e+00      3257 -3.704e+03 -3.701e+03                    #> Path [21] :Best Iter: [56] ELBO (-3701.343670) evaluations: (3257)  #> Path [22] :Initial log joint density = -481388.051225  #> Path [22] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      2.757e-03   2.124e-01    7.642e-01  7.642e-01      2961 -3.702e+03 -3.722e+03                    #> Path [22] :Best Iter: [51] ELBO (-3701.973754) evaluations: (2961)  #> Path [23] :Initial log joint density = -481692.347937  #> Path [23] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      1.635e-02   4.033e-01    1.000e+00  1.000e+00      2854 -3.705e+03 -3.710e+03                    #> Path [23] :Best Iter: [51] ELBO (-3704.532218) evaluations: (2854)  #> Path [24] :Initial log joint density = -485362.943854  #> Path [24] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      1.433e-02   3.109e-01    1.000e+00  1.000e+00      3298 -3.700e+03 -3.699e+03                    #> Path [24] :Best Iter: [57] ELBO (-3699.150335) evaluations: (3298)  #> Path [25] :Initial log joint density = -482234.963368  #> Path [25] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              63      -4.788e+05      7.803e-03   2.127e-01    1.000e+00  1.000e+00      3772 -3.700e+03 -3.707e+03                    #> Path [25] :Best Iter: [61] ELBO (-3699.817680) evaluations: (3772)  #> Path [26] :Initial log joint density = -481655.402253  #> Path [26] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      8.741e-03   2.851e-01    1.000e+00  1.000e+00      3008 -3.706e+03 -3.715e+03                    #> Path [26] :Best Iter: [48] ELBO (-3705.940808) evaluations: (3008)  #> Path [27] :Initial log joint density = -481701.413051  #> Path [27] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      4.501e-03   2.471e-01    7.866e-01  7.866e-01      3160 -3.702e+03 -3.717e+03                    #> Path [27] :Best Iter: [55] ELBO (-3702.091432) evaluations: (3160)  #> Path [28] :Initial log joint density = -481836.262825  #> Path [28] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      1.455e-02   3.698e-01    1.000e+00  1.000e+00      3229 -3.704e+03 -3.711e+03                    #> Path [28] :Best Iter: [55] ELBO (-3704.314872) evaluations: (3229)  #> Path [29] :Initial log joint density = -481614.553185  #> Path [29] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      9.436e-03   2.493e-01    1.000e+00  1.000e+00      3036 -3.706e+03 -3.712e+03                    #> Path [29] :Best Iter: [42] ELBO (-3705.607002) evaluations: (3036)  #> Path [30] :Initial log joint density = -481713.050002  #> Path [30] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      1.191e-02   3.243e-01    1.000e+00  1.000e+00      2991 -3.707e+03 -3.711e+03                    #> Path [30] :Best Iter: [43] ELBO (-3707.342788) evaluations: (2991)  #> Path [31] :Initial log joint density = -481273.168557  #> Path [31] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      1.180e-02   3.834e-01    1.000e+00  1.000e+00      2991 -3.708e+03 -3.724e+03                    #> Path [31] :Best Iter: [46] ELBO (-3708.080784) evaluations: (2991)  #> Path [32] :Initial log joint density = -482887.927356  #> Path [32] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      5.487e-03   2.747e-01    8.353e-01  8.353e-01      3240 -3.701e+03 -3.712e+03                    #> Path [32] :Best Iter: [55] ELBO (-3701.287790) evaluations: (3240)  #> Path [33] :Initial log joint density = -481609.144559  #> Path [33] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      5.730e-03   1.959e-01    1.000e+00  1.000e+00      3109 -3.709e+03 -3.710e+03                    #> Path [33] :Best Iter: [52] ELBO (-3708.953872) evaluations: (3109)  #> Path [34] :Initial log joint density = -481418.022135  #> Path [34] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      3.530e-03   3.964e-01    5.809e-01  5.809e-01      3105 -3.705e+03 -3.716e+03                    #> Path [34] :Best Iter: [44] ELBO (-3705.113596) evaluations: (3105)  #> Path [35] :Initial log joint density = -482064.760528  #> Path [35] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              62      -4.788e+05      9.423e-03   2.904e-01    1.000e+00  1.000e+00      3769 -3.701e+03 -3.703e+03                    #> Path [35] :Best Iter: [58] ELBO (-3700.742872) evaluations: (3769)  #> Path [36] :Initial log joint density = -481767.303765  #> Path [36] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      1.773e-02   2.734e-01    9.345e-01  9.345e-01      3385 -3.698e+03 -3.706e+03                    #> Path [36] :Best Iter: [56] ELBO (-3697.731451) evaluations: (3385)  #> Path [37] :Initial log joint density = -481623.902326  #> Path [37] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      5.502e-03   2.003e-01    1.000e+00  1.000e+00      3175 -3.705e+03 -3.705e+03                    #> Path [37] :Best Iter: [56] ELBO (-3704.765860) evaluations: (3175)  #> Path [38] :Initial log joint density = -481752.940232  #> Path [38] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      8.280e-03   3.445e-01    4.339e-01  1.000e+00      2995 -3.708e+03 -3.724e+03                    #> Path [38] :Best Iter: [43] ELBO (-3707.820251) evaluations: (2995)  #> Path [39] :Initial log joint density = -484948.503389  #> Path [39] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      1.485e-02   2.450e-01    1.000e+00  1.000e+00      3421 -3.699e+03 -3.700e+03                    #> Path [39] :Best Iter: [56] ELBO (-3698.527984) evaluations: (3421)  #> Path [40] :Initial log joint density = -481848.889677  #> Path [40] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      1.201e-02   2.555e-01    1.000e+00  1.000e+00      2833 -3.707e+03 -3.715e+03                    #> Path [40] :Best Iter: [50] ELBO (-3707.268683) evaluations: (2833)  #> Path [41] :Initial log joint density = -481662.350201  #> Path [41] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      9.771e-03   2.258e-01    8.547e-01  8.547e-01      3057 -3.706e+03 -3.729e+03                    #> Path [41] :Best Iter: [46] ELBO (-3705.677210) evaluations: (3057)  #> Path [42] :Initial log joint density = -481495.192395  #> Path [42] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      5.654e-03   2.112e-01    1.000e+00  1.000e+00      3136 -3.706e+03 -3.704e+03                    #> Path [42] :Best Iter: [57] ELBO (-3703.954043) evaluations: (3136)  #> Path [43] :Initial log joint density = -481617.743788  #> Path [43] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.126e-02   2.771e-01    1.000e+00  1.000e+00      3345 -3.702e+03 -3.703e+03                    #> Path [43] :Best Iter: [55] ELBO (-3701.908004) evaluations: (3345)  #> Path [44] :Initial log joint density = -481347.701139  #> Path [44] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      1.230e-02   3.035e-01    1.000e+00  1.000e+00      2874 -3.707e+03 -3.711e+03                    #> Path [44] :Best Iter: [41] ELBO (-3706.825189) evaluations: (2874)  #> Path [45] :Initial log joint density = -481616.840901  #> Path [45] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      7.657e-03   2.598e-01    1.000e+00  1.000e+00      3093 -3.708e+03 -3.711e+03                    #> Path [45] :Best Iter: [52] ELBO (-3707.982397) evaluations: (3093)  #> Path [46] :Initial log joint density = -481830.077846  #> Path [46] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      5.780e-03   1.912e-01    1.000e+00  1.000e+00      3158 -3.708e+03 -3.708e+03                    #> Path [46] :Best Iter: [56] ELBO (-3707.677671) evaluations: (3158)  #> Path [47] :Initial log joint density = -481725.120970  #> Path [47] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      5.041e-03   1.511e-01    1.000e+00  1.000e+00      2925 -3.707e+03 -3.716e+03                    #> Path [47] :Best Iter: [50] ELBO (-3706.618925) evaluations: (2925)  #> Path [48] :Initial log joint density = -481673.716321  #> Path [48] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      1.061e-02   2.269e-01    1.000e+00  1.000e+00      3343 -3.700e+03 -3.699e+03                    #> Path [48] :Best Iter: [58] ELBO (-3698.712217) evaluations: (3343)  #> Path [49] :Initial log joint density = -481548.724803  #> Path [49] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      5.468e-03   3.233e-01    6.704e-01  6.704e-01      3121 -3.712e+03 -3.717e+03                    #> Path [49] :Best Iter: [40] ELBO (-3712.300190) evaluations: (3121)  #> Path [50] :Initial log joint density = -482713.963241  #> Path [50] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      1.371e-02   2.222e-01    1.000e+00  1.000e+00      3437 -3.700e+03 -3.698e+03                    #> Path [50] :Best Iter: [58] ELBO (-3697.583389) evaluations: (3437)  #> Finished in  13.3 seconds. #> sccomp says: to do hypothesis testing run `sccomp_test()`, #>   the `test_composition_above_logit_fold_change` = 0.1 equates to a change of ~10%, and #>   0.7 equates to ~100% increase, if the baseline is ~0.1 proportion. #>   Use `sccomp_proportional_fold_change` to convert c_effect (linear) to proportion difference (non-linear). #> Loading model from cache... #> Running standalone generated quantities after 1 MCMC chain, with 1 thread(s) per chain... #>  #> Chain 1 finished in 0.0 seconds. #> # A tibble: 720 × 5 #>    cell_group sample       generated_proportions generated_counts replicate #>    <chr>      <fct>                        <dbl>            <int>     <int> #>  1 B1         10x_6K                      0.0387              193         1 #>  2 B1         10x_8K                      0.0222              110         1 #>  3 B1         GSE115189                   0.0721              360         1 #>  4 B1         SCP345_580                  0.0738              368         1 #>  5 B1         SCP345_860                  0.0384              191         1 #>  6 B1         SCP424_pbmc1                0.0525              262         1 #>  7 B1         SCP424_pbmc2                0.0701              350         1 #>  8 B1         SCP591                      0.0676              337         1 #>  9 B1         SI-GA-E5                    0.0422              210         1 #> 10 B1         SI-GA-E7                    0.0185               92         1 #> # ℹ 710 more rows # }"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_stan_models_cache_dir.html","id":null,"dir":"Reference","previous_headings":"","what":"Default cache directory for Stan models — sccomp_stan_models_cache_dir","title":"Default cache directory for Stan models — sccomp_stan_models_cache_dir","text":"global variable defines default cache directory Stan models used sccomp package. directory used store compiled Stan models avoid recompilation subsequent runs.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_stan_models_cache_dir.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default cache directory for Stan models — sccomp_stan_models_cache_dir","text":"","code":"sccomp_stan_models_cache_dir"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_stan_models_cache_dir.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Default cache directory for Stan models — sccomp_stan_models_cache_dir","text":"object class character length 1.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_stan_models_cache_dir.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Default cache directory for Stan models — sccomp_stan_models_cache_dir","text":"character string containing path default cache directory.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_stan_models_cache_dir.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Default cache directory for Stan models — sccomp_stan_models_cache_dir","text":"cache directory set ~/.sccomp_models default. location used various sccomp functions store retrieve compiled Stan models, improving performance avoiding unnecessary recompilation models already compiled. Users can override default specifying different cache directory function calls accept cache_stan_model parameter.","code":""},{"path":[]},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_stan_models_cache_dir.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Default cache directory for Stan models — sccomp_stan_models_cache_dir","text":"","code":"# View the default cache directory sccomp_stan_models_cache_dir #> [1] \"/home/runner/.sccomp_models\"  # Use a custom cache directory in a function call # sccomp_estimate(data, cache_stan_model = \"/path/to/custom/cache\")"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_test.html","id":null,"dir":"Reference","previous_headings":"","what":"sccomp_test — sccomp_test","title":"sccomp_test — sccomp_test","text":"function test contrasts sccomp result.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"sccomp_test — sccomp_test","text":"","code":"sccomp_test(   .data,   contrasts = NULL,   percent_false_positive = 5,   test_composition_above_logit_fold_change = 0.1,   pass_fit = TRUE )"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"sccomp_test — sccomp_test","text":".data tibble. result sccomp_estimate. contrasts vector character strings. example formula ~ 0 + treatment factor treatment values yes , contrast \"constrasts = c(treatmentyes - treatmentno)\". percent_false_positive real 0 100 non included. used identify outliers specific false positive rate. test_composition_above_logit_fold_change positive integer. effect threshold used hypothesis test. value 0.2 correspond change cell proportion 10% cell type baseline proportion 50%. , cell type goes 45% 50%. baseline proportion closer 0 1 effect thrshold consistent value logit uncontrained scale. pass_fit boolean. Whether pass Stan fit attribute output. Stan fit can large, setting FALSE can used lower memory imprint save output.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"sccomp_test — sccomp_test","text":"tibble (tbl), following columns: cell_group - cell groups tested. parameter - parameter estimated design matrix described input formula_composition formula_variability. factor - covariate factor formula, applicable (e.g., present Intercept contrasts). c_lower - Lower (2.5%) quantile posterior distribution composition (c) parameter. c_effect - Mean posterior distribution composition (c) parameter. c_upper - Upper (97.5%) quantile posterior distribution composition (c) parameter. c_pH0 - Probability c_effect smaller bigger test_composition_above_logit_fold_change argument. c_FDR - False-discovery rate null hypothesis (difference) composition (c). c_n_eff - Effective sample size - number independent draws sample, higher better. c_R_k_hat - R statistic, measure chain equilibrium, within 0.05 1.0. v_lower - Lower (2.5%) quantile posterior distribution variability (v) parameter. v_effect - Mean posterior distribution variability (v) parameter. v_upper - Upper (97.5%) quantile posterior distribution variability (v) parameter. v_pH0 - Probability null hypothesis (difference) variability (v). v_FDR - False-discovery rate null hypothesis (difference) variability (v). v_n_eff - Effective sample size variability (v) parameter. v_R_k_hat - R statistic variability (v) parameter. count_data - Nested input count data.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_test.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"sccomp_test — sccomp_test","text":"S. Mangiola, .J. Roth-Schulze, M. Trussart, E. Zozaya-Valdés, M. Ma, Z. Gao, .F. Rubin, T.P. Speed, H. Shim, & .T. Papenfuss, sccomp: Robust differential composition variability analysis single-cell data, Proc. Natl. Acad. Sci. U.S.. 120 (33) e2203828120, https://doi.org/10.1073/pnas.2203828120 (2023).","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"sccomp_test — sccomp_test","text":"","code":"print(\"cmdstanr is needed to run this example.\") #> [1] \"cmdstanr is needed to run this example.\" # Note: Before running the example, ensure that the 'cmdstanr' package is installed: # install.packages(\"cmdstanr\", repos = c(\"https://stan-dev.r-universe.dev/\", getOption(\"repos\")))  # \\donttest{   if (instantiate::stan_cmdstan_exists()) {     data(\"counts_obj\")      estimates = sccomp_estimate(       counts_obj,       ~ 0 + type, ~1, \"sample\", \"cell_group\", \"count\",       cores = 1     ) |>     sccomp_test(\"typecancer - typebenign\")   } #> sccomp says: count column is an integer. The sum-constrained beta binomial model will be used #> sccomp says: estimation #> sccomp says: the composition design matrix has columns: typebenign, typecancer #> sccomp says: the variability design matrix has columns: (Intercept) #> Loading model from cache... #> Path [1] :Initial log joint density = -481303.530436  #> Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              45      -4.788e+05      9.809e-03   1.883e-01    1.000e+00  1.000e+00      2291 -3.711e+03 -3.718e+03                    #> Path [1] :Best Iter: [43] ELBO (-3710.710309) evaluations: (2291)  #> Path [2] :Initial log joint density = -481566.115092  #> Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              49      -4.788e+05      8.739e-03   2.117e-01    1.000e+00  1.000e+00      2609 -3.711e+03 -3.713e+03                    #> Path [2] :Best Iter: [47] ELBO (-3711.234545) evaluations: (2609)  #> Path [3] :Initial log joint density = -481544.454138  #> Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              44      -4.788e+05      1.124e-02   2.488e-01    1.000e+00  1.000e+00      2261 -3.712e+03 -3.713e+03                    #> Path [3] :Best Iter: [42] ELBO (-3712.276695) evaluations: (2261)  #> Path [4] :Initial log joint density = -481545.658552  #> Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      1.241e-02   1.763e-01    1.000e+00  1.000e+00      2845 -3.710e+03 -3.713e+03                    #> Path [4] :Best Iter: [51] ELBO (-3710.395538) evaluations: (2845)  #> Path [5] :Initial log joint density = -481673.297594  #> Path [5] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              51      -4.788e+05      1.038e-02   1.998e-01    1.000e+00  1.000e+00      2776 -3.709e+03 -3.712e+03                    #> Path [5] :Best Iter: [39] ELBO (-3708.971079) evaluations: (2776)  #> Path [6] :Initial log joint density = -481504.442156  #> Path [6] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              46      -4.788e+05      9.437e-03   1.768e-01    9.215e-01  9.215e-01      2410 -3.710e+03 -3.713e+03                    #> Path [6] :Best Iter: [38] ELBO (-3710.120462) evaluations: (2410)  #> Path [7] :Initial log joint density = -482389.462721  #> Path [7] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              48      -4.788e+05      1.546e-02   2.710e-01    9.756e-01  9.756e-01      2564 -3.712e+03 -3.715e+03                    #> Path [7] :Best Iter: [45] ELBO (-3711.701259) evaluations: (2564)  #> Path [8] :Initial log joint density = -482679.552962  #> Path [8] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              50      -4.788e+05      1.620e-02   2.303e-01    1.000e+00  1.000e+00      2747 -3.712e+03 -3.731e+03                    #> Path [8] :Best Iter: [44] ELBO (-3712.026057) evaluations: (2747)  #> Path [9] :Initial log joint density = -481192.480635  #> Path [9] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              47      -4.788e+05      1.187e-02   2.548e-01    1.000e+00  1.000e+00      2574 -3.709e+03 -3.711e+03                    #> Path [9] :Best Iter: [37] ELBO (-3708.716667) evaluations: (2574)  #> Path [10] :Initial log joint density = -481547.872009  #> Path [10] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              45      -4.788e+05      8.353e-03   2.079e-01    1.000e+00  1.000e+00      2309 -3.709e+03 -3.712e+03                    #> Path [10] :Best Iter: [39] ELBO (-3708.868858) evaluations: (2309)  #> Path [11] :Initial log joint density = -481762.886737  #> Path [11] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              50      -4.788e+05      1.092e-02   1.548e-01    1.000e+00  1.000e+00      2753 -3.710e+03 -3.715e+03                    #> Path [11] :Best Iter: [48] ELBO (-3710.259701) evaluations: (2753)  #> Path [12] :Initial log joint density = -481640.004775  #> Path [12] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              51      -4.788e+05      1.119e-02   2.287e-01    1.000e+00  1.000e+00      2699 -3.711e+03 -3.712e+03                    #> Path [12] :Best Iter: [50] ELBO (-3711.338625) evaluations: (2699)  #> Path [13] :Initial log joint density = -481265.547735  #> Path [13] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              49      -4.788e+05      6.454e-03   1.731e-01    1.000e+00  1.000e+00      2545 -3.712e+03 -3.715e+03                    #> Path [13] :Best Iter: [43] ELBO (-3712.212144) evaluations: (2545)  #> Path [14] :Initial log joint density = -483259.060751  #> Path [14] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              45      -4.788e+05      5.792e-03   1.423e-01    7.922e-01  7.922e-01      2374 -3.710e+03 -3.718e+03                    #> Path [14] :Best Iter: [44] ELBO (-3709.788362) evaluations: (2374)  #> Path [15] :Initial log joint density = -481336.208675  #> Path [15] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              47      -4.788e+05      6.643e-03   1.970e-01    8.887e-01  8.887e-01      2398 -3.711e+03 -3.714e+03                    #> Path [15] :Best Iter: [33] ELBO (-3710.600606) evaluations: (2398)  #> Path [16] :Initial log joint density = -481405.505811  #> Path [16] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              48      -4.788e+05      5.336e-03   1.979e-01    8.991e-01  8.991e-01      2608 -3.712e+03 -3.717e+03                    #> Path [16] :Best Iter: [30] ELBO (-3712.277035) evaluations: (2608)  #> Path [17] :Initial log joint density = -482076.645066  #> Path [17] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              49      -4.788e+05      8.471e-03   1.924e-01    1.000e+00  1.000e+00      2619 -3.710e+03 -3.717e+03                    #> Path [17] :Best Iter: [39] ELBO (-3709.682892) evaluations: (2619)  #> Path [18] :Initial log joint density = -482205.594986  #> Path [18] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              50      -4.788e+05      1.852e-02   3.489e-01    1.000e+00  1.000e+00      2750 -3.711e+03 -3.711e+03                    #> Path [18] :Best Iter: [35] ELBO (-3710.620356) evaluations: (2750)  #> Path [19] :Initial log joint density = -483911.134038  #> Path [19] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              51      -4.788e+05      8.399e-03   1.998e-01    4.277e-01  1.000e+00      2789 -3.711e+03 -3.715e+03                    #> Path [19] :Best Iter: [42] ELBO (-3711.120869) evaluations: (2789)  #> Path [20] :Initial log joint density = -481497.229873  #> Path [20] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      2.799e-03   2.544e-01    5.401e-01  5.401e-01      2892 -3.709e+03 -3.714e+03                    #> Path [20] :Best Iter: [43] ELBO (-3708.644446) evaluations: (2892)  #> Path [21] :Initial log joint density = -481563.395372  #> Path [21] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              50      -4.788e+05      7.955e-03   2.008e-01    1.000e+00  1.000e+00      2584 -3.712e+03 -3.717e+03                    #> Path [21] :Best Iter: [36] ELBO (-3711.785068) evaluations: (2584)  #> Path [22] :Initial log joint density = -481687.013146  #> Path [22] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      8.075e-03   1.645e-01    1.000e+00  1.000e+00      2825 -3.710e+03 -3.714e+03                    #> Path [22] :Best Iter: [44] ELBO (-3710.211144) evaluations: (2825)  #> Path [23] :Initial log joint density = -481903.871266  #> Path [23] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              51      -4.788e+05      8.512e-03   1.868e-01    9.959e-01  9.959e-01      2710 -3.712e+03 -3.711e+03                    #> Path [23] :Best Iter: [51] ELBO (-3711.389995) evaluations: (2710)  #> Path [24] :Initial log joint density = -481281.586262  #> Path [24] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              51      -4.788e+05      6.029e-03   1.988e-01    7.676e-01  7.676e-01      2736 -3.711e+03 -3.718e+03                    #> Path [24] :Best Iter: [38] ELBO (-3710.904851) evaluations: (2736)  #> Path [25] :Initial log joint density = -481854.442627  #> Path [25] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      9.256e-03   2.291e-01    1.000e+00  1.000e+00      2893 -3.711e+03 -3.712e+03                    #> Path [25] :Best Iter: [46] ELBO (-3710.742305) evaluations: (2893)  #> Path [26] :Initial log joint density = -481790.495561  #> Path [26] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              49      -4.788e+05      1.268e-02   2.476e-01    1.000e+00  1.000e+00      2674 -3.711e+03 -3.716e+03                    #> Path [26] :Best Iter: [46] ELBO (-3711.122310) evaluations: (2674)  #> Path [27] :Initial log joint density = -481393.526342  #> Path [27] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              46      -4.788e+05      1.400e-02   3.706e-01    1.000e+00  1.000e+00      2369 -3.710e+03 -3.714e+03                    #> Path [27] :Best Iter: [34] ELBO (-3709.980558) evaluations: (2369)  #> Path [28] :Initial log joint density = -481380.382651  #> Path [28] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              46      -4.788e+05      1.470e-02   2.428e-01    8.265e-01  8.265e-01      2462 -3.710e+03 -3.715e+03                    #> Path [28] :Best Iter: [37] ELBO (-3709.965186) evaluations: (2462)  #> Path [29] :Initial log joint density = -481436.840489  #> Path [29] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              48      -4.788e+05      1.007e-02   1.900e-01    1.000e+00  1.000e+00      2550 -3.712e+03 -3.713e+03                    #> Path [29] :Best Iter: [45] ELBO (-3711.624550) evaluations: (2550)  #> Path [30] :Initial log joint density = -483023.935290  #> Path [30] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      9.186e-03   1.557e-01    1.000e+00  1.000e+00      2936 -3.710e+03 -3.713e+03                    #> Path [30] :Best Iter: [48] ELBO (-3709.645776) evaluations: (2936)  #> Path [31] :Initial log joint density = -483940.045618  #> Path [31] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              49      -4.788e+05      6.491e-03   1.522e-01    1.000e+00  1.000e+00      2711 -3.710e+03 -3.713e+03                    #> Path [31] :Best Iter: [43] ELBO (-3710.071356) evaluations: (2711)  #> Path [32] :Initial log joint density = -481420.701420  #> Path [32] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              46      -4.788e+05      9.308e-03   2.871e-01    1.000e+00  1.000e+00      2408 -3.711e+03 -3.715e+03                    #> Path [32] :Best Iter: [43] ELBO (-3710.870258) evaluations: (2408)  #> Path [33] :Initial log joint density = -481789.072788  #> Path [33] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      1.595e-02   3.247e-01    1.000e+00  1.000e+00      2890 -3.710e+03 -3.713e+03                    #> Path [33] :Best Iter: [45] ELBO (-3710.047868) evaluations: (2890)  #> Path [34] :Initial log joint density = -481423.366572  #> Path [34] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              42      -4.788e+05      7.808e-03   1.899e-01    1.000e+00  1.000e+00      2071 -3.711e+03 -3.711e+03                    #> Path [34] :Best Iter: [37] ELBO (-3710.660337) evaluations: (2071)  #> Path [35] :Initial log joint density = -481418.324533  #> Path [35] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              50      -4.788e+05      9.873e-03   1.854e-01    1.000e+00  1.000e+00      2724 -3.710e+03 -3.712e+03                    #> Path [35] :Best Iter: [45] ELBO (-3709.909431) evaluations: (2724)  #> Path [36] :Initial log joint density = -482466.485402  #> Path [36] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              47      -4.788e+05      6.808e-03   1.042e-01    8.277e-01  8.277e-01      2587 -3.709e+03 -3.713e+03                    #> Path [36] :Best Iter: [34] ELBO (-3709.485421) evaluations: (2587)  #> Path [37] :Initial log joint density = -481653.071416  #> Path [37] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              51      -4.788e+05      1.444e-02   1.716e-01    1.000e+00  1.000e+00      2773 -3.711e+03 -3.712e+03                    #> Path [37] :Best Iter: [50] ELBO (-3710.765877) evaluations: (2773)  #> Path [38] :Initial log joint density = -481466.840303  #> Path [38] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              49      -4.788e+05      1.161e-02   1.952e-01    1.000e+00  1.000e+00      2549 -3.711e+03 -3.713e+03                    #> Path [38] :Best Iter: [39] ELBO (-3710.716774) evaluations: (2549)  #> Path [39] :Initial log joint density = -484268.077088  #> Path [39] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              50      -4.788e+05      1.362e-02   3.291e-01    1.000e+00  1.000e+00      2730 -3.709e+03 -3.713e+03                    #> Path [39] :Best Iter: [49] ELBO (-3709.209259) evaluations: (2730)  #> Path [40] :Initial log joint density = -481381.909206  #> Path [40] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              44      -4.788e+05      9.861e-03   2.563e-01    9.038e-01  9.038e-01      2253 -3.713e+03 -3.714e+03                    #> Path [40] :Best Iter: [39] ELBO (-3712.721501) evaluations: (2253)  #> Path [41] :Initial log joint density = -481561.268138  #> Path [41] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      1.215e-02   2.320e-01    1.000e+00  1.000e+00      2969 -3.709e+03 -3.710e+03                    #> Path [41] :Best Iter: [50] ELBO (-3709.331225) evaluations: (2969)  #> Path [42] :Initial log joint density = -481364.751981  #> Path [42] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              49      -4.788e+05      1.209e-02   2.419e-01    1.000e+00  1.000e+00      2588 -3.712e+03 -3.711e+03                    #> Path [42] :Best Iter: [49] ELBO (-3710.691017) evaluations: (2588)  #> Path [43] :Initial log joint density = -481475.680451  #> Path [43] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      1.607e-02   3.270e-01    1.000e+00  1.000e+00      2873 -3.711e+03 -3.717e+03                    #> Path [43] :Best Iter: [50] ELBO (-3711.428870) evaluations: (2873)  #> Path [44] :Initial log joint density = -481440.917209  #> Path [44] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              46      -4.788e+05      1.014e-02   1.964e-01    1.000e+00  1.000e+00      2433 -3.712e+03 -3.717e+03                    #> Path [44] :Best Iter: [33] ELBO (-3711.573676) evaluations: (2433)  #> Path [45] :Initial log joint density = -481210.885838  #> Path [45] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              51      -4.788e+05      1.075e-02   1.768e-01    1.000e+00  1.000e+00      2697 -3.707e+03 -3.712e+03                    #> Path [45] :Best Iter: [46] ELBO (-3706.555120) evaluations: (2697)  #> Path [46] :Initial log joint density = -484940.549868  #> Path [46] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      9.004e-03   1.792e-01    1.000e+00  1.000e+00      2929 -3.711e+03 -3.722e+03                    #> Path [46] :Best Iter: [45] ELBO (-3711.099750) evaluations: (2929)  #> Path [47] :Initial log joint density = -481418.017771  #> Path [47] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      2.035e-02   2.219e-01    1.000e+00  1.000e+00      3059 -3.708e+03 -3.712e+03                    #> Path [47] :Best Iter: [52] ELBO (-3708.039753) evaluations: (3059)  #> Path [48] :Initial log joint density = -481515.755614  #> Path [48] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      9.052e-03   1.663e-01    1.000e+00  1.000e+00      2887 -3.709e+03 -3.711e+03                    #> Path [48] :Best Iter: [49] ELBO (-3709.111802) evaluations: (2887)  #> Path [49] :Initial log joint density = -481993.181087  #> Path [49] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              50      -4.788e+05      9.881e-03   2.140e-01    1.000e+00  1.000e+00      2710 -3.711e+03 -3.712e+03                    #> Path [49] :Best Iter: [43] ELBO (-3711.377316) evaluations: (2710)  #> Path [50] :Initial log joint density = -481588.145061  #> Path [50] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              50      -4.788e+05      4.460e-03   1.943e-01    6.902e-01  6.902e-01      2719 -3.711e+03 -3.720e+03                    #> Path [50] :Best Iter: [31] ELBO (-3710.997115) evaluations: (2719)  #> Finished in  11.7 seconds. #> sccomp says: to do hypothesis testing run `sccomp_test()`, #>   the `test_composition_above_logit_fold_change` = 0.1 equates to a change of ~10%, and #>   0.7 equates to ~100% increase, if the baseline is ~0.1 proportion. #>   Use `sccomp_proportional_fold_change` to convert c_effect (linear) to proportion difference (non-linear). # }"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_theme.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a multipanel theme compatible with ggplot2 4.0.0 S7 system — sccomp_theme","title":"Create a multipanel theme compatible with ggplot2 4.0.0 S7 system — sccomp_theme","text":"Creates multipanel theme compatible new ggplot2 4.0.0 S7 system. function creates fresh theme object using new S7 system instead relying saved S3 theme object.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_theme.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a multipanel theme compatible with ggplot2 4.0.0 S7 system — sccomp_theme","text":"","code":"sccomp_theme()"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sccomp_theme.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a multipanel theme compatible with ggplot2 4.0.0 S7 system — sccomp_theme","text":"ggplot2 theme object compatible ggplot2 4.0.0","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sce_obj.html","id":null,"dir":"Reference","previous_headings":"","what":"sce_obj — sce_obj","title":"sce_obj — sce_obj","text":"Example SingleCellExperiment object containing gene expression data 106,297 cells across two assays: counts logcounts. object includes metadata assay data RNA expression, can used directly differential analysis functions like sccomp_glm.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sce_obj.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"sce_obj — sce_obj","text":"","code":"data(sce_obj)"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sce_obj.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"sce_obj — sce_obj","text":"SingleCellExperiment object following structure: assays: Two assays: counts (raw RNA counts) logcounts (log-transformed counts). rowData: additional row-level metadata present. colData: Metadata cell, including six fields: sample, type, nFeature_RNA, ident, others. dim: 1 feature 106,297 cells. colnames: Cell identifiers 106,297 cells.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/sce_obj.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"sce_obj — sce_obj","text":"SingleCellExperiment object containing single-cell RNA expression data.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/seurat_obj.html","id":null,"dir":"Reference","previous_headings":"","what":"seurat_obj — seurat_obj","title":"seurat_obj — seurat_obj","text":"Example Seurat object containing gene expression data 106,297 cells across single assay. object includes RNA counts data layers, variable features defined. dataset can directly used functions like sccomp_glm differential abundance analysis.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/seurat_obj.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"seurat_obj — seurat_obj","text":"","code":"data(seurat_obj)"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/seurat_obj.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"seurat_obj — seurat_obj","text":"Seurat object following structure: assays: Contains gene expression data. active assay RNA, 1 feature variable features. layers: Two layers: counts data, representing raw processed RNA expression values, respectively. samples: 106,297 samples (cells) within RNA assay.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/seurat_obj.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"seurat_obj — seurat_obj","text":"Seurat object containing single-cell RNA expression data.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/simulate_data.html","id":null,"dir":"Reference","previous_headings":"","what":"simulate_data — simulate_data","title":"simulate_data — simulate_data","text":"function simulates data fitted model.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/simulate_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"simulate_data — simulate_data","text":"","code":"simulate_data(   .data,   .estimate_object,   formula_composition,   formula_variability = NULL,   .sample = NULL,   .cell_group = NULL,   .coefficients = NULL,   variability_multiplier = 5,   number_of_draws = 1,   mcmc_seed = sample_seed(),   cores = detectCores(),   sig_figs = 9,   cache_stan_model = sccomp_stan_models_cache_dir )"},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/simulate_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"simulate_data — simulate_data","text":".data tibble including cell_group name column | sample name column | read counts column | factor columns | Pvalue column | significance column .estimate_object result sccomp_estimate execution. used sampling real-data properties. formula_composition formula. formula describing model differential abundance, example ~treatment formula_variability formula. formula describing model differential variability, example ~treatment .sample column name symbol. sample identifier .cell_group column name symbol. cell_group identifier .coefficients column names coefficients, example, c(b_0, b_1) variability_multiplier real scalar. can used artificially increasing variability simulation benchmarking purposes. number_of_draws integer. may copies data want draw model joint posterior distribution. mcmc_seed integer. Used Markov-chain Monte Carlo reproducibility. default random number sampled 1 999999. can controlled set.seed()#' @param cores Integer, number cores used parallel calculations. cores Integer, number cores used parallel calculations. sig_figs Number significant figures use Stan model output. Default 9. cache_stan_model character string specifying cache directory compiled Stan models. sccomp version automatically appended ensure version isolation. Default sccomp_stan_models_cache_dir points ~/.sccomp_models.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/simulate_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"simulate_data — simulate_data","text":"tibble (tbl) following columns: sample - character column representing sample name. type - factor column representing type sample. phenotype - factor column representing phenotype data. count - integer column representing original cell counts. cell_group - character column representing cell group identifier. b_0 - numeric column representing first coefficient used simulation. b_1 - numeric column representing second coefficient used simulation. generated_proportions - numeric column representing generated proportions simulation. generated_counts - integer column representing generated cell counts simulation. replicate - integer column representing replicate number draw posterior distribution.","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/simulate_data.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"simulate_data — simulate_data","text":"S. Mangiola, .J. Roth-Schulze, M. Trussart, E. Zozaya-Valdés, M. Ma, Z. Gao, .F. Rubin, T.P. Speed, H. Shim, & .T. Papenfuss, sccomp: Robust differential composition variability analysis single-cell data, Proc. Natl. Acad. Sci. U.S.. 120 (33) e2203828120, https://doi.org/10.1073/pnas.2203828120 (2023).","code":""},{"path":"https://mangiolalaboratory.github.io/sccomp/reference/simulate_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"simulate_data — simulate_data","text":"","code":"print(\"cmdstanr is needed to run this example.\") #> [1] \"cmdstanr is needed to run this example.\" # Note: Before running the example, ensure that the 'cmdstanr' package is installed: # install.packages(\"cmdstanr\", repos = c(\"https://stan-dev.r-universe.dev/\", getOption(\"repos\")))  # \\donttest{   if (instantiate::stan_cmdstan_exists()) {     data(\"counts_obj\")     library(dplyr)      estimate = sccomp_estimate(       counts_obj,       ~ type, ~1, \"sample\", \"cell_group\", \"count\",       cores = 1     )      # Set coefficients for cell_groups. In this case all coefficients are 0 for simplicity.     counts_obj = counts_obj |> mutate(b_0 = 0, b_1 = 0)      # Simulate data     simulate_data(counts_obj, estimate, ~type, ~1, sample, cell_group, c(b_0, b_1))   } #>  #> Attaching package: ‘dplyr’ #> The following objects are masked from ‘package:stats’: #>  #>     filter, lag #> The following objects are masked from ‘package:base’: #>  #>     intersect, setdiff, setequal, union #> sccomp says: count column is an integer. The sum-constrained beta binomial model will be used #> sccomp says: estimation #> sccomp says: the composition design matrix has columns: (Intercept), typecancer #> sccomp says: the variability design matrix has columns: (Intercept) #> Loading model from cache... #> Path [1] :Initial log joint density = -481605.483530  #> Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      3.923e-03   1.249e-01    7.334e-01  7.334e-01      3538 -3.701e+03 -3.716e+03                    #> Path [1] :Best Iter: [58] ELBO (-3701.022059) evaluations: (3538)  #> Path [2] :Initial log joint density = -482018.910838  #> Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              62      -4.788e+05      3.426e-03   2.835e-01    6.691e-01  6.691e-01      3599 -3.698e+03 -3.713e+03                    #> Path [2] :Best Iter: [55] ELBO (-3697.863230) evaluations: (3599)  #> Path [3] :Initial log joint density = -481672.736906  #> Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              50      -4.788e+05      1.423e-02   2.700e-01    7.221e-01  7.221e-01      2673 -3.710e+03 -3.726e+03                    #> Path [3] :Best Iter: [39] ELBO (-3709.712537) evaluations: (2673)  #> Path [4] :Initial log joint density = -482518.275451  #> Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      6.811e-03   2.325e-01    1.000e+00  1.000e+00      3330 -3.703e+03 -3.706e+03                    #> Path [4] :Best Iter: [55] ELBO (-3702.626938) evaluations: (3330)  #> Path [5] :Initial log joint density = -481528.167528  #> Path [5] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              52      -4.788e+05      8.815e-03   2.282e-01    9.315e-01  9.315e-01      2854 -3.708e+03 -3.723e+03                    #> Path [5] :Best Iter: [46] ELBO (-3707.660487) evaluations: (2854)  #> Path [6] :Initial log joint density = -481181.060738  #> Path [6] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      9.745e-03   2.696e-01    1.000e+00  1.000e+00      3074 -3.708e+03 -3.704e+03                    #> Path [6] :Best Iter: [55] ELBO (-3704.424896) evaluations: (3074)  #> Path [7] :Initial log joint density = -481499.586766  #> Path [7] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              62      -4.788e+05      2.688e-02   2.476e-01    1.000e+00  1.000e+00      3688 -3.700e+03 -3.707e+03                    #> Path [7] :Best Iter: [59] ELBO (-3699.633278) evaluations: (3688)  #> Path [8] :Initial log joint density = -481857.889907  #> Path [8] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      3.237e-03   2.516e-01    7.544e-01  7.544e-01      3566 -3.697e+03 -3.710e+03                    #> Path [8] :Best Iter: [58] ELBO (-3697.498399) evaluations: (3566)  #> Path [9] :Initial log joint density = -482390.148268  #> Path [9] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      3.691e-03   1.589e-01    7.658e-01  7.658e-01      3465 -3.701e+03 -3.714e+03                    #> Path [9] :Best Iter: [56] ELBO (-3700.722291) evaluations: (3465)  #> Path [10] :Initial log joint density = -481441.830994  #> Path [10] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      6.616e-03   2.445e-01    1.000e+00  1.000e+00      2890 -3.709e+03 -3.716e+03                    #> Path [10] :Best Iter: [45] ELBO (-3708.742167) evaluations: (2890)  #> Path [11] :Initial log joint density = -481413.527660  #> Path [11] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      7.643e-03   2.284e-01    1.000e+00  1.000e+00      3382 -3.699e+03 -3.704e+03                    #> Path [11] :Best Iter: [55] ELBO (-3699.176865) evaluations: (3382)  #> Path [12] :Initial log joint density = -481763.841204  #> Path [12] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      4.999e-03   2.207e-01    8.240e-01  8.240e-01      3155 -3.702e+03 -3.708e+03                    #> Path [12] :Best Iter: [55] ELBO (-3701.880708) evaluations: (3155)  #> Path [13] :Initial log joint density = -481613.037874  #> Path [13] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      1.305e-02   3.228e-01    9.113e-01  9.113e-01      3060 -3.707e+03 -3.710e+03                    #> Path [13] :Best Iter: [49] ELBO (-3707.236007) evaluations: (3060)  #> Path [14] :Initial log joint density = -481968.766991  #> Path [14] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      6.086e-03   3.139e-01    6.990e-01  6.990e-01      3139 -3.707e+03 -3.716e+03                    #> Path [14] :Best Iter: [55] ELBO (-3707.211051) evaluations: (3139)  #> Path [15] :Initial log joint density = -481538.015455  #> Path [15] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      3.587e-03   2.085e-01    8.136e-01  8.136e-01      2994 -3.707e+03 -3.719e+03                    #> Path [15] :Best Iter: [52] ELBO (-3707.467470) evaluations: (2994)  #> Path [16] :Initial log joint density = -481768.007787  #> Path [16] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      7.865e-03   2.250e-01    1.000e+00  1.000e+00      3393 -3.705e+03 -3.698e+03                    #> Path [16] :Best Iter: [57] ELBO (-3698.113305) evaluations: (3393)  #> Path [17] :Initial log joint density = -482426.919861  #> Path [17] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      3.787e-03   2.153e-01    9.040e-01  9.040e-01      3209 -3.706e+03 -3.711e+03                    #> Path [17] :Best Iter: [44] ELBO (-3705.951979) evaluations: (3209)  #> Path [18] :Initial log joint density = -481826.410735  #> Path [18] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              51      -4.788e+05      7.267e-03   2.711e-01    1.000e+00  1.000e+00      2788 -3.710e+03 -3.708e+03                    #> Path [18] :Best Iter: [51] ELBO (-3708.069959) evaluations: (2788)  #> Path [19] :Initial log joint density = -481852.973594  #> Path [19] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      5.826e-03   2.078e-01    1.000e+00  1.000e+00      3037 -3.711e+03 -3.726e+03                    #> Path [19] :Best Iter: [46] ELBO (-3711.365952) evaluations: (3037)  #> Path [20] :Initial log joint density = -481740.712137  #> Path [20] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      8.091e-03   2.001e-01    1.000e+00  1.000e+00      3380 -3.703e+03 -3.699e+03                    #> Path [20] :Best Iter: [58] ELBO (-3699.156727) evaluations: (3380)  #> Path [21] :Initial log joint density = -481612.642379  #> Path [21] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.402e-02   4.342e-01    1.000e+00  1.000e+00      3404 -3.702e+03 -3.708e+03                    #> Path [21] :Best Iter: [57] ELBO (-3702.369602) evaluations: (3404)  #> Path [22] :Initial log joint density = -481626.376609  #> Path [22] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      6.766e-03   2.098e-01    8.585e-01  8.585e-01      3109 -3.703e+03 -3.708e+03                    #> Path [22] :Best Iter: [55] ELBO (-3702.676476) evaluations: (3109)  #> Path [23] :Initial log joint density = -481405.486642  #> Path [23] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      1.835e-02   2.141e-01    1.000e+00  1.000e+00      3006 -3.705e+03 -3.707e+03                    #> Path [23] :Best Iter: [45] ELBO (-3704.626733) evaluations: (3006)  #> Path [24] :Initial log joint density = -481821.789938  #> Path [24] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      8.426e-03   1.891e-01    1.000e+00  1.000e+00      3327 -3.700e+03 -3.703e+03                    #> Path [24] :Best Iter: [55] ELBO (-3700.324346) evaluations: (3327)  #> Path [25] :Initial log joint density = -481873.779955  #> Path [25] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      4.122e-03   2.534e-01    6.647e-01  6.647e-01      3409 -3.700e+03 -3.716e+03                    #> Path [25] :Best Iter: [57] ELBO (-3699.865192) evaluations: (3409)  #> Path [26] :Initial log joint density = -481837.967478  #> Path [26] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      1.210e-02   2.427e-01    8.880e-01  8.880e-01      3425 -3.700e+03 -3.709e+03                    #> Path [26] :Best Iter: [57] ELBO (-3700.294008) evaluations: (3425)  #> Path [27] :Initial log joint density = -485624.133260  #> Path [27] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      5.598e-03   1.561e-01    8.164e-01  8.164e-01      3599 -3.702e+03 -3.712e+03                    #> Path [27] :Best Iter: [55] ELBO (-3702.107641) evaluations: (3599)  #> Path [28] :Initial log joint density = -481702.441039  #> Path [28] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      1.072e-02   3.130e-01    1.000e+00  1.000e+00      3217 -3.702e+03 -3.703e+03                    #> Path [28] :Best Iter: [55] ELBO (-3702.146161) evaluations: (3217)  #> Path [29] :Initial log joint density = -481413.057650  #> Path [29] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      4.531e-03   2.660e-01    7.143e-01  7.143e-01      3338 -3.700e+03 -3.710e+03                    #> Path [29] :Best Iter: [55] ELBO (-3700.120611) evaluations: (3338)  #> Path [30] :Initial log joint density = -481472.136102  #> Path [30] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              51      -4.788e+05      5.841e-03   2.537e-01    7.768e-01  7.768e-01      2751 -3.708e+03 -3.725e+03                    #> Path [30] :Best Iter: [45] ELBO (-3707.755177) evaluations: (2751)  #> Path [31] :Initial log joint density = -481828.416258  #> Path [31] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      1.013e-02   2.908e-01    1.000e+00  1.000e+00      3109 -3.708e+03 -3.703e+03                    #> Path [31] :Best Iter: [55] ELBO (-3703.314159) evaluations: (3109)  #> Path [32] :Initial log joint density = -481603.067698  #> Path [32] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      9.399e-03   2.548e-01    1.000e+00  1.000e+00      3075 -3.708e+03 -3.703e+03                    #> Path [32] :Best Iter: [55] ELBO (-3702.576548) evaluations: (3075)  #> Path [33] :Initial log joint density = -481839.725261  #> Path [33] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              59      -4.788e+05      4.222e-03   1.686e-01    1.000e+00  1.000e+00      3359 -3.700e+03 -3.710e+03                    #> Path [33] :Best Iter: [55] ELBO (-3699.997407) evaluations: (3359)  #> Path [34] :Initial log joint density = -481749.598996  #> Path [34] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      7.340e-03   2.648e-01    1.000e+00  1.000e+00      3008 -3.707e+03 -3.715e+03                    #> Path [34] :Best Iter: [42] ELBO (-3707.123557) evaluations: (3008)  #> Path [35] :Initial log joint density = -481576.777300  #> Path [35] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      2.482e-03   2.861e-01    6.111e-01  6.111e-01      3222 -3.706e+03 -3.712e+03                    #> Path [35] :Best Iter: [55] ELBO (-3706.254917) evaluations: (3222)  #> Path [36] :Initial log joint density = -481547.691475  #> Path [36] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      4.301e-03   2.749e-01    5.632e-01  5.632e-01      3003 -3.708e+03 -3.718e+03                    #> Path [36] :Best Iter: [46] ELBO (-3708.295589) evaluations: (3003)  #> Path [37] :Initial log joint density = -481601.740641  #> Path [37] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      1.334e-02   4.070e-01    1.000e+00  1.000e+00      3038 -3.706e+03 -3.716e+03                    #> Path [37] :Best Iter: [44] ELBO (-3705.956297) evaluations: (3038)  #> Path [38] :Initial log joint density = -482807.688497  #> Path [38] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      3.903e-03   2.409e-01    6.803e-01  6.803e-01      3289 -3.700e+03 -3.708e+03                    #> Path [38] :Best Iter: [56] ELBO (-3700.465755) evaluations: (3289)  #> Path [39] :Initial log joint density = -481541.149401  #> Path [39] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              57      -4.788e+05      1.156e-02   2.590e-01    1.000e+00  1.000e+00      3185 -3.697e+03 -3.710e+03                    #> Path [39] :Best Iter: [55] ELBO (-3697.120529) evaluations: (3185)  #> Path [40] :Initial log joint density = -481983.661422  #> Path [40] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              62      -4.788e+05      1.504e-02   3.491e-01    1.000e+00  1.000e+00      3710 -3.698e+03 -3.701e+03                    #> Path [40] :Best Iter: [61] ELBO (-3697.592714) evaluations: (3710)  #> Path [41] :Initial log joint density = -482532.043722  #> Path [41] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              60      -4.788e+05      6.230e-03   1.604e-01    8.375e-01  8.375e-01      3651 -3.700e+03 -3.713e+03                    #> Path [41] :Best Iter: [58] ELBO (-3700.036674) evaluations: (3651)  #> Path [42] :Initial log joint density = -482036.619021  #> Path [42] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              61      -4.788e+05      1.448e-02   2.507e-01    1.000e+00  1.000e+00      3478 -3.703e+03 -3.704e+03                    #> Path [42] :Best Iter: [59] ELBO (-3702.677467) evaluations: (3478)  #> Path [43] :Initial log joint density = -481581.289773  #> Path [43] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      8.046e-03   2.179e-01    1.000e+00  1.000e+00      3074 -3.711e+03 -3.702e+03                    #> Path [43] :Best Iter: [55] ELBO (-3702.420780) evaluations: (3074)  #> Path [44] :Initial log joint density = -483022.967263  #> Path [44] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              58      -4.788e+05      4.748e-03   1.635e-01    1.000e+00  1.000e+00      3326 -3.701e+03 -3.707e+03                    #> Path [44] :Best Iter: [55] ELBO (-3700.829425) evaluations: (3326)  #> Path [45] :Initial log joint density = -481583.757311  #> Path [45] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              56      -4.788e+05      7.243e-03   2.022e-01    1.000e+00  1.000e+00      3213 -3.707e+03 -3.704e+03                    #> Path [45] :Best Iter: [56] ELBO (-3704.198172) evaluations: (3213)  #> Path [46] :Initial log joint density = -481490.575329  #> Path [46] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      7.994e-03   1.941e-01    1.000e+00  1.000e+00      2971 -3.707e+03 -3.702e+03                    #> Path [46] :Best Iter: [55] ELBO (-3701.709424) evaluations: (2971)  #> Path [47] :Initial log joint density = -481424.929248  #> Path [47] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              53      -4.788e+05      6.703e-03   2.153e-01    9.819e-01  9.819e-01      2914 -3.712e+03 -3.726e+03                    #> Path [47] :Best Iter: [40] ELBO (-3711.833841) evaluations: (2914)  #> Path [48] :Initial log joint density = -481902.945041  #> Path [48] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      6.267e-03   2.338e-01    7.562e-01  7.562e-01      2995 -3.705e+03 -3.719e+03                    #> Path [48] :Best Iter: [43] ELBO (-3705.367488) evaluations: (2995)  #> Path [49] :Initial log joint density = -481635.334636  #> Path [49] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              55      -4.788e+05      5.550e-03   2.100e-01    8.291e-01  8.291e-01      3124 -3.706e+03 -3.716e+03                    #> Path [49] :Best Iter: [52] ELBO (-3706.446333) evaluations: (3124)  #> Path [50] :Initial log joint density = -481683.614549  #> Path [50] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes   #>              54      -4.788e+05      2.914e-03   3.256e-01    6.147e-01  6.147e-01      2995 -3.707e+03 -3.723e+03                    #> Path [50] :Best Iter: [51] ELBO (-3706.592818) evaluations: (2995)  #> Finished in  13.3 seconds. #> sccomp says: to do hypothesis testing run `sccomp_test()`, #>   the `test_composition_above_logit_fold_change` = 0.1 equates to a change of ~10%, and #>   0.7 equates to ~100% increase, if the baseline is ~0.1 proportion. #>   Use `sccomp_proportional_fold_change` to convert c_effect (linear) to proportion difference (non-linear). #> Error in column_to_rownames(., quo_name(.cell_type)): Can't find column `cell_group` in `.data`. # }"}]
