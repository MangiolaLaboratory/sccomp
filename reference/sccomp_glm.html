<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>DEPRECATED - sccomp_glm main — sccomp_glm • sccomp</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="DEPRECATED - sccomp_glm main — sccomp_glm"><meta property="og:description" content="The function for linear modelling takes as input a table of cell counts with three columns containing a cell-group identifier, sample identifier, integer count and the factors (continuous or discrete). The user can define a linear model with an input R formula, where the first factor is the factor of interest. Alternatively, sccomp accepts single-cell data containers (Seurat, SingleCellExperiment44, cell metadata or group-size). In this case, sccomp derives the count data from cell metadata."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sccomp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.7.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/introduction.html">Overview of the sccomp package</a>
    </li>
    <li>
      <a href="../articles/new_framework.html">New sccomp framework</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/stemangiola/sccomp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>DEPRECATED - sccomp_glm main</h1>
    <small class="dont-index">Source: <a href="https://github.com/stemangiola/sccomp/blob/HEAD/R/methods_OLD_framework.R" class="external-link"><code>R/methods_OLD_framework.R</code></a></small>
    <div class="hidden name"><code>sccomp_glm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function for linear modelling takes as input a table of cell counts with three columns containing a cell-group identifier, sample identifier, integer count and the factors (continuous or discrete). The user can define a linear model with an input R formula, where the first factor is the factor of interest. Alternatively, sccomp accepts single-cell data containers (Seurat, SingleCellExperiment44, cell metadata or group-size). In this case, sccomp derives the count data from cell metadata.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sccomp_glm</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  formula_composition <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>,</span>
<span>  formula_variability <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>,</span>
<span>  <span class="va">.sample</span>,</span>
<span>  <span class="va">.cell_group</span>,</span>
<span>  .count <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  contrasts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prior_mean_variable_association <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span>, slope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.6</span><span class="op">)</span>,</span>
<span>    standard_deviation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  check_outliers <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  bimodal_mean_variability_association <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  enable_loo <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cores <span class="op">=</span> <span class="fu">detectCores</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  percent_false_positive <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  approximate_posterior_inference <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  test_composition_above_logit_fold_change <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  .sample_cell_group_pairs_to_exclude <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  noise_model <span class="op">=</span> <span class="st">"multi_beta_binomial"</span>,</span>
<span>  exclude_priors <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  use_data <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  mcmc_seed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1e+05</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  max_sampling_iterations <span class="op">=</span> <span class="fl">20000</span>,</span>
<span>  pass_fit <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>.data</dt>
<dd><p>A tibble including a cell_group name column | sample name column | read counts column (optional depending on the input class) | factor columns.</p></dd>


<dt>formula_composition</dt>
<dd><p>A formula. The formula describing the model for differential abundance, for example ~treatment.</p></dd>


<dt>formula_variability</dt>
<dd><p>A formula. The formula describing the model for differential variability, for example ~treatment. In most cases, if differentially variability is of interest, the formula should only include the factor of interest as a large anount of data is needed to define variability depending to each factors.</p></dd>


<dt>.sample</dt>
<dd><p>A column name as symbol. The sample identifier</p></dd>


<dt>.cell_group</dt>
<dd><p>A column name as symbol. The cell_group identifier</p></dd>


<dt>.count</dt>
<dd><p>A column name as symbol. The cell_group abundance (read count). Used only for data frame count output. The variable in this column should be of class integer.</p></dd>


<dt>contrasts</dt>
<dd><p>A vector of character strings. For example if your formula is <code>~ 0 + treatment</code> and the factor treatment has values <code>yes</code> and <code>no</code>, your contrast could be constrasts = c("treatmentyes - treatmentno").</p></dd>


<dt>prior_mean_variable_association</dt>
<dd><p>A list of the form list(intercept = c(5, 2), slope = c(0,  0.6), standard_deviation = c(20, 40)). Where for intercept and slope parameters, we specify mean and standard deviation, while for standard deviation, we specify shape and rate. This is used to incorporate prior knowledge about the mean/variability association of cell-type proportions.</p></dd>


<dt>check_outliers</dt>
<dd><p>A boolean. Whether to check for outliers before the fit.</p></dd>


<dt>bimodal_mean_variability_association</dt>
<dd><p>A boolean. Whether to model the mean-variability as bimodal, as often needed in the case of single-cell RNA sequencing data, and not usually for CyTOF and microbiome data. The plot summary_plot()$credible_intervals_2D can be used to assess whether the bimodality should be modelled.</p></dd>


<dt>enable_loo</dt>
<dd><p>A boolean. Enable model comparison by the R package LOO. This is helpful when you want to compare the fit between two models, for example, analogously to ANOVA, between a one factor model versus a interceot-only model.</p></dd>


<dt>cores</dt>
<dd><p>An integer. How many cored to be used with parallel calculations.</p></dd>


<dt>percent_false_positive</dt>
<dd><p>A real between 0 and 100 non included. This used to identify outliers with a specific false positive rate.</p></dd>


<dt>approximate_posterior_inference</dt>
<dd><p>A boolean. Whether the inference of the joint posterior distribution should be approximated with variational Bayes. It confers execution time advantage.</p></dd>


<dt>test_composition_above_logit_fold_change</dt>
<dd><p>A positive integer. It is the effect threshold used for the hypothesis test. A value of 0.2 correspond to a change in cell proportion of 10% for a cell type with baseline proportion of 50%. That is, a cell type goes from 45% to 50%. When the baseline proportion is closer to 0 or 1 this effect thrshold has consistent value in the logit uncontrained scale.</p></dd>


<dt>.sample_cell_group_pairs_to_exclude</dt>
<dd><p>A column name that includes a boolean variable for the sample/cell-group pairs to be ignored in the fit. This argument is for pro-users.</p></dd>


<dt>verbose</dt>
<dd><p>A boolean. Prints progression.</p></dd>


<dt>noise_model</dt>
<dd><p>A character string. The two noise models available are multi_beta_binomial (default) and dirichlet_multinomial.</p></dd>


<dt>exclude_priors</dt>
<dd><p>A boolean. Whether to run a prior-free model, for benchmarking purposes.</p></dd>


<dt>use_data</dt>
<dd><p>A booelan. Whether to sun the model data free. This can be used for prior predictive check.</p></dd>


<dt>mcmc_seed</dt>
<dd><p>An integer. Used for Markov-chain Monte Carlo reproducibility. By default a random number is sampled from 1 to 999999. This itself can be controlled by set.seed()</p></dd>


<dt>max_sampling_iterations</dt>
<dd><p>An integer. This limit the maximum number of iterations in case a large dataset is used, for limiting the computation time.</p></dd>


<dt>pass_fit</dt>
<dd><p>A boolean. Whether to pass the Stan fit as attribute in the output. Because the Stan fit can be very large, setting this to FALSE can be used to lower the memory imprint to save the output.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A nested tibble <code>tbl</code>, with the following columns</p><ul><li><p>cell_group - column including the cell groups being tested</p></li>
<li><p>parameter - The parameter being estimated, from the design matrix dscribed with the input formula_composition and formula_variability</p></li>
<li><p>factor - The factor in the formula corresponding to the covariate, if exists (e.g. it does not exist in case og Intercept or contrasts, which usually are combination of parameters)</p></li>
<li><p>c_lower - lower (2.5%) quantile of the posterior distribution for a composition (c) parameter.</p></li>
<li><p>c_effect - mean of the posterior distribution for a composition (c) parameter.</p></li>
<li><p>c_upper - upper (97.5%) quantile of the posterior distribution fo a composition (c)  parameter.</p></li>
<li><p>c_pH0 - Probability of the null hypothesis (no difference) for  a composition (c). This is not a p-value.</p></li>
<li><p>c_FDR - False-discovery rate of the null hypothesis (no difference) for  a composition (c).</p></li>
<li><p>c_n_eff - Effective sample size - the number of independent draws in the sample, the higher the better (mc-stan.org/docs/2_25/cmdstan-guide/stansummary.html).</p></li>
<li><p>c_R_k_hat - R statistic, a measure of chain equilibrium, should be within 0.05 of 1.0 (mc-stan.org/docs/2_25/cmdstan-guide/stansummary.html).</p></li>
<li><p>v_lower - Lower (2.5%) quantile of the posterior distribution for a variability (v) parameter</p></li>
<li><p>v_effect - Mean of the posterior distribution for a variability (v) parameter</p></li>
<li><p>v_upper - Upper (97.5%) quantile of the posterior distribution for a variability (v) parameter</p></li>
<li><p>v_pH0 - Probability of the null hypothesis (no difference) for a variability (v). This is not a p-value.</p></li>
<li><p>v_FDR - False-discovery rate of the null hypothesis (no difference), for a variability (v).</p></li>
<li><p>v_n_eff - Effective sample size for a variability (v) parameter - the number of independent draws in the sample, the higher the better (mc-stan.org/docs/2_25/cmdstan-guide/stansummary.html).</p></li>
<li><p>v_R_k_hat - R statistic for a variability (v) parameter, a measure of chain equilibrium, should be within 0.05 of 1.0 (mc-stan.org/docs/2_25/cmdstan-guide/stansummary.html).</p></li>
<li><p>count_data Nested input count data.</p></li>
</ul></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"counts_obj"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">estimate</span> <span class="op">=</span></span></span>
<span class="r-in"><span>  <span class="fu">sccomp_glm</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">counts_obj</span> ,</span></span>
<span class="r-in"><span>   <span class="op">~</span> <span class="va">type</span>,</span></span>
<span class="r-in"><span>   <span class="op">~</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>   <span class="va">sample</span>,</span></span>
<span class="r-in"><span>   <span class="va">cell_group</span>,</span></span>
<span class="r-in"><span>   <span class="va">count</span>,</span></span>
<span class="r-in"><span>    check_outliers <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    cores <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>`sccomp_glm()` was deprecated in sccomp 1.7.1.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> sccomp says: sccomp_glm() is soft-deprecated. Please use the new modular</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   framework instead, which includes sccomp_estimate(), sccomp_test(),</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   sccomp_remove_outliers(), among other functions.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> sccomp says: estimation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> sccomp says: the composition design matrix has columns: (Intercept), typecancer</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> sccomp says: the variability design matrix has columns: (Intercept)</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stefano Mangiola.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

