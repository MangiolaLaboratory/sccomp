<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>sccomp_test — sccomp_test • sccomp</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="sccomp_test — sccomp_test"><meta property="og:description" content="This function test contrasts from a sccomp result."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sccomp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.7.16</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/introduction.html">Overview of the sccomp package</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/MangiolaLaboratory/sccomp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>sccomp_test</h1>
    <small class="dont-index">Source: <a href="https://github.com/MangiolaLaboratory/sccomp/blob/master/R/methods.R" class="external-link"><code>R/methods.R</code></a></small>
    <div class="hidden name"><code>sccomp_test.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function test contrasts from a sccomp result.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sccomp_test</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  contrasts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  percent_false_positive <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  test_composition_above_logit_fold_change <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  pass_fit <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg--data">.data<a class="anchor" aria-label="anchor" href="#arg--data"></a></dt>
<dd><p>A tibble. The result of sccomp_estimate.</p></dd>


<dt id="arg-contrasts">contrasts<a class="anchor" aria-label="anchor" href="#arg-contrasts"></a></dt>
<dd><p>A vector of character strings. For example if your formula is <code>~ 0 + treatment</code> and the factor treatment has values <code>yes</code> and <code>no</code>, your contrast could be "constrasts = c(treatmentyes - treatmentno)".</p></dd>


<dt id="arg-percent-false-positive">percent_false_positive<a class="anchor" aria-label="anchor" href="#arg-percent-false-positive"></a></dt>
<dd><p>A real between 0 and 100 non included. This used to identify outliers with a specific false positive rate.</p></dd>


<dt id="arg-test-composition-above-logit-fold-change">test_composition_above_logit_fold_change<a class="anchor" aria-label="anchor" href="#arg-test-composition-above-logit-fold-change"></a></dt>
<dd><p>A positive integer. It is the effect threshold used for the hypothesis test. A value of 0.2 correspond to a change in cell proportion of 10% for a cell type with baseline proportion of 50%. That is, a cell type goes from 45% to 50%. When the baseline proportion is closer to 0 or 1 this effect thrshold has consistent value in the logit uncontrained scale.</p></dd>


<dt id="arg-pass-fit">pass_fit<a class="anchor" aria-label="anchor" href="#arg-pass-fit"></a></dt>
<dd><p>A boolean. Whether to pass the Stan fit as attribute in the output. Because the Stan fit can be very large, setting this to FALSE can be used to lower the memory imprint to save the output.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A tibble (<code>tbl</code>), with the following columns:</p><ul><li><p>cell_group - The cell groups being tested.</p></li>
<li><p>parameter - The parameter being estimated from the design matrix described by the input formula_composition and formula_variability.</p></li>
<li><p>factor - The covariate factor in the formula, if applicable (e.g., not present for Intercept or contrasts).</p></li>
<li><p>c_lower - Lower (2.5%) quantile of the posterior distribution for a composition (c) parameter.</p></li>
<li><p>c_effect - Mean of the posterior distribution for a composition (c) parameter.</p></li>
<li><p>c_upper - Upper (97.5%) quantile of the posterior distribution for a composition (c) parameter.</p></li>
<li><p>c_pH0 - Probability of the c_effect being smaller or bigger than the <code>test_composition_above_logit_fold_change</code> argument.</p></li>
<li><p>c_FDR - False discovery rate of the c_effect being smaller or bigger than the <code>test_composition_above_logit_fold_change</code> argument. False discovery rate for Bayesian models is calculated differently from frequentists models, as detailed in Mangiola et al, PNAS 2023.</p></li>
<li><p>c_n_eff - Effective sample size, the number of independent draws in the sample. The higher, the better.</p></li>
<li><p>c_R_k_hat - R statistic, a measure of chain equilibrium, should be within 0.05 of 1.0.</p></li>
<li><p>v_lower - Lower (2.5%) quantile of the posterior distribution for a variability (v) parameter.</p></li>
<li><p>v_effect - Mean of the posterior distribution for a variability (v) parameter.</p></li>
<li><p>v_upper - Upper (97.5%) quantile of the posterior distribution for a variability (v) parameter.</p></li>
<li><p>v_pH0 - Probability of the v_effect being smaller or bigger than the <code>test_composition_above_logit_fold_change</code> argument.</p></li>
<li><p>v_FDR - False discovery rate of the v_effect being smaller or bigger than the <code>test_composition_above_logit_fold_change</code> argument. False discovery rate for Bayesian models is calculated differently from frequentists models, as detailed in Mangiola et al, PNAS 2023.</p></li>
<li><p>v_n_eff - Effective sample size for a variability (v) parameter.</p></li>
<li><p>v_R_k_hat - R statistic for a variability (v) parameter, a measure of chain equilibrium.</p></li>
<li><p>count_data - Nested input count data.</p></li>
</ul><p>#'</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Use the following example after having installed install.packages(\"cmdstanr\", repos = c(\"https://stan-dev.r-universe.dev/\", getOption(\"repos\")))"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Use the following example after having installed install.packages("cmdstanr", repos = c("https://stan-dev.r-universe.dev/", getOption("repos")))</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">instantiate</span><span class="fu">::</span><span class="fu"><a href="https://wlandau.github.io/instantiate/reference/stan_cmdstan_exists.html" class="external-link">stan_cmdstan_exists</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"counts_obj"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="va">estimates</span> <span class="op">=</span> <span class="fu"><a href="sccomp_estimate.html">sccomp_estimate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="va">counts_obj</span>,</span></span>
<span class="r-in"><span>      <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">type</span>, <span class="op">~</span><span class="fl">1</span>, <span class="va">sample</span>, <span class="va">cell_group</span>, <span class="va">count</span>,</span></span>
<span class="r-in"><span>      cores <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">sccomp_test</span><span class="op">(</span><span class="st">"typecancer - typebenign"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stefano Mangiola.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

