<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Robust Outlier-aware Estimation of Composition and Heterogeneity for Single-cell Data • sccomp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Robust Outlier-aware Estimation of Composition and Heterogeneity for Single-cell Data">
<meta property="og:description" content="A robust and outlier-aware method for testing differential tissue composition from single-cell data. This model can infer changes in tissue composition and heterogeneity, and can produce realistic data simulations based on any existing dataset. This model can also transfer knowledge from a large set of integrated datasets to increase accuracy further.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">sccomp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.7.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/introduction.html">Overview of the sccomp package</a>
    </li>
    <li>
      <a href="articles/new_framework.html">New sccomp framework</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/stemangiola/sccomp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<p>sccomp - Outlier-aware and count-based compositional analysis of single-cell data ================</p>
<!-- badges: start -->

<!-- badges: end -->
<p><a href="https://www.youtube.com/watch?v=R_lt58We9nA&amp;ab_channel=RConsortium" target="_blank" class="external-link"> <img src="https://img.youtube.com/vi/R_lt58We9nA/mqdefault.jpg" alt="Watch the video" width="280" height="180" border="10"></a></p>
<div class="section level1">
<div class="page-header"><h1 id="section">
<img src="inst/logo-01.png" height="139px" width="120px"><a class="anchor" aria-label="anchor" href="#section"></a>
</h1></div>
<p>Sccomp is a generalised method for differential composition and variability analyses.</p>
<div class="section level2">
<h2 id="characteristics">Characteristics<a class="anchor" aria-label="anchor" href="#characteristics"></a>
</h2>
<ul>
<li>Complex linear models with continuous and categorical covariates</li>
<li>Multilevel modelling, with population (i.e. fixed) and group (random) effects</li>
<li>Modelling counts</li>
<li>Modelling proportionality</li>
<li>Modelling cell-type specific variability</li>
<li>Cell-type information share for variability adaptive shrinkage</li>
<li>Testing differential variability</li>
<li>Probabilistic outlier identification</li>
<li>Cross-dataset learning (hyperpriors).</li>
</ul>
</div>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<p><strong>Bioconductor</strong></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"sccomp"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Github</strong></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"stemangiola/sccomp"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="22%">
<col width="77%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>sccomp_estimate</code></td>
<td>Fit the model onto the data, and estimate the coefficients</td>
</tr>
<tr class="even">
<td><code>sccomp_remove_outliers</code></td>
<td>Identify outliers probabilistically based on the model fit, and exclude them from the estimation</td>
</tr>
<tr class="odd">
<td><code>sccomp_test</code></td>
<td>Calculate the probability that the coefficients are outside the H0 interval (i.e. test_composition_above_logit_fold_change)</td>
</tr>
<tr class="even">
<td><code>sccomp_replicate</code></td>
<td>Simulate data from the model, or part of the model</td>
</tr>
<tr class="odd">
<td><code>sccomp_predict</code></td>
<td>Predicts proportions, based on the mode, or part of the model</td>
</tr>
<tr class="even">
<td><code>sccomp_remove_unwanted_variation</code></td>
<td>Removes the variability for unwanted factors</td>
</tr>
<tr class="odd">
<td><code>plot</code></td>
<td>Plors summary plots to asses significance</td>
</tr>
</tbody>
</table>
</div>
<div class="section level1">
<h1 id="analysis">Analysis<a class="anchor" aria-label="anchor" href="#analysis"></a>
</h1>
<p><code>sccomp</code> can model changes in composition and variability. By default, the formula for variability is either <code>~1</code>, which assumes that the cell-group variability is independent of any covariate or <code>~ factor_of_interest</code>, which assumes that the model is dependent on the factor of interest only. The variability model must be a subset of the model for composition.</p>
<div class="section level2">
<h2 id="binary-factor">Binary factor<a class="anchor" aria-label="anchor" href="#binary-factor"></a>
</h2>
<div class="section level3">
<h3 id="from-seurat-singlecellexperiment-metadata-objects">From Seurat, SingleCellExperiment, metadata objects<a class="anchor" aria-label="anchor" href="#from-seurat-singlecellexperiment-metadata-objects"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">single_cell_object</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/sccomp_estimate.html">sccomp_estimate</a></span><span class="op">(</span> </span>
<span>    formula_composition <span class="op">=</span> <span class="op">~</span> <span class="va">type</span>, </span>
<span>    .sample <span class="op">=</span>  <span class="va">sample</span>, </span>
<span>    .cell_group <span class="op">=</span> <span class="va">cell_group</span>, </span>
<span>    bimodal_mean_variability_association <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    cores <span class="op">=</span> <span class="fl">1</span> </span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/sccomp_remove_outliers.html">sccomp_remove_outliers</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="reference/sccomp_test.html">sccomp_test</a></span><span class="op">(</span>test_composition_above_logit_fold_change <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="from-counts">From counts<a class="anchor" aria-label="anchor" href="#from-counts"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">counts_obj</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/sccomp_estimate.html">sccomp_estimate</a></span><span class="op">(</span> </span>
<span>    formula_composition <span class="op">=</span> <span class="op">~</span> <span class="va">type</span>, </span>
<span>    .sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>    .cell_group <span class="op">=</span> <span class="va">cell_group</span>,</span>
<span>    .count <span class="op">=</span> <span class="va">count</span>, </span>
<span>    bimodal_mean_variability_association <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    cores <span class="op">=</span> <span class="fl">1</span> </span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/sccomp_remove_outliers.html">sccomp_remove_outliers</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="reference/sccomp_test.html">sccomp_test</a></span><span class="op">(</span>test_composition_above_logit_fold_change <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="do">## SAMPLING FOR MODEL 'glm_multi_beta_binomial' NOW (CHAIN 1).</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="do">## Chain 1: Gradient evaluation took 0.000518 seconds</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="do">## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 5.18 seconds.</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="do">## Chain 1: Adjust your expectations accordingly!</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="do">## Chain 1: Iteration:    1 / 4300 [  0%]  (Warmup)</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="do">## Chain 1: Iteration:  301 / 4300 [  7%]  (Sampling)</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 1300 / 4300 [ 30%]  (Sampling)</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 2300 / 4300 [ 53%]  (Sampling)</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 3300 / 4300 [ 76%]  (Sampling)</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 4300 / 4300 [100%]  (Sampling)</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="do">## Chain 1:  Elapsed Time: 2.961 seconds (Warm-up)</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="do">## Chain 1:                29.147 seconds (Sampling)</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="do">## Chain 1:                32.108 seconds (Total)</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="do">## Chain 1:</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="do">## [90m# A tibble: 72 × 18[39m</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="do">##    cell_group parameter  factor c_lower c_effect c_upper   c_pH0   c_FDR c_n_eff</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="do">##    [3m[90m&lt;chr&gt;[39m[23m      [3m[90m&lt;chr&gt;[39m[23m      [3m[90m&lt;chr&gt;[39m[23m    [3m[90m&lt;dbl&gt;[39m[23m    [3m[90m&lt;dbl&gt;[39m[23m   [3m[90m&lt;dbl&gt;[39m[23m   [3m[90m&lt;dbl&gt;[39m[23m   [3m[90m&lt;dbl&gt;[39m[23m   [3m[90m&lt;dbl&gt;[39m[23m</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a><span class="do">## [90m 1[39m B1         (Intercep… [31mNA[39m      0.883     1.11   1.33   0   [90m [39m   0   [90m [39m     [4m4[24m751.</span></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a><span class="do">## [90m 2[39m B1         typecancer type   -[31m1[39m[31m.[39m[31m17[39m     -[31m0[39m[31m.[39m[31m751[39m -[31m0[39m[31m.[39m[31m352[39m  3.  [90me[39m[31m-3[39m 1.16[90me[39m[31m-3[39m   [4m3[24m133.</span></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a><span class="do">## [90m 3[39m B2         (Intercep… [31mNA[39m      0.404     0.701  0.979  5.00[90me[39m[31m-4[39m 3.75[90me[39m[31m-5[39m   [4m4[24m752.</span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a><span class="do">## [90m 4[39m B2         typecancer type   -[31m1[39m[31m.[39m[31m21[39m     -[31m0[39m[31m.[39m[31m720[39m -[31m0[39m[31m.[39m[31m259[39m  1.52[90me[39m[31m-2[39m 3.95[90me[39m[31m-3[39m   [4m3[24m372.</span></span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a><span class="do">## [90m 5[39m B3         (Intercep… [31mNA[39m     -[31m0[39m[31m.[39m[31m668[39m    -[31m0[39m[31m.[39m[31m387[39m -[31m0[39m[31m.[39m[31m114[39m  9.23[90me[39m[31m-2[39m 7.44[90me[39m[31m-3[39m   [4m4[24m316.</span></span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a><span class="do">## [90m 6[39m B3         typecancer type   -[31m0[39m[31m.[39m[31m732[39m    -[31m0[39m[31m.[39m[31m306[39m  0.088[4m7[24m 2.97[90me[39m[31m-1[39m 7.76[90me[39m[31m-2[39m   [4m4[24m434.</span></span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a><span class="do">## [90m 7[39m BM         (Intercep… [31mNA[39m     -[31m1[39m[31m.[39m[31m34[39m     -[31m1[39m[31m.[39m[31m0[39m[31m3[39m  -[31m0[39m[31m.[39m[31m741[39m  0   [90m [39m   0   [90m [39m     [4m4[24m252.</span></span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a><span class="do">## [90m 8[39m BM         typecancer type   -[31m0[39m[31m.[39m[31m758[39m    -[31m0[39m[31m.[39m[31m311[39m  0.098[4m7[24m 2.99[90me[39m[31m-1[39m 8.82[90me[39m[31m-2[39m   [4m3[24m305.</span></span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a><span class="do">## [90m 9[39m CD4 1      (Intercep… [31mNA[39m      0.079[4m0[24m    0.303  0.507  1.82[90me[39m[31m-1[39m 3.27[90me[39m[31m-2[39m   [4m3[24m471.</span></span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a><span class="do">## [90m10[39m CD4 1      typecancer type   -[31m0[39m[31m.[39m[31m0[39m[31m98[4m8[24m[39m    0.186  0.479  5.35[90me[39m[31m-1[39m 1.52[90me[39m[31m-1[39m   [4m3[24m799.</span></span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a><span class="do">## [90m# ℹ 62 more rows[39m</span></span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a><span class="do">## [90m# ℹ 9 more variables: c_R_k_hat &lt;dbl&gt;, v_lower &lt;dbl&gt;, v_effect &lt;dbl&gt;,[39m</span></span>
<span id="cb5-36"><a href="#cb5-36" tabindex="-1"></a><span class="do">## [90m#   v_upper &lt;dbl&gt;, v_pH0 &lt;dbl&gt;, v_FDR &lt;dbl&gt;, v_n_eff &lt;dbl&gt;, v_R_k_hat &lt;dbl&gt;,[39m</span></span>
<span id="cb5-37"><a href="#cb5-37" tabindex="-1"></a><span class="do">## [90m#   count_data &lt;list&gt;[39m</span></span></code></pre></div>
<p>Of the output table, the estimate columns start with the prefix <code>c_</code> indicate <code>composition</code>, or with <code>v_</code> indicate <code>variability</code> (when formula_variability is set).</p>
</div>
</div>
<div class="section level2">
<h2 id="contrasts">Contrasts<a class="anchor" aria-label="anchor" href="#contrasts"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seurat_obj</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/sccomp_estimate.html">sccomp_estimate</a></span><span class="op">(</span> </span>
<span>    formula_composition <span class="op">=</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">type</span>, </span>
<span>    .sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>    .cell_group <span class="op">=</span> <span class="va">cell_group</span>, </span>
<span>    bimodal_mean_variability_association <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    cores <span class="op">=</span> <span class="fl">1</span> </span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/sccomp_remove_outliers.html">sccomp_remove_outliers</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="reference/sccomp_test.html">sccomp_test</a></span><span class="op">(</span></span>
<span>      contrasts <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"typecancer - typehealthy"</span>, <span class="st">"typehealthy - typecancer"</span><span class="op">)</span>,</span>
<span>      test_composition_above_logit_fold_change <span class="op">=</span> <span class="fl">0.2</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="do">## SAMPLING FOR MODEL 'glm_multi_beta_binomial' NOW (CHAIN 1).</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="do">## Chain 1: Gradient evaluation took 0.000378 seconds</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="do">## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 3.78 seconds.</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="do">## Chain 1: Adjust your expectations accordingly!</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="do">## Chain 1: Iteration:    1 / 4300 [  0%]  (Warmup)</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="do">## Chain 1: Iteration:  301 / 4300 [  7%]  (Sampling)</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 1300 / 4300 [ 30%]  (Sampling)</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 2300 / 4300 [ 53%]  (Sampling)</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 3300 / 4300 [ 76%]  (Sampling)</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 4300 / 4300 [100%]  (Sampling)</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="do">## Chain 1:  Elapsed Time: 2.108 seconds (Warm-up)</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="do">## Chain 1:                20.175 seconds (Sampling)</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="do">## Chain 1:                22.283 seconds (Total)</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="do">## Chain 1:</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="do">## [90m# A tibble: 60 × 18[39m</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="do">##    cell_group  parameter factor c_lower c_effect c_upper   c_pH0   c_FDR c_n_eff</span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="do">##    [3m[90m&lt;chr&gt;[39m[23m       [3m[90m&lt;chr&gt;[39m[23m     [3m[90m&lt;chr&gt;[39m[23m    [3m[90m&lt;dbl&gt;[39m[23m    [3m[90m&lt;dbl&gt;[39m[23m   [3m[90m&lt;dbl&gt;[39m[23m   [3m[90m&lt;dbl&gt;[39m[23m   [3m[90m&lt;dbl&gt;[39m[23m   [3m[90m&lt;dbl&gt;[39m[23m</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a><span class="do">## [90m 1[39m B immature  typecanc… [31mNA[39m      -[31m1[39m[31m.[39m[31m89[39m    -[31m1[39m[31m.[39m[31m40[39m   -[31m0[39m[31m.[39m[31m933[39m 0   [90m [39m   0   [90m [39m        [31mNA[39m</span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a><span class="do">## [90m 2[39m B immature  typeheal… [31mNA[39m       0.933    1.40    1.89  0   [90m [39m   0   [90m [39m        [31mNA[39m</span></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a><span class="do">## [90m 3[39m B mem       typecanc… [31mNA[39m      -[31m2[39m[31m.[39m[31m32[39m    -[31m1[39m[31m.[39m[31m73[39m   -[31m1[39m[31m.[39m[31m11[39m  0   [90m [39m   0   [90m [39m        [31mNA[39m</span></span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a><span class="do">## [90m 4[39m B mem       typeheal… [31mNA[39m       1.11     1.73    2.32  0   [90m [39m   0   [90m [39m        [31mNA[39m</span></span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a><span class="do">## [90m 5[39m CD4 cm S10… typecanc… [31mNA[39m      -[31m1[39m[31m.[39m[31m24[39m    -[31m0[39m[31m.[39m[31m852[39m  -[31m0[39m[31m.[39m[31m502[39m 2.50[90me[39m[31m-4[39m 5.00[90me[39m[31m-5[39m      [31mNA[39m</span></span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a><span class="do">## [90m 6[39m CD4 cm S10… typeheal… [31mNA[39m       0.502    0.852   1.24  2.50[90me[39m[31m-4[39m 5.00[90me[39m[31m-5[39m      [31mNA[39m</span></span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a><span class="do">## [90m 7[39m CD4 cm hig… typecanc… [31mNA[39m       0.920    1.82    2.91  2.50[90me[39m[31m-4[39m 8.33[90me[39m[31m-5[39m      [31mNA[39m</span></span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a><span class="do">## [90m 8[39m CD4 cm hig… typeheal… [31mNA[39m      -[31m2[39m[31m.[39m[31m91[39m    -[31m1[39m[31m.[39m[31m82[39m   -[31m0[39m[31m.[39m[31m920[39m 2.50[90me[39m[31m-4[39m 8.33[90me[39m[31m-5[39m      [31mNA[39m</span></span>
<span id="cb7-32"><a href="#cb7-32" tabindex="-1"></a><span class="do">## [90m 9[39m CD4 cm rib… typecanc… [31mNA[39m       0.349    1.00    1.72  9.00[90me[39m[31m-3[39m 2.11[90me[39m[31m-3[39m      [31mNA[39m</span></span>
<span id="cb7-33"><a href="#cb7-33" tabindex="-1"></a><span class="do">## [90m10[39m CD4 cm rib… typeheal… [31mNA[39m      -[31m1[39m[31m.[39m[31m72[39m    -[31m1[39m[31m.[39m[31m00[39m   -[31m0[39m[31m.[39m[31m349[39m 9.00[90me[39m[31m-3[39m 2.11[90me[39m[31m-3[39m      [31mNA[39m</span></span>
<span id="cb7-34"><a href="#cb7-34" tabindex="-1"></a><span class="do">## [90m# ℹ 50 more rows[39m</span></span>
<span id="cb7-35"><a href="#cb7-35" tabindex="-1"></a><span class="do">## [90m# ℹ 9 more variables: c_R_k_hat &lt;dbl&gt;, v_lower &lt;dbl&gt;, v_effect &lt;dbl&gt;,[39m</span></span>
<span id="cb7-36"><a href="#cb7-36" tabindex="-1"></a><span class="do">## [90m#   v_upper &lt;dbl&gt;, v_pH0 &lt;dbl&gt;, v_FDR &lt;dbl&gt;, v_n_eff &lt;dbl&gt;, v_R_k_hat &lt;dbl&gt;,[39m</span></span>
<span id="cb7-37"><a href="#cb7-37" tabindex="-1"></a><span class="do">## [90m#   count_data &lt;list&gt;[39m</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="categorical-factor-eg-bayesian-anova">Categorical factor (e.g. Bayesian ANOVA)<a class="anchor" aria-label="anchor" href="#categorical-factor-eg-bayesian-anova"></a>
</h2>
<p>This is achieved through model comparison with <code>loo</code>. In the following example, the model with association with factors better fits the data compared to the baseline model with no factor association. For comparisons <code>check_outliers</code> must be set to FALSE as the leave-one-out must work with the same amount of data, while outlier elimination does not guarantee it.</p>
<p>If <code>elpd_diff</code> is away from zero of &gt; 5 <code>se_diff</code> difference of 5, we are confident that a model is better than the other <a href="https://discourse.mc-stan.org/t/interpreting-elpd-diff-loo-package/1628/2?u=stemangiola" class="external-link">reference</a>. In this case, -79.9 / 11.5 = -6.9, therefore we can conclude that model one, the one with factor association, is better than model two.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/loo/" class="external-link">loo</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit first model</span></span>
<span><span class="va">model_with_factor_association</span> <span class="op">=</span> </span>
<span>  <span class="va">seurat_obj</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/sccomp_estimate.html">sccomp_estimate</a></span><span class="op">(</span> </span>
<span>    formula_composition <span class="op">=</span> <span class="op">~</span> <span class="va">type</span>, </span>
<span>    .sample <span class="op">=</span>  <span class="va">sample</span>, </span>
<span>    .cell_group <span class="op">=</span> <span class="va">cell_group</span>, </span>
<span>    bimodal_mean_variability_association <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    cores <span class="op">=</span> <span class="fl">1</span>, </span>
<span>    enable_loo <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="do">## SAMPLING FOR MODEL 'glm_multi_beta_binomial' NOW (CHAIN 1).</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="do">## Chain 1: Gradient evaluation took 0.000362 seconds</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="do">## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 3.62 seconds.</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="do">## Chain 1: Adjust your expectations accordingly!</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="do">## Chain 1: Iteration:    1 / 4300 [  0%]  (Warmup)</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="do">## Chain 1: Iteration:  301 / 4300 [  7%]  (Sampling)</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 1300 / 4300 [ 30%]  (Sampling)</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 2300 / 4300 [ 53%]  (Sampling)</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 3300 / 4300 [ 76%]  (Sampling)</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 4300 / 4300 [100%]  (Sampling)</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="do">## Chain 1:  Elapsed Time: 2.33 seconds (Warm-up)</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="do">## Chain 1:                19.001 seconds (Sampling)</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="do">## Chain 1:                21.331 seconds (Total)</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="do">## Chain 1:</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit second model</span></span>
<span><span class="va">model_without_association</span> <span class="op">=</span> </span>
<span>  <span class="va">seurat_obj</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/sccomp_estimate.html">sccomp_estimate</a></span><span class="op">(</span> </span>
<span>    formula_composition <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>, </span>
<span>    .sample <span class="op">=</span>  <span class="va">sample</span>, </span>
<span>    .cell_group <span class="op">=</span> <span class="va">cell_group</span>, </span>
<span>    bimodal_mean_variability_association <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    cores <span class="op">=</span> <span class="fl">1</span> , </span>
<span>    enable_loo <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="do">## SAMPLING FOR MODEL 'glm_multi_beta_binomial' NOW (CHAIN 1).</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="do">## Chain 1: Gradient evaluation took 0.000281 seconds</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="do">## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 2.81 seconds.</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="do">## Chain 1: Adjust your expectations accordingly!</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="do">## Chain 1: Iteration:    1 / 4300 [  0%]  (Warmup)</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="do">## Chain 1: Iteration:  301 / 4300 [  7%]  (Sampling)</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 1300 / 4300 [ 30%]  (Sampling)</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 2300 / 4300 [ 53%]  (Sampling)</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 3300 / 4300 [ 76%]  (Sampling)</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 4300 / 4300 [100%]  (Sampling)</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="do">## Chain 1:  Elapsed Time: 2.154 seconds (Warm-up)</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="do">## Chain 1:                25.352 seconds (Sampling)</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="do">## Chain 1:                27.506 seconds (Total)</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="do">## Chain 1:</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare models</span></span>
<span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo_compare.html" class="external-link">loo_compare</a></span><span class="op">(</span></span>
<span>  <span class="va">model_with_factor_association</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="st">"fit"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html" class="external-link">loo</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">model_without_association</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="st">"fit"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html" class="external-link">loo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="do">##        elpd_diff se_diff</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="do">## model1   0.0       0.0  </span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="do">## model2 -81.5      11.3</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="differential-variability-binary-factor">Differential variability, binary factor<a class="anchor" aria-label="anchor" href="#differential-variability-binary-factor"></a>
</h2>
<p>We can model the cell-group variability also dependent on the type, and so test differences in variability</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">=</span> </span>
<span>  <span class="va">seurat_obj</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/sccomp_estimate.html">sccomp_estimate</a></span><span class="op">(</span> </span>
<span>    formula_composition <span class="op">=</span> <span class="op">~</span> <span class="va">type</span>, </span>
<span>    formula_variability <span class="op">=</span> <span class="op">~</span> <span class="va">type</span>,</span>
<span>    .sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>    .cell_group <span class="op">=</span> <span class="va">cell_group</span>,</span>
<span>    bimodal_mean_variability_association <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    cores <span class="op">=</span> <span class="fl">1</span> </span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/sccomp_remove_outliers.html">sccomp_remove_outliers</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="reference/sccomp_test.html">sccomp_test</a></span><span class="op">(</span></span>
<span>      test_composition_above_logit_fold_change <span class="op">=</span> <span class="fl">0.2</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="do">## SAMPLING FOR MODEL 'glm_multi_beta_binomial' NOW (CHAIN 1).</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="do">## Chain 1: Gradient evaluation took 0.000313 seconds</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="do">## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 3.13 seconds.</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="do">## Chain 1: Adjust your expectations accordingly!</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="do">## Chain 1: Iteration:    1 / 4300 [  0%]  (Warmup)</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="do">## Chain 1: Iteration:  301 / 4300 [  7%]  (Sampling)</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 1300 / 4300 [ 30%]  (Sampling)</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 2300 / 4300 [ 53%]  (Sampling)</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 3300 / 4300 [ 76%]  (Sampling)</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 4300 / 4300 [100%]  (Sampling)</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="do">## Chain 1:  Elapsed Time: 4.229 seconds (Warm-up)</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="do">## Chain 1:                34.806 seconds (Sampling)</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="do">## Chain 1:                39.035 seconds (Total)</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="do">## Chain 1:</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="do">## [90m# A tibble: 60 × 18[39m</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="do">##    cell_group   parameter factor c_lower c_effect c_upper  c_pH0   c_FDR c_n_eff</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="do">##    [3m[90m&lt;chr&gt;[39m[23m        [3m[90m&lt;chr&gt;[39m[23m     [3m[90m&lt;chr&gt;[39m[23m    [3m[90m&lt;dbl&gt;[39m[23m    [3m[90m&lt;dbl&gt;[39m[23m   [3m[90m&lt;dbl&gt;[39m[23m  [3m[90m&lt;dbl&gt;[39m[23m   [3m[90m&lt;dbl&gt;[39m[23m   [3m[90m&lt;dbl&gt;[39m[23m</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="do">## [90m 1[39m B immature   (Interce… [31mNA[39m       0.579    0.936  1.31   0      0         [4m6[24m451.</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="do">## [90m 2[39m B immature   typeheal… type     0.826    1.34   1.87   0      0         [4m5[24m763.</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="do">## [90m 3[39m B mem        (Interce… [31mNA[39m      -[31m1[39m[31m.[39m[31m30[39m    -[31m0[39m[31m.[39m[31m765[39m -[31m0[39m[31m.[39m[31m183[39m  0.030[4m5[24m 0.002[4m2[24m[4m1[24m   [4m5[24m056.</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="do">## [90m 4[39m B mem        typeheal… type     1.08     1.81   2.52   0      0         [4m4[24m316.</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="do">## [90m 5[39m CD4 cm S100… (Interce… [31mNA[39m       1.72     1.98   2.22   0      0         [4m6[24m246.</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="do">## [90m 6[39m CD4 cm S100… typeheal… type     0.273    0.688  1.08   0.011[4m8[24m 0.005[4m3[24m[4m9[24m   [4m4[24m818.</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="do">## [90m 7[39m CD4 cm high… (Interce… [31mNA[39m      -[31m0[39m[31m.[39m[31m846[39m   -[31m0[39m[31m.[39m[31m400[39m  0.087[4m6[24m 0.197  0.026[4m6[24m    [4m4[24m385.</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="do">## [90m 8[39m CD4 cm high… typeheal… type    -[31m3[39m[31m.[39m[31m24[39m    -[31m1[39m[31m.[39m[31m48[39m   0.932  0.153  0.057[4m3[24m    [4m3[24m014.</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="do">## [90m 9[39m CD4 cm ribo… (Interce… [31mNA[39m       0.130    0.470  0.832  0.056[4m5[24m 0.009[4m4[24m[4m2[24m   [4m4[24m641.</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="do">## [90m10[39m CD4 cm ribo… typeheal… type    -[31m1[39m[31m.[39m[31m92[39m    -[31m1[39m[31m.[39m[31m0[39m[31m9[39m  -[31m0[39m[31m.[39m[31m0[39m[31m43[4m7[24m[39m 0.046[4m5[24m 0.013[4m9[24m    [4m3[24m984.</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="do">## [90m# ℹ 50 more rows[39m</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="do">## [90m# ℹ 9 more variables: c_R_k_hat &lt;dbl&gt;, v_lower &lt;dbl&gt;, v_effect &lt;dbl&gt;,[39m</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="do">## [90m#   v_upper &lt;dbl&gt;, v_pH0 &lt;dbl&gt;, v_FDR &lt;dbl&gt;, v_n_eff &lt;dbl&gt;, v_R_k_hat &lt;dbl&gt;,[39m</span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="do">## [90m#   count_data &lt;list&gt;[39m</span></span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="suggested-settings">Suggested settings<a class="anchor" aria-label="anchor" href="#suggested-settings"></a>
</h1>
<div class="section level2">
<h2 id="for-single-cell-rna-sequencing">For single-cell RNA sequencing<a class="anchor" aria-label="anchor" href="#for-single-cell-rna-sequencing"></a>
</h2>
<p>We recommend setting <code>bimodal_mean_variability_association  = TRUE</code>. The bimodality of the mean-variability association can be confirmed from the plots$credible_intervals_2D (see below).</p>
</div>
<div class="section level2">
<h2 id="for-cytof-and-microbiome-data">For CyTOF and microbiome data<a class="anchor" aria-label="anchor" href="#for-cytof-and-microbiome-data"></a>
</h2>
<p>We recommend setting <code>bimodal_mean_variability_association  = FALSE</code> (Default).</p>
</div>
</div>
<div class="section level1">
<h1 id="visualisation">Visualisation<a class="anchor" aria-label="anchor" href="#visualisation"></a>
</h1>
<div class="section level2">
<h2 id="summary-plots">Summary plots<a class="anchor" aria-label="anchor" href="#summary-plots"></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="do">## [1m[22mJoining with `by = join_by(cell_group, sample)`</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="do">## Joining with `by = join_by(cell_group, type)`</span></span></code></pre></div>
<p>A plot of group proportion, faceted by groups. The blue boxplots represent the posterior predictive check. If the model is likely to be descriptively adequate to the data, the blue box plot should roughly overlay with the black box plot, which represents the observed data. The outliers are coloured in red. A box plot will be returned for every (discrete) covariate present in <code>formula_composition</code>. The colour coding represents the significant associations for composition and/or variability.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">boxplot</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="do">## [[1]]</span></span></code></pre></div>
<p><img src="inst/figures/unnamed-chunk-14-1.png"><!-- --></p>
<p>A plot of estimates of differential composition (c_) on the x-axis and differential variability (v_) on the y-axis. The error bars represent 95% credible intervals. The dashed lines represent the minimal effect that the hypothesis test is based on. An effect is labelled as significant if bigger than the minimal effect according to the 95% credible interval. Facets represent the covariates in the model.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">credible_intervals_1D</span></span></code></pre></div>
<p><img src="inst/figures/unnamed-chunk-15-1.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="visualisation-of-the-mcmc-chains-from-the-posterior-distribution">Visualisation of the MCMC chains from the posterior distribution<a class="anchor" aria-label="anchor" href="#visualisation-of-the-mcmc-chains-from-the-posterior-distribution"></a>
</h2>
<p>It is possible to directly evaluate the posterior distribution. In this example, we plot the Monte Carlo chain for the slope parameter of the first cell type. We can see that it has converged and is negative with probability 1.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="st">"fit"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">rstan</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/rstan/reference/stanfit-method-traceplot.html" class="external-link">traceplot</a></span><span class="op">(</span><span class="st">"beta[2,1]"</span><span class="op">)</span></span></code></pre></div>
<p><img src="inst/figures/unnamed-chunk-16-1.png"><!-- --></p>
<p>Plot 1D significance plot</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="do">## [1m[22mJoining with `by = join_by(cell_group, sample)`</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="do">## Joining with `by = join_by(cell_group, type)`</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">credible_intervals_1D</span></span></code></pre></div>
<p><img src="inst/figures/unnamed-chunk-17-1.png"><!-- --></p>
<p>Plot 2D significance plot. Data points are cell groups. Error bars are the 95% credible interval. The dashed lines represent the default threshold fold change for which the probabilities (c_pH0, v_pH0) are calculated. pH0 of 0 represent the rejection of the null hypothesis that no effect is observed.</p>
<p>This plot is provided only if differential variability has been tested. The differential variability estimates are reliable only if the linear association between mean and variability for <code>(intercept)</code> (left-hand side facet) is satisfied. A scatterplot (besides the Intercept) is provided for each category of interest. The for each category of interest, the composition and variability effects should be generally uncorrelated.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">credible_intervals_2D</span></span></code></pre></div>
<p><img src="inst/figures/unnamed-chunk-18-1.png"><!-- --></p>
</div>
</div>
<div class="section level1">
<h1 id="multilevel-modelling">Multilevel modelling<a class="anchor" aria-label="anchor" href="#multilevel-modelling"></a>
</h1>
<p><code>sccomp</code> is cabable of estimating population (i.e. fixed) and group (i.e. random) effects. The formulation is analogous to the <code>lme4</code> package and <code>brms</code>.</p>
<p>!! For now, only one grouping is allowed (e.g. group2__).</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">=</span> </span>
<span>  <span class="va">seurat_obj</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/sccomp_estimate.html">sccomp_estimate</a></span><span class="op">(</span> </span>
<span>    formula_composition <span class="op">=</span> <span class="op">~</span> <span class="va">type</span> <span class="op">+</span> <span class="va">continuous_covariate</span> <span class="op">+</span> <span class="op">(</span><span class="va">type</span> <span class="op">|</span> <span class="va">group2__</span><span class="op">)</span>, </span>
<span>    formula_variability <span class="op">=</span> <span class="op">~</span> <span class="va">type</span>,</span>
<span>    .sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>    .cell_group <span class="op">=</span> <span class="va">cell_group</span>,</span>
<span>    bimodal_mean_variability_association <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    cores <span class="op">=</span> <span class="fl">1</span> </span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/sccomp_remove_outliers.html">sccomp_remove_outliers</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="reference/sccomp_test.html">sccomp_test</a></span><span class="op">(</span></span>
<span>      test_composition_above_logit_fold_change <span class="op">=</span> <span class="fl">0.2</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="do">## SAMPLING FOR MODEL 'glm_multi_beta_binomial' NOW (CHAIN 1).</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a><span class="do">## Chain 1: Gradient evaluation took 0.00047 seconds</span></span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a><span class="do">## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 4.7 seconds.</span></span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a><span class="do">## Chain 1: Adjust your expectations accordingly!</span></span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a><span class="do">## Chain 1: Iteration:    1 / 4300 [  0%]  (Warmup)</span></span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a><span class="do">## Chain 1: Iteration:  301 / 4300 [  7%]  (Sampling)</span></span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 1300 / 4300 [ 30%]  (Sampling)</span></span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 2300 / 4300 [ 53%]  (Sampling)</span></span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 3300 / 4300 [ 76%]  (Sampling)</span></span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a><span class="do">## Chain 1: Iteration: 4300 / 4300 [100%]  (Sampling)</span></span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a><span class="do">## Chain 1: </span></span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a><span class="do">## Chain 1:  Elapsed Time: 5.401 seconds (Warm-up)</span></span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a><span class="do">## Chain 1:                41.776 seconds (Sampling)</span></span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a><span class="do">## Chain 1:                47.177 seconds (Total)</span></span>
<span id="cb29-19"><a href="#cb29-19" tabindex="-1"></a><span class="do">## Chain 1:</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="do">## [90m# A tibble: 210 × 18[39m</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a><span class="do">##    cell_group parameter  factor c_lower c_effect c_upper   c_pH0   c_FDR c_n_eff</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a><span class="do">##    [3m[90m&lt;chr&gt;[39m[23m      [3m[90m&lt;chr&gt;[39m[23m      [3m[90m&lt;chr&gt;[39m[23m    [3m[90m&lt;dbl&gt;[39m[23m    [3m[90m&lt;dbl&gt;[39m[23m   [3m[90m&lt;dbl&gt;[39m[23m   [3m[90m&lt;dbl&gt;[39m[23m   [3m[90m&lt;dbl&gt;[39m[23m   [3m[90m&lt;dbl&gt;[39m[23m</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a><span class="do">## [90m 1[39m B immature (Intercep… [31mNA[39m       0.523   1.04     1.61  7.50[90me[39m[31m-4[39m 1.11[90me[39m[31m-4[39m   [4m2[24m585.</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a><span class="do">## [90m 2[39m B immature typehealt… type     0.581   1.27     1.88  1.00[90me[39m[31m-3[39m 5.00[90me[39m[31m-4[39m   [4m2[24m966.</span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a><span class="do">## [90m 3[39m B immature continuou… conti…  -[31m0[39m[31m.[39m[31m199[39m   0.043[4m8[24m   0.320 8.77[90me[39m[31m-1[39m 6.31[90me[39m[31m-1[39m   [4m6[24m394.</span></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a><span class="do">## [90m 4[39m B immature (Intercep… [31mNA[39m      -[31m0[39m[31m.[39m[31m584[39m  -[31m0[39m[31m.[39m[31m0[39m[31m84[4m2[24m[39m   0.358 6.94[90me[39m[31m-1[39m 5.90[90me[39m[31m-1[39m     [31mNA[39m </span></span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a><span class="do">## [90m 5[39m B immature typehealt… [31mNA[39m      -[31m0[39m[31m.[39m[31m358[39m   0.084[4m2[24m   0.584 6.94[90me[39m[31m-1[39m 5.90[90me[39m[31m-1[39m     [31mNA[39m </span></span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a><span class="do">## [90m 6[39m B immature (Intercep… [31mNA[39m      -[31m0[39m[31m.[39m[31m581[39m  -[31m0[39m[31m.[39m[31m0[39m[31m46[4m1[24m[39m   0.445 7.39[90me[39m[31m-1[39m 6.53[90me[39m[31m-1[39m     [31mNA[39m </span></span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a><span class="do">## [90m 7[39m B immature typehealt… [31mNA[39m      -[31m0[39m[31m.[39m[31m445[39m   0.046[4m1[24m   0.581 7.39[90me[39m[31m-1[39m 6.53[90me[39m[31m-1[39m     [31mNA[39m </span></span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a><span class="do">## [90m 8[39m B mem      (Intercep… [31mNA[39m      -[31m1[39m[31m.[39m[31m0[39m[31m2[39m   -[31m0[39m[31m.[39m[31m368[39m    0.423 3.26[90me[39m[31m-1[39m 5.62[90me[39m[31m-2[39m   [4m2[24m268.</span></span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a><span class="do">## [90m 9[39m B mem      typehealt… type     0.529   1.42     2.21  5.25[90me[39m[31m-3[39m 2.81[90me[39m[31m-3[39m   [4m2[24m556.</span></span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a><span class="do">## [90m10[39m B mem      continuou… conti…  -[31m0[39m[31m.[39m[31m236[39m   0.062[4m7[24m   0.392 7.97[90me[39m[31m-1[39m 5.82[90me[39m[31m-1[39m   [4m7[24m124.</span></span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a><span class="do">## [90m# ℹ 200 more rows[39m</span></span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a><span class="do">## [90m# ℹ 9 more variables: c_R_k_hat &lt;dbl&gt;, v_lower &lt;dbl&gt;, v_effect &lt;dbl&gt;,[39m</span></span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a><span class="do">## [90m#   v_upper &lt;dbl&gt;, v_pH0 &lt;dbl&gt;, v_FDR &lt;dbl&gt;, v_n_eff &lt;dbl&gt;, v_R_k_hat &lt;dbl&gt;,[39m</span></span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a><span class="do">## [90m#   count_data &lt;list&gt;[39m</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="removal-of-unwanted-variation">Removal of unwanted variation<a class="anchor" aria-label="anchor" href="#removal-of-unwanted-variation"></a>
</h1>
<p>After you model your dataset, you can remove the unwanted variation from your input data, <strong>for visualisation purposes</strong></p>
<p>We decide to just keep the type population (i.e. fixed) effect for abundance, and do not keep it for variability.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">|&gt;</span> <span class="fu"><a href="reference/sccomp_remove_unwanted_variation.html">sccomp_remove_unwanted_variation</a></span><span class="op">(</span><span class="op">~</span><span class="va">type</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="do">## sccomp says: calculating residuals</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a><span class="do">## sccomp says: regressing out unwanted factors</span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a><span class="do">## [90m# A tibble: 600 × 5[39m</span></span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a><span class="do">##    sample       cell_group adjusted_proportion adjusted_counts logit_residuals</span></span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a><span class="do">##    [3m[90m&lt;chr&gt;[39m[23m        [3m[90m&lt;chr&gt;[39m[23m                    [3m[90m&lt;dbl&gt;[39m[23m           [3m[90m&lt;dbl&gt;[39m[23m           [3m[90m&lt;dbl&gt;[39m[23m</span></span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a><span class="do">## [90m 1[39m 10x_6K       B immature              0.055[4m8[24m           262.          -[31m0[39m[31m.[39m[31m702[39m </span></span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a><span class="do">## [90m 2[39m 10x_8K       B immature              0.146           [4m1[24m096.           0.380 </span></span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a><span class="do">## [90m 3[39m GSE115189    B immature              0.114            269.           0.074[4m5[24m</span></span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a><span class="do">## [90m 4[39m SCP345_580   B immature              0.091[4m4[24m           527.          -[31m0[39m[31m.[39m[31m145[39m </span></span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a><span class="do">## [90m 5[39m SCP345_860   B immature              0.153            981.           0.438 </span></span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a><span class="do">## [90m 6[39m SCP424_pbmc1 B immature              0.114            306.           0.052[4m5[24m</span></span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a><span class="do">## [90m 7[39m SCP424_pbmc2 B immature              0.204            609.           0.778 </span></span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a><span class="do">## [90m 8[39m SCP591       B immature              0.025[4m1[24m            14.3         -[31m1[39m[31m.[39m[31m52[39m  </span></span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a><span class="do">## [90m 9[39m SI-GA-E5     B immature              0.027[4m7[24m           116.          -[31m0[39m[31m.[39m[31m683[39m </span></span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a><span class="do">## [90m10[39m SI-GA-E7     B immature              0.106            779.           0.749 </span></span>
<span id="cb33-18"><a href="#cb33-18" tabindex="-1"></a><span class="do">## [90m# ℹ 590 more rows[39m</span></span></code></pre></div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://www.bioconductor.org/packages/sccomp" class="external-link">View on Bioconductor</a></li>
<li><a href="https://github.com/stemangiola/sccomp/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/stemangiola/sccomp/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a> </li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing sccomp</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Stefano Mangiola <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.tidyverse.org/lifecycle/#maturing" class="external-link"><img src="https://img.shields.io/badge/lifecycle-maturing-blue.svg" alt="Lifecycle:maturing"></a></li>
<li><a href="https://github.com/stemangiola/tidyseurat/actions/" class="external-link"><img src="https://github.com/stemangiola/tidyseurat/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Stefano Mangiola.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
