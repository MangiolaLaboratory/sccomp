---
title: "latex_equations"
author: "Stefano Mangiola"
date: "9/17/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

de chunks within the document. You can embed an R code chunk like this:

# Simplest model



```{=tex}
\begin{align}

& \text{BetaBinomial}^{*}\left ( k_{g,s} | n_{s}, \alpha_{g}, \beta_{g} \right ) = {n_{s} \choose k_{g,s}}{\frac {\mathrm {B} (k_{g,s}+\alpha_{g} ,n_{s}-k_{g,s}+\beta_{g} )}{\mathrm {B} (\alpha_{g} ,\beta_{g} )}}  & \textrm{ (1) } \\

& \alpha_{g} = \pi_{g} \sigma_{g}; \beta_{g} = (1-\pi_{g}) \sigma_{g} \textrm{ for } 0 < \pi_{g} < 1 \textrm{ and } \sigma_{g} > 0 & \textrm{ (2) } \\

& \text{BetaBinomial}\left ( k_{g,s} | n_{s}, \pi_{g}, \sigma_{g} \right ) = {n_{s} \choose k_{g,s}}{\frac {\mathrm {B} (k_{g,s}+(\pi_{g} \sigma_{g}) ,n_{s}-k_{g,s}+((1-\pi_{g}) \sigma_{g}) )}{\mathrm {B} (\pi_{g} \sigma_{g} , (1-\pi_{g}) \sigma_{g} )}}  & \textrm{ (3) } \\





& \textbf{ Intercept-only model } \\

& P\left ( \pi, \sigma \right ) 
 \prod_{s=1}^{S} \prod_{g=1}^{G} P\left ( k_{g,s} | n_{s}, \pi_{g}, \sigma_{g} \right ) & \textrm{ (4) } \\

& k_{g,s} \sim \text{BetaBinomial} \left(n_{s}, \pi_{g}, \sigma_{g} \right ) \textrm{ for } \sum_{g=1}^{G} \pi_{g} = 1 \textrm{ and } \sigma_{g} > 0 & \textrm{ (5) } \\





& \boldsymbol{\pi} = \text{multinomialLogistic} \left(\boldsymbol{\mu} \right) =  \frac{e^{\boldsymbol{\mu}}}{\sum_{g=1}^{G} e^{\mu_{g} }} \textrm{ for } \sum_{g=1}^{G} \mu_{g} = 0  & \textrm{ (6) } \\

& \sigma_{g} = e^{\omega_{g}}  & \textrm{ (7) } \\

& \text{E}\left(\omega_{g} \right) = \lambda_{0} + \lambda_{1} \mu_{g} & \textrm{ (8) } \\





& \textbf{ Intercept-only hierarchical model } \\

& P\left ( \boldsymbol{\mu}, \lambda_{0}, \lambda \right )  \prod_{g=1}^{G} P\left ( \omega_{g} | \mu_{g}, \lambda_{0}, \lambda, \phi \right ) \prod_{s=1}^{S} \prod_{g=1}^{G} P\left ( k_{g,s} | n_{s}, \mu_{g}, \omega_{g} \right ) & \textrm{ (9) } \\

& k_{g,s} \sim \text{BetaBinomial} \left(n_{s}, \text{multinomialLogistic}(\mu)_{g}, e^{\omega}_{g} \right ) \textrm{ for } \sum_{g=1}^{G} \mu_{g} = 0 & \textrm{ (10) } \\

& \omega_{g} \sim \text{Normal} \left(\lambda_{0} + \lambda_{1} \mu_{g}, \phi \right ) & \textrm{ (11) } \\


& \mu_{g,condition} = \text{intercept}_{g} + \text{effect}_{g} x_{s} \textrm{ for } \sum_{g=1}^{G} \text{intercept}_{g} = 0 \textrm{ and } \sum_{g=1}^{G} \text{effect}_{g} = 0 & \textrm{ (12) } \\


& \boldsymbol{M}_{G,C} \times \boldsymbol{X}_{C,S} \textrm{ for } c \in[1..C] \sum_{g=1}^{G} \mu_{g, c} = 0 & \textrm{ (13) } \\




& \textbf{ Regression hierarchical model } \\

& P\left (\boldsymbol{M}, \lambda_{0}, \lambda, \phi \right )  \prod_{g=1}^{G} P\left ( \omega_{g} | \mu_{g,1}, \lambda_{0}, \lambda_{1}, \phi \right ) \prod_{s=1}^{S} \prod_{g=1}^{G} P\left ( k_{g,s} | n_{s}, \mu_{g}, X_{s}, \omega_{g} \right ) & \textrm{ (14) } \\

& k_{g,s} \sim \text{BetaBinomial} \left(n_{s}, \text{multinomialLogistic}(\boldsymbol{\mu} \boldsymbol{X})_{g,s}, e^{\omega}_{g} \right )  \textrm{ for } c \in[1..C] \sum_{g=1}^{G} \mu_{g, c} = 0 & \textrm{ (15) } \\

& \omega_{g} \sim \text{Normal} \left(\lambda_{0} + \lambda_{1} \mu_{g,1}, \phi \right ) & \textrm{ (16) } \\
& \mu_{g,c} \sim \text{Normal} \left(0,5 \right ) & \textrm{ (17) } \\
& \lambda_{0}, \lambda_{1}, \phi \sim \text{Normal} \left(0,5 \right ) & \textrm{ (18) } \\

& \text{E}\left(\omega_{g,i} \right) = \lambda_{0} + \lambda_{1} \mu_{g,i} & \textrm{ (19) } \\
& \omega_{g,i} \sim \text{Normal} \left(\lambda_{0} + \lambda_{1} \mu_{g,i}, \phi \right ) & \textrm{ (20) } \\

\end{align}
```

