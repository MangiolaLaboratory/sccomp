---
title: "latex_equations"
author: "Stefano Mangiola"
date: "9/17/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

de chunks within the document. You can embed an R code chunk like this:

# Simplest model



```{=tex}
\begin{align}

& \text{BetaBinomial}^{*}\left ( k_{g,s} | n_{s}, \alpha_{g}, \beta_{g} \right ) = {n_{s} \choose k_{g,s}}{\frac {\mathrm {B} (k_{g,s}+\alpha_{g} ,n_{s}-k_{g,s}+\beta_{g} )}{\mathrm {B} (\alpha_{g} ,\beta_{g} )}}  & \textrm{ (1) } \\

& \alpha_{g} = \pi_{g} \sigma_{g}; \beta_{g} = (1-\pi_{g}) \sigma_{g} \textrm{ for } 0 < \pi_{g} < 1 \textrm{ and } \sigma_{g} > 0 & \textrm{ (2) } \\

& \text{BetaBinomial}\left ( k_{g,s} | n_{s}, \pi_{g}, \sigma_{g} \right ) = {n_{s} \choose k_{g,s}}{\frac {\mathrm {B} (k_{g,s}+(\pi_{g} \sigma_{g}) ,n_{s}-k_{g,s}+((1-\pi_{g}) \sigma_{g}) )}{\mathrm {B} (\pi_{g} \sigma_{g} , (1-\pi_{g}) \sigma_{g} )}}  & \textrm{ (3) } \\





& \textbf{ Single-mean model } \\

& P\left ( \boldsymbol{\pi}, \boldsymbol{\sigma} \right ) 
 \prod_{s=1}^{S} \prod_{g=1}^{G} P\left ( k_{g,s} | n_{s}, \pi_{g}, \sigma_{g} \right ) & \textrm{ (4) } \\

& k_{g,s} \sim \text{BetaBinomial} \left(n_{s}, \pi_{g}, \sigma_{g} \right ) \textrm{ for } \sum_{g=1}^{G} \pi_{g} = 1 \textrm{ and } \sigma_{g} > 0 & \textrm{ (5) } \\





& \boldsymbol{\pi} = \text{InverseMultinomialLogistic} \left(\boldsymbol{\mu} \right) =  \frac{e^{\boldsymbol{\mu}}}{\sum_{g=1}^{G} e^{\mu_{g} }} \textrm{ for } \sum_{g=1}^{G} \mu_{g} = 0  & \textrm{ (6) } \\

& \sigma_{g} = e^{\omega_{g}}  & \textrm{ (7) } \\

& \text{E}\left(\omega_{g} \right) = \lambda_{0} + \lambda_{1} \mu_{g} & \textrm{ (8) } \\





& \textbf{ Single-mean hierarchical model } \\

& P\left ( \boldsymbol{\mu}, \lambda_{0}, \lambda \right )  \prod_{g=1}^{G} P\left ( \omega_{g} | \mu_{g}, \lambda_{0}, \lambda, \phi \right ) \prod_{s=1}^{S} \prod_{g=1}^{G} P\left ( k_{g,s} | n_{s}, \mu_{g}, \omega_{g} \right ) & \textrm{ (9) } \\

& k_{g,s} \sim \text{BetaBinomial} \left(n_{s}, \text{InverseMultinomialLogistic}(\boldsymbol{\mu})_{g}, e^{\omega}_{g} \right ) \textrm{ for } \sum_{g=1}^{G} \mu_{g} = 0 & \textrm{ (10) } \\

& \omega_{g} \sim \text{Normal} \left(\lambda_{0} + \lambda_{1} \mu_{g}, \phi \right ) & \textrm{ (11) } \\


& \textbf{ Regression hierarchical model } \\

& P\left (\boldsymbol{\Gamma}, \lambda_{0}, \lambda, \phi \right )  \prod_{g=1}^{G} P\left ( \omega_{g} | \gamma_{g,1}, \lambda_{0}, \lambda_{1}, \phi \right ) \prod_{s=1}^{S} \prod_{g=1}^{G} P\left ( k_{g,s} | n_{s}, \mu_{g,s}, X_{s}, \omega_{g} \right ) & \textrm{ (12) } \\

& k_{g,s} \sim \text{BetaBinomial} \left(n_{s}, \text{InverseMultinomialLogistic}(\boldsymbol{\mu_{s}})_{g}, e^{\omega}_{g} \right ) & \textrm{ (13) } \\

& \omega_{g} \sim \text{Normal} \left(\lambda_{0} + \lambda_{1} \gamma_{g,1}, \phi \right ) & \textrm{ (14) } \\
& \gamma_{g,c} \sim \text{Normal} \left(0,5 \right ) & \textrm{ (15) } \\
& \lambda_{0}, \lambda_{1}, \phi \sim \text{Normal} \left(0,5 \right ) & \textrm{ (16) } \\


& \frac{\psi_{g,s} \sim \text{Normal} \left(\lambda_{0} + \lambda_{1} \bar{\mu_{g,s}}, \phi \right )}{S} & \textrm{ (17) } \\
& \hat{\omega_{c}} = \omega_{c} - \left( \gamma_{c} \lambda_{1} \right)  \textrm{ for } C > 2, or = \omega_{c} \textrm{ otherwise } & \textrm{ (18) } \\




\end{align}
```


```{=tex}

\usepackage{mathtools}

\begin{document}
\[
    f(x)= 
\begin{dcases}
    \frac{x^2-x}{x},& \text{if } x\geq 1\\
    0,              & \text{otherwise}
\end{dcases}
\]
```


