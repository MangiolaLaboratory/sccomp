<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Overview of the sccomp package • sccomp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Overview of the sccomp package">
<meta property="og:description" content="sccomp">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sccomp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.7.12</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction.html">Overview of the sccomp package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/stemangiola/sccomp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Overview of the sccomp package</h1>
                        <h4 data-toc-skip class="author">Stefano
Mangiola</h4>
            
            <h4 data-toc-skip class="date">2024-06-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/stemangiola/sccomp/blob/HEAD/vignettes/introduction.Rmd" class="external-link"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="hidden name"><code>introduction.Rmd</code></div>

    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>Sccomp is a generalised method for differential composition and
      variability analyses. It tests differences in cell type
      proportion, for count data. It is able of flexible
      continuous/discrete models, removal of unwanted variation, removal
      of outliers, multilevel random/effect modelling.</p>
    </div>
    
<!-- badges: start -->
<p><a href="https://www.tidyverse.org/lifecycle/#maturing" class="external-link"><img src="https://img.shields.io/badge/lifecycle-maturing-blue.svg" alt="Lifecycle:maturing"></a> <a href="https://github.com/stemangiola/tidyseurat/actions/" class="external-link"><img src="https://github.com/stemangiola/tidyseurat/workflows/R-CMD-check/badge.svg" alt="R build status"></a> <!-- badges: end --></p>
<p>Sccomp is a generalised method for differential composition and
variability analyses.</p>
<div class="section level3">
<h3 id="characteristics">Characteristics<a class="anchor" aria-label="anchor" href="#characteristics"></a>
</h3>
<ul>
<li>Modelling counts</li>
<li>Modelling proportionality</li>
<li>Modelling cell-type specific variability</li>
<li>Cell-type information share for variability shrinkage</li>
<li>Testing differential variability</li>
<li>Probabilistic outlier identification</li>
<li>Cross-dataset learning (hyperpriors).</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p><strong>Bioconductor</strong></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"sccomp"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Github</strong></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"stemangiola/sccomp"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="analysis">Analysis<a class="anchor" aria-label="anchor" href="#analysis"></a>
</h2>
<p><code>sccomp</code> can model changes in composition and variability.
By default, the formula for variability is either <code>~1</code>, which
assumes that the cell-group variability is independent of any covariate
or <code>~ factor_of_interest</code>, which assumes that the model is
dependent on the factor of interest only. The variability model must be
a subset of the model for composition.</p>
<div class="section level3">
<h3 id="binary-factor">Binary factor<a class="anchor" aria-label="anchor" href="#binary-factor"></a>
</h3>
<p>Of the output table, the estimate columns start with the prefix
<code>c_</code> indicate <code>composition</code>, or with
<code>v_</code> indicate <code>variability</code> (when
formula_variability is set).</p>
<div class="section level4">
<h4 id="from-seurat-singlecellexperiment-metadata-objects">From Seurat, SingleCellExperiment, metadata objects<a class="anchor" aria-label="anchor" href="#from-seurat-singlecellexperiment-metadata-objects"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sccomp_result</span> <span class="op">=</span> </span>
<span>  <span class="va">single_cell_object</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/sccomp_estimate.html">sccomp_estimate</a></span><span class="op">(</span> </span>
<span>    formula_composition <span class="op">=</span> <span class="op">~</span> <span class="va">type</span>, </span>
<span>    .sample <span class="op">=</span>  <span class="va">sample</span>, </span>
<span>    .cell_group <span class="op">=</span> <span class="va">cell_group</span>, </span>
<span>    bimodal_mean_variability_association <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    cores <span class="op">=</span> <span class="fl">1</span> </span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/sccomp_remove_outliers.html">sccomp_remove_outliers</a></span><span class="op">(</span>cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># Optional</span></span>
<span>  <span class="fu"><a href="../reference/sccomp_test.html">sccomp_test</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="from-counts">From counts<a class="anchor" aria-label="anchor" href="#from-counts"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sccomp_result</span> <span class="op">=</span> </span>
<span>  <span class="va">counts_obj</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/sccomp_estimate.html">sccomp_estimate</a></span><span class="op">(</span> </span>
<span>    formula_composition <span class="op">=</span> <span class="op">~</span> <span class="va">type</span>, </span>
<span>    .sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>    .cell_group <span class="op">=</span> <span class="va">cell_group</span>,</span>
<span>    .count <span class="op">=</span> <span class="va">count</span>, </span>
<span>    bimodal_mean_variability_association <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    cores <span class="op">=</span> <span class="fl">1</span> </span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/sccomp_remove_outliers.html">sccomp_remove_outliers</a></span><span class="op">(</span>cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># Optional</span></span>
<span>  <span class="fu"><a href="../reference/sccomp_test.html">sccomp_test</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">## Chain 1: EXPERIMENTAL ALGORITHM:</span></span>
<span><span class="co">## Chain 1:   This procedure has not been thoroughly tested and may be unstable</span></span>
<span><span class="co">## Chain 1:   or buggy. The interface is subject to change.</span></span>
<span><span class="co">## Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Gradient evaluation took 0.000366 seconds</span></span>
<span><span class="co">## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 3.66 seconds.</span></span>
<span><span class="co">## Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Begin eta adaptation.</span></span>
<span><span class="co">## Chain 1: Iteration:   1 / 250 [  0%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration:  50 / 250 [ 20%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration: 100 / 250 [ 40%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration: 150 / 250 [ 60%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration: 200 / 250 [ 80%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration: 250 / 250 [100%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Success! Found best value [eta = 0.1].</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Begin stochastic gradient ascent.</span></span>
<span><span class="co">## Chain 1:   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes </span></span>
<span><span class="co">## Chain 1:    100        -4891.421             1.000            1.000</span></span>
<span><span class="co">## Chain 1:    200        -4373.450             0.559            1.000</span></span>
<span><span class="co">## Chain 1:    300        -4167.787             0.389            0.118</span></span>
<span><span class="co">## Chain 1:    400        -4027.529             0.301            0.118</span></span>
<span><span class="co">## Chain 1:    500        -3953.345             0.244            0.049</span></span>
<span><span class="co">## Chain 1:    600        -3885.684             0.206            0.049</span></span>
<span><span class="co">## Chain 1:    700        -3839.685             0.179            0.035</span></span>
<span><span class="co">## Chain 1:    800        -3814.016             0.157            0.035</span></span>
<span><span class="co">## Chain 1:    900        -3784.410             0.141            0.019</span></span>
<span><span class="co">## Chain 1:   1000        -3766.615             0.127            0.019</span></span>
<span><span class="co">## Chain 1:   1100        -3748.480             0.027            0.017</span></span>
<span><span class="co">## Chain 1:   1200        -3738.424             0.016            0.012</span></span>
<span><span class="co">## Chain 1:   1300        -3727.991             0.011            0.008   MEDIAN ELBO CONVERGED</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Drawing a sample of size 4000 from the approximate posterior... </span></span>
<span><span class="co">## Chain 1: COMPLETED.</span></span>
<span><span class="co">## Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">## Chain 1: EXPERIMENTAL ALGORITHM:</span></span>
<span><span class="co">## Chain 1:   This procedure has not been thoroughly tested and may be unstable</span></span>
<span><span class="co">## Chain 1:   or buggy. The interface is subject to change.</span></span>
<span><span class="co">## Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Gradient evaluation took 0.000321 seconds</span></span>
<span><span class="co">## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 3.21 seconds.</span></span>
<span><span class="co">## Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Begin eta adaptation.</span></span>
<span><span class="co">## Chain 1: Iteration:   1 / 250 [  0%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration:  50 / 250 [ 20%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration: 100 / 250 [ 40%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration: 150 / 250 [ 60%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration: 200 / 250 [ 80%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Success! Found best value [eta = 1] earlier than expected.</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Begin stochastic gradient ascent.</span></span>
<span><span class="co">## Chain 1:   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes </span></span>
<span><span class="co">## Chain 1:    100       -25741.263             1.000            1.000</span></span>
<span><span class="co">## Chain 1:    200        -2589.331             4.971            8.941</span></span>
<span><span class="co">## Chain 1:    300        -4676.037             3.463            1.000</span></span>
<span><span class="co">## Chain 1:    400        -2989.934             2.738            1.000</span></span>
<span><span class="co">## Chain 1:    500        -2541.888             2.226            0.564</span></span>
<span><span class="co">## Chain 1:    600        -1767.353             1.928            0.564</span></span>
<span><span class="co">## Chain 1:    700          683.307             2.165            0.564</span></span>
<span><span class="co">## Chain 1:    800         -546.929             2.175            1.000</span></span>
<span><span class="co">## Chain 1:    900          268.662             2.271            1.000</span></span>
<span><span class="co">## Chain 1:   1000        -2130.234             2.156            1.126</span></span>
<span><span class="co">## Chain 1:   1100        -1978.262             2.064            1.126   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   1200          453.611             1.706            1.126   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   1300         1458.564             1.730            1.126   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   1400        -1301.087             1.886            2.121   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   1500          332.817             2.359            2.249   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   1600         1177.953             2.387            2.249   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   1700         -752.607             2.285            2.249   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   1800          846.046             2.249            2.121   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   1900         -832.400             2.147            2.016   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   2000         -508.446             2.098            2.016   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   2100         -663.174             2.114            2.016   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   2200         -727.327             1.587            1.890   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   2300        -1676.448             1.574            1.890   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   2400          896.197             1.649            1.890   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   2500           48.032             2.924            1.890   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   2600        -1804.393             2.955            1.890   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   2700         -734.652             2.844            1.456   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   2800          231.266             3.073            1.456   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   2900         -366.079             3.035            1.456   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   3000          858.194             3.113            1.456   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   3100          742.450             3.106            1.456   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   3200         2346.505             3.165            1.456   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   3300         1085.348             3.225            1.456   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   3400          -20.341             8.374            1.456   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   3500          584.087             6.711            1.427   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   3600          288.525             6.711            1.427   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   3700         1333.403             6.644            1.162   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   3800         1326.903             6.227            1.035   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   3900          823.457             6.124            1.024   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   4000         1360.468             6.021            0.784   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   4100         1826.953             6.031            0.784   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   4200         -197.270             6.989            1.024   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   4300          396.428             7.023            1.024   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   4400        -1322.150             1.717            1.024   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   4500          857.123             1.868            1.024   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   4600         -501.075             2.036            1.300   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   4700         -936.146             2.004            1.300   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   4800        -1271.162             2.030            1.300   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   4900         -679.639             2.056            1.300   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   5000          300.498             2.343            1.498   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   5100        -1192.943             2.442            1.498   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   5200          209.676             2.085            1.498   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   5300        -1045.155             2.056            1.300   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   5400         -762.948             1.963            1.252   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   5500         -547.959             1.748            1.201   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   5600          438.583             1.701            1.201   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   5700         -153.490             2.041            1.252   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   5800          980.681             2.130            1.252   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   5900         2648.844             2.106            1.252   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   6000         -402.427             2.538            1.252   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   6100          441.494             2.604            1.912   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   6200         1720.239             2.009            1.201   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   6300          614.777             2.069            1.798   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   6400          636.064             2.035            1.798   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   6500        -1406.399             2.141            1.798   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   6600         -142.091             2.806            1.798   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   6700        -1542.173             2.511            1.452   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   6800          236.843             3.147            1.798   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   6900         1116.822             3.163            1.798   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   7000          210.369             2.835            1.798   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   7100         1492.810             2.730            1.452   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   7200         -261.577             3.326            1.798   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   7300         1075.202             3.271            1.452   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   7400         3482.085             3.337            1.452   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   7500         1280.420             3.363            1.719   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   7600         2191.019             2.515            1.243   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   7700         1146.452             2.515            1.243   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   7800          881.230             1.794            0.911   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   7900          477.859             1.800            0.911   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   8000          386.175             1.393            0.859   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   8100         1700.704             1.384            0.844   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   8200         1424.562             0.733            0.773   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   8300         2422.079             0.650            0.691   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   8400         2325.010             0.585            0.416   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   8500          387.950             0.912            0.416   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   8600         -580.273             1.038            0.773   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   8700         2070.623             1.074            0.773   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   8800         1915.335             1.052            0.773   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   8900         1662.063             0.983            0.412   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   9000          -36.103             5.663            0.773   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   9100          967.347             5.690            1.037   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   9200         1923.356             5.720            1.037   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   9300          337.434             6.149            1.280   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   9400         1288.674             6.219            1.280   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   9500         4454.273             5.790            1.037   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   9600         1335.528             5.857            1.037   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   9700         1159.692             5.744            0.738   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   9800         2294.759             5.785            0.738   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   9900          628.045             6.036            1.037   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1:   10000          279.372             1.457            1.037   MAY BE DIVERGING... INSPECT ELBO</span></span>
<span><span class="co">## Chain 1: Informational Message: The maximum number of iterations is reached! The algorithm may not have converged.</span></span>
<span><span class="co">## Chain 1: This variational approximation is not guaranteed to be meaningful.</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Drawing a sample of size 19999 from the approximate posterior... </span></span>
<span><span class="co">## Chain 1: COMPLETED.</span></span>
<span><span class="co">## Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">## Chain 1: EXPERIMENTAL ALGORITHM:</span></span>
<span><span class="co">## Chain 1:   This procedure has not been thoroughly tested and may be unstable</span></span>
<span><span class="co">## Chain 1:   or buggy. The interface is subject to change.</span></span>
<span><span class="co">## Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Gradient evaluation took 0.00033 seconds</span></span>
<span><span class="co">## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 3.3 seconds.</span></span>
<span><span class="co">## Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Begin eta adaptation.</span></span>
<span><span class="co">## Chain 1: Iteration:   1 / 250 [  0%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration:  50 / 250 [ 20%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration: 100 / 250 [ 40%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration: 150 / 250 [ 60%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration: 200 / 250 [ 80%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Success! Found best value [eta = 1] earlier than expected.</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Begin stochastic gradient ascent.</span></span>
<span><span class="co">## Chain 1:   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes </span></span>
<span><span class="co">## Further attempt with Variational Bayes: Error in eval(expr, envir, enclos): stan::variational::normal_meanfield::calc_grad: The number of dropped evaluations has reached its maximum amount (10). Your model may be either severely ill-conditioned or misspecified.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">## Chain 1: EXPERIMENTAL ALGORITHM:</span></span>
<span><span class="co">## Chain 1:   This procedure has not been thoroughly tested and may be unstable</span></span>
<span><span class="co">## Chain 1:   or buggy. The interface is subject to change.</span></span>
<span><span class="co">## Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Gradient evaluation took 0.000311 seconds</span></span>
<span><span class="co">## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 3.11 seconds.</span></span>
<span><span class="co">## Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Begin eta adaptation.</span></span>
<span><span class="co">## Chain 1: Iteration:   1 / 250 [  0%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration:  50 / 250 [ 20%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration: 100 / 250 [ 40%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration: 150 / 250 [ 60%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration: 200 / 250 [ 80%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Success! Found best value [eta = 1] earlier than expected.</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Begin stochastic gradient ascent.</span></span>
<span><span class="co">## Chain 1:   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes </span></span>
<span><span class="co">## Chain 1:    100        -3944.202             1.000            1.000</span></span>
<span><span class="co">## Chain 1:    200        -3670.834             0.537            1.000</span></span>
<span><span class="co">## Chain 1:    300        -3674.308             0.358            0.074</span></span>
<span><span class="co">## Chain 1:    400        -3662.324             0.270            0.074</span></span>
<span><span class="co">## Chain 1:    500        -3659.407             0.216            0.003   MEDIAN ELBO CONVERGED</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Drawing a sample of size 4000 from the approximate posterior... </span></span>
<span><span class="co">## Chain 1: COMPLETED.</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="summary-plots">Summary plots<a class="anchor" aria-label="anchor" href="#summary-plots"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span> <span class="op">=</span> <span class="va">sccomp_result</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## Joining with `by = join_by(cell_group, sample)`</span></span>
<span><span class="co">## Joining with `by = join_by(cell_group, type)`</span></span></code></pre>
<p>A plot of group proportion, faceted by groups. The blue boxplots
represent the posterior predictive check. If the model is likely to be
descriptively adequate to the data, the blue box plot should roughly
overlay with the black box plot, which represents the observed data. The
outliers are coloured in red. A box plot will be returned for every
(discrete) covariate present in <code>formula_composition</code>. The
colour coding represents the significant associations for composition
and/or variability.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">boxplot</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span></code></pre>
<p><img src="introduction_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>A plot of estimates of differential composition (c_) on the x-axis
and differential variability (v_) on the y-axis. The error bars
represent 95% credible intervals. The dashed lines represent the minimal
effect that the hypothesis test is based on. An effect is labelled as
significant if bigger than the minimal effect according to the 95%
credible interval. Facets represent the covariates in the model.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">credible_intervals_1D</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>We can plot the relationship between abundance and variability. As we
can see below, they are positively correlated, you also appreciate that
this relationship is by model for single cell RNA sequencing data.</p>
<p><code>sccomp</code> models, these relationship to obtain a shrinkage
effect on the estimates of both the abundance and the variability. This
shrinkage is adaptive as it is modelled jointly, thanks for Bayesian
inference.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">credible_intervals_2D</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="contrasts">Contrasts<a class="anchor" aria-label="anchor" href="#contrasts"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seurat_obj</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/sccomp_estimate.html">sccomp_estimate</a></span><span class="op">(</span> </span>
<span>    formula_composition <span class="op">=</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">type</span>, </span>
<span>    .sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>    .cell_group <span class="op">=</span> <span class="va">cell_group</span>, </span>
<span>    bimodal_mean_variability_association <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    cores <span class="op">=</span> <span class="fl">1</span> </span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/sccomp_test.html">sccomp_test</a></span><span class="op">(</span> contrasts <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"typecancer - typehealthy"</span>, <span class="st">"typehealthy - typecancer"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">## Chain 1: EXPERIMENTAL ALGORITHM:</span></span>
<span><span class="co">## Chain 1:   This procedure has not been thoroughly tested and may be unstable</span></span>
<span><span class="co">## Chain 1:   or buggy. The interface is subject to change.</span></span>
<span><span class="co">## Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Gradient evaluation took 0.000293 seconds</span></span>
<span><span class="co">## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 2.93 seconds.</span></span>
<span><span class="co">## Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Begin eta adaptation.</span></span>
<span><span class="co">## Chain 1: Iteration:   1 / 250 [  0%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration:  50 / 250 [ 20%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration: 100 / 250 [ 40%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration: 150 / 250 [ 60%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration: 200 / 250 [ 80%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Success! Found best value [eta = 1] earlier than expected.</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Begin stochastic gradient ascent.</span></span>
<span><span class="co">## Chain 1:   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes </span></span>
<span><span class="co">## Chain 1:    100        -3197.659             1.000            1.000</span></span>
<span><span class="co">## Chain 1:    200        -3159.290             0.506            1.000</span></span>
<span><span class="co">## Chain 1:    300        -3166.865             0.338            0.012</span></span>
<span><span class="co">## Chain 1:    400        -3161.350             0.254            0.012</span></span>
<span><span class="co">## Chain 1:    500        -3158.059             0.203            0.002   MEDIAN ELBO CONVERGED</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Drawing a sample of size 4000 from the approximate posterior... </span></span>
<span><span class="co">## Chain 1: COMPLETED.</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 60 × 18</span></span></span>
<span><span class="co">##    cell_group  parameter factor c_lower c_effect c_upper   c_pH0   c_FDR c_n_eff</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> B immature  typecanc… <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.92</span>     -<span style="color: #BB0000;">1.40</span>  -<span style="color: #BB0000;">0.856</span> 0   <span style="color: #949494;"> </span>   0   <span style="color: #949494;"> </span>        <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> B immature  typeheal… <span style="color: #BB0000;">NA</span>       0.856     1.40   1.92  0   <span style="color: #949494;"> </span>   0   <span style="color: #949494;"> </span>        <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> B mem       typecanc… <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">2.44</span>     -<span style="color: #BB0000;">1.79</span>  -<span style="color: #BB0000;">1.10</span>  0   <span style="color: #949494;"> </span>   0   <span style="color: #949494;"> </span>        <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> B mem       typeheal… <span style="color: #BB0000;">NA</span>       1.10      1.79   2.44  0   <span style="color: #949494;"> </span>   0   <span style="color: #949494;"> </span>        <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> CD4 cm S10… typecanc… <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.51</span>     -<span style="color: #BB0000;">1.01</span>  -<span style="color: #BB0000;">0.513</span> 5.00<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 1.25<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>      <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> CD4 cm S10… typeheal… <span style="color: #BB0000;">NA</span>       0.513     1.01   1.51  5.00<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 1.25<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>      <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> CD4 cm hig… typecanc… <span style="color: #BB0000;">NA</span>       1.09      2.00   2.91  0   <span style="color: #949494;"> </span>   0   <span style="color: #949494;"> </span>        <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> CD4 cm hig… typeheal… <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">2.91</span>     -<span style="color: #BB0000;">2.00</span>  -<span style="color: #BB0000;">1.09</span>  0   <span style="color: #949494;"> </span>   0   <span style="color: #949494;"> </span>        <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> CD4 cm rib… typecanc… <span style="color: #BB0000;">NA</span>       0.428     1.00   1.60  5.00<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 1.79<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>      <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> CD4 cm rib… typeheal… <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.60</span>     -<span style="color: #BB0000;">1.00</span>  -<span style="color: #BB0000;">0.428</span> 5.00<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 1.79<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>      <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 50 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 9 more variables: c_R_k_hat &lt;dbl&gt;, v_lower &lt;dbl&gt;, v_effect &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   v_upper &lt;dbl&gt;, v_pH0 &lt;dbl&gt;, v_FDR &lt;dbl&gt;, v_n_eff &lt;dbl&gt;, v_R_k_hat &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   count_data &lt;list&gt;</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="categorical-factor-e-g--bayesian-anova">Categorical factor (e.g. Bayesian ANOVA)<a class="anchor" aria-label="anchor" href="#categorical-factor-e-g--bayesian-anova"></a>
</h3>
<p>This is achieved through model comparison with <code>loo</code>. In
the following example, the model with association with factors better
fits the data compared to the baseline model with no factor association.
For comparisons <code>check_outliers</code> must be set to FALSE as the
leave-one-out must work with the same amount of data, while outlier
elimination does not guarantee it.</p>
<p>If <code>elpd_diff</code> is away from zero of &gt; 5
<code>se_diff</code> difference of 5, we are confident that a model is
better than the other <a href="https://discourse.mc-stan.org/t/interpreting-elpd-diff-loo-package/1628/2?u=stemangiola" class="external-link">reference</a>.
In this case, -79.9 / 11.5 = -6.9, therefore we can conclude that model
one, the one with factor association, is better than model two.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/loo/" class="external-link">loo</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit first model</span></span>
<span><span class="va">model_with_factor_association</span> <span class="op">=</span> </span>
<span>  <span class="va">seurat_obj</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/sccomp_estimate.html">sccomp_estimate</a></span><span class="op">(</span> </span>
<span>    formula_composition <span class="op">=</span> <span class="op">~</span> <span class="va">type</span>, </span>
<span>    .sample <span class="op">=</span>  <span class="va">sample</span>, </span>
<span>    .cell_group <span class="op">=</span> <span class="va">cell_group</span>, </span>
<span>    bimodal_mean_variability_association <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    cores <span class="op">=</span> <span class="fl">1</span>, </span>
<span>    enable_loo <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit second model</span></span>
<span><span class="va">model_without_association</span> <span class="op">=</span> </span>
<span>  <span class="va">seurat_obj</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/sccomp_estimate.html">sccomp_estimate</a></span><span class="op">(</span> </span>
<span>    formula_composition <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>, </span>
<span>    .sample <span class="op">=</span>  <span class="va">sample</span>, </span>
<span>    .cell_group <span class="op">=</span> <span class="va">cell_group</span>, </span>
<span>    bimodal_mean_variability_association <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    cores <span class="op">=</span> <span class="fl">1</span> , </span>
<span>    enable_loo <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare models</span></span>
<span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo_compare.html" class="external-link">loo_compare</a></span><span class="op">(</span></span>
<span>  <span class="va">model_with_factor_association</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="st">"fit"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html" class="external-link">loo</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">model_without_association</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="st">"fit"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html" class="external-link">loo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="differential-variability-binary-factor">Differential variability, binary factor<a class="anchor" aria-label="anchor" href="#differential-variability-binary-factor"></a>
</h3>
<p>We can model the cell-group variability also dependent on the type,
and so test differences in variability</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">=</span> </span>
<span>  <span class="va">seurat_obj</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/sccomp_estimate.html">sccomp_estimate</a></span><span class="op">(</span> </span>
<span>    formula_composition <span class="op">=</span> <span class="op">~</span> <span class="va">type</span>, </span>
<span>    formula_variability <span class="op">=</span> <span class="op">~</span> <span class="va">type</span>,</span>
<span>    .sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>    .cell_group <span class="op">=</span> <span class="va">cell_group</span>,</span>
<span>    bimodal_mean_variability_association <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    cores <span class="op">=</span> <span class="fl">1</span> </span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">## Chain 1: EXPERIMENTAL ALGORITHM:</span></span>
<span><span class="co">## Chain 1:   This procedure has not been thoroughly tested and may be unstable</span></span>
<span><span class="co">## Chain 1:   or buggy. The interface is subject to change.</span></span>
<span><span class="co">## Chain 1: ------------------------------------------------------------</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Gradient evaluation took 0.000289 seconds</span></span>
<span><span class="co">## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 2.89 seconds.</span></span>
<span><span class="co">## Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Begin eta adaptation.</span></span>
<span><span class="co">## Chain 1: Iteration:   1 / 250 [  0%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration:  50 / 250 [ 20%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration: 100 / 250 [ 40%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration: 150 / 250 [ 60%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Iteration: 200 / 250 [ 80%]  (Adaptation)</span></span>
<span><span class="co">## Chain 1: Success! Found best value [eta = 1] earlier than expected.</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Begin stochastic gradient ascent.</span></span>
<span><span class="co">## Chain 1:   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes </span></span>
<span><span class="co">## Chain 1:    100        -3237.340             1.000            1.000</span></span>
<span><span class="co">## Chain 1:    200        -3174.962             0.510            1.000</span></span>
<span><span class="co">## Chain 1:    300        -3174.982             0.340            0.020</span></span>
<span><span class="co">## Chain 1:    400        -3168.273             0.255            0.020</span></span>
<span><span class="co">## Chain 1:    500        -3168.322             0.204            0.002   MEDIAN ELBO CONVERGED</span></span>
<span><span class="co">## Chain 1: </span></span>
<span><span class="co">## Chain 1: Drawing a sample of size 4000 from the approximate posterior... </span></span>
<span><span class="co">## Chain 1: COMPLETED.</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 60 × 14</span></span></span>
<span><span class="co">##    cell_group        parameter factor c_lower c_effect c_upper c_n_eff c_R_k_hat</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> B immature        (Interce… <span style="color: #BB0000;">NA</span>       0.525    0.850  1.18       <span style="color: #BB0000;">NaN</span>      2.52</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> B immature        typeheal… type     1.11     1.50   1.89       <span style="color: #BB0000;">NaN</span>      2.54</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> B mem             (Interce… <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">1.28</span>    -<span style="color: #BB0000;">0.902</span> -<span style="color: #BB0000;">0.509</span>      <span style="color: #BB0000;">NaN</span>      2.47</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> B mem             typeheal… type     1.38     1.87   2.34       <span style="color: #BB0000;">NaN</span>      2.51</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> CD4 cm S100A4     (Interce… <span style="color: #BB0000;">NA</span>       1.52     1.80   2.09       <span style="color: #BB0000;">NaN</span>      2.49</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> CD4 cm S100A4     typeheal… type     0.574    0.969  1.37       <span style="color: #BB0000;">NaN</span>      2.53</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> CD4 cm high cyto… (Interce… <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">0.933</span>   -<span style="color: #BB0000;">0.430</span>  0.059<span style="text-decoration: underline;">7</span>     <span style="color: #BB0000;">NaN</span>      2.50</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> CD4 cm high cyto… typeheal… type    -<span style="color: #BB0000;">2.55</span>    -<span style="color: #BB0000;">1.76</span>  -<span style="color: #BB0000;">0.966</span>      <span style="color: #BB0000;">NaN</span>      2.49</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> CD4 cm ribosome   (Interce… <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">0.154</span>    0.224  0.615      <span style="color: #BB0000;">NaN</span>      2.49</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> CD4 cm ribosome   typeheal… type    -<span style="color: #BB0000;">1.35</span>    -<span style="color: #BB0000;">0.801</span> -<span style="color: #BB0000;">0.257</span>      <span style="color: #BB0000;">NaN</span>      2.46</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 50 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 6 more variables: v_lower &lt;dbl&gt;, v_effect &lt;dbl&gt;, v_upper &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   v_n_eff &lt;dbl&gt;, v_R_k_hat &lt;dbl&gt;, count_data &lt;list&gt;</span></span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="suggested-settings">Suggested settings<a class="anchor" aria-label="anchor" href="#suggested-settings"></a>
</h2>
<div class="section level3">
<h3 id="for-single-cell-rna-sequencing">For single-cell RNA sequencing<a class="anchor" aria-label="anchor" href="#for-single-cell-rna-sequencing"></a>
</h3>
<p>We recommend setting
<code>bimodal_mean_variability_association  = TRUE</code>. The
bimodality of the mean-variability association can be confirmed from the
plots$credible_intervals_2D (see below).</p>
</div>
<div class="section level3">
<h3 id="for-cytof-and-microbiome-data">For CyTOF and microbiome data<a class="anchor" aria-label="anchor" href="#for-cytof-and-microbiome-data"></a>
</h3>
<p>We recommend setting
<code>bimodal_mean_variability_association  = FALSE</code>
(Default).</p>
</div>
<div class="section level3">
<h3 id="visualisation-of-the-mcmc-chains-from-the-posterior-distribution">Visualisation of the MCMC chains from the posterior
distribution<a class="anchor" aria-label="anchor" href="#visualisation-of-the-mcmc-chains-from-the-posterior-distribution"></a>
</h3>
<p>It is possible to directly evaluate the posterior distribution. In
this example, we plot the Monte Carlo chain for the slope parameter of
the first cell type. We can see that it has converged and is negative
with probability 1.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="st">"fit"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">rstan</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/rstan/reference/stanfit-method-traceplot.html" class="external-link">traceplot</a></span><span class="op">(</span><span class="st">"beta[2,1]"</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>Plot 1D significance plot</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span> <span class="op">=</span> <span class="va">res</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sccomp_test.html">sccomp_test</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Joining with `by = join_by(cell_group, sample)`</span></span>
<span><span class="co">## Joining with `by = join_by(cell_group, type)`</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">credible_intervals_1D</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>Plot 2D significance plot. Data points are cell groups. Error bars
are the 95% credible interval. The dashed lines represent the default
threshold fold change for which the probabilities (c_pH0, v_pH0) are
calculated. pH0 of 0 represent the rejection of the null hypothesis that
no effect is observed.</p>
<p>This plot is provided only if differential variability has been
tested. The differential variability estimates are reliable only if the
linear association between mean and variability for
<code>(intercept)</code> (left-hand side facet) is satisfied. A
scatterplot (besides the Intercept) is provided for each category of
interest. The for each category of interest, the composition and
variability effects should be generally uncorrelated.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">credible_intervals_2D</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.4.0 (2024-04-24)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.4 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] rstan_2.32.6       StanHeaders_2.32.9 tidyr_1.3.1        forcats_1.0.0     </span></span>
<span><span class="co">## [5] ggplot2_3.5.1      sccomp_1.7.12      dplyr_1.1.4       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] gridExtra_2.3               inline_0.3.19              </span></span>
<span><span class="co">##   [3] rlang_1.1.4                 magrittr_2.0.3             </span></span>
<span><span class="co">##   [5] matrixStats_1.3.0           compiler_4.4.0             </span></span>
<span><span class="co">##   [7] loo_2.7.0                   systemfonts_1.1.0          </span></span>
<span><span class="co">##   [9] vctrs_0.6.5                 stringr_1.5.1              </span></span>
<span><span class="co">##  [11] pkgconfig_2.0.3             crayon_1.5.2               </span></span>
<span><span class="co">##  [13] fastmap_1.2.0               XVector_0.45.0             </span></span>
<span><span class="co">##  [15] labeling_0.4.3              utf8_1.2.4                 </span></span>
<span><span class="co">##  [17] rmarkdown_2.27              tzdb_0.4.0                 </span></span>
<span><span class="co">##  [19] UCSC.utils_1.1.0            ragg_1.3.2                 </span></span>
<span><span class="co">##  [21] purrr_1.0.2                 xfun_0.44                  </span></span>
<span><span class="co">##  [23] zlibbioc_1.51.1             cachem_1.1.0               </span></span>
<span><span class="co">##  [25] GenomeInfoDb_1.41.1         jsonlite_1.8.8             </span></span>
<span><span class="co">##  [27] highr_0.11                  DelayedArray_0.31.1        </span></span>
<span><span class="co">##  [29] parallel_4.4.0              R6_2.5.1                   </span></span>
<span><span class="co">##  [31] RColorBrewer_1.1-3          bslib_0.7.0                </span></span>
<span><span class="co">##  [33] stringi_1.8.4               parallelly_1.37.1          </span></span>
<span><span class="co">##  [35] boot_1.3-30                 GenomicRanges_1.57.1       </span></span>
<span><span class="co">##  [37] jquerylib_0.1.4             Rcpp_1.0.12                </span></span>
<span><span class="co">##  [39] SummarizedExperiment_1.35.0 knitr_1.47                 </span></span>
<span><span class="co">##  [41] future.apply_1.11.2         readr_2.1.5                </span></span>
<span><span class="co">##  [43] IRanges_2.39.0              Matrix_1.7-0               </span></span>
<span><span class="co">##  [45] tidyselect_1.2.1            abind_1.4-5                </span></span>
<span><span class="co">##  [47] yaml_2.3.8                  codetools_0.2-20           </span></span>
<span><span class="co">##  [49] curl_5.2.1                  listenv_0.9.1              </span></span>
<span><span class="co">##  [51] pkgbuild_1.4.4              lattice_0.22-6             </span></span>
<span><span class="co">##  [53] tibble_3.2.1                withr_3.0.0                </span></span>
<span><span class="co">##  [55] Biobase_2.65.0              evaluate_0.24.0            </span></span>
<span><span class="co">##  [57] future_1.33.2               desc_1.4.3                 </span></span>
<span><span class="co">##  [59] RcppParallel_5.1.7          pillar_1.9.0               </span></span>
<span><span class="co">##  [61] MatrixGenerics_1.17.0       stats4_4.4.0               </span></span>
<span><span class="co">##  [63] generics_0.1.3              sp_2.1-4                   </span></span>
<span><span class="co">##  [65] S4Vectors_0.43.0            hms_1.1.3                  </span></span>
<span><span class="co">##  [67] rstantools_2.4.0            munsell_0.5.1              </span></span>
<span><span class="co">##  [69] scales_1.3.0                globals_0.16.3             </span></span>
<span><span class="co">##  [71] glue_1.7.0                  tools_4.4.0                </span></span>
<span><span class="co">##  [73] fs_1.6.4                    dotCall64_1.1-1            </span></span>
<span><span class="co">##  [75] grid_4.4.0                  QuickJSR_1.2.2             </span></span>
<span><span class="co">##  [77] colorspace_2.1-0            SingleCellExperiment_1.27.2</span></span>
<span><span class="co">##  [79] GenomeInfoDbData_1.2.12     patchwork_1.2.0            </span></span>
<span><span class="co">##  [81] cli_3.6.2                   textshaping_0.4.0          </span></span>
<span><span class="co">##  [83] spam_2.10-0                 fansi_1.0.6                </span></span>
<span><span class="co">##  [85] S4Arrays_1.5.1              V8_4.4.2                   </span></span>
<span><span class="co">##  [87] gtable_0.3.5                sass_0.4.9                 </span></span>
<span><span class="co">##  [89] digest_0.6.35               progressr_0.14.0           </span></span>
<span><span class="co">##  [91] BiocGenerics_0.51.0         SparseArray_1.5.8          </span></span>
<span><span class="co">##  [93] ggrepel_0.9.5               farver_2.1.2               </span></span>
<span><span class="co">##  [95] htmlwidgets_1.6.4           SeuratObject_5.0.2         </span></span>
<span><span class="co">##  [97] memoise_2.0.1               htmltools_0.5.8.1          </span></span>
<span><span class="co">##  [99] pkgdown_2.0.9               lifecycle_1.0.4            </span></span>
<span><span class="co">## [101] prettydoc_0.4.1             httr_1.4.7</span></span></code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Stefano Mangiola.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
